Notebook[{

Cell[CellGroupData[{
Cell["precession v2: polynomial coefficients", \
"Title",ExpressionUUID->"f128f030-4bc6-45b0-9b44-41af70f3403d"],

Cell["Davide Gerosa", \
"Subtitle",ExpressionUUID->"3cc57525-8cdf-4bcb-b38c-939151e9c131"],

Cell[TextData[StyleBox["This is a notebook to derive some long polynomial \
coefficients that describe the dynamics of spinning black-hole binaries at \
2PN. In particular, we present \[LineSeparator]expressions for (i) the \
evolution of the total spin on the precessional timescale, (ii) the \
identification of the spin-orbit resonances in terms of the generalized \
angular momentum \[Kappa], and (iii)  the identification of the spin-orbit \
resonances in terms of the effective spin \[Xi].  ", "Subsection"]], \
"Subtitle",ExpressionUUID->"803a8841-c96e-4923-a049-3204cbf8f401"],

Cell[CellGroupData[{

Cell["\<\
Export expressions in a format that python and numpy are going to like. Use a \
modified version of the packaged by Gustavo Wiederhecker  \
https://github.com/gwiederhecker/ToPython, supplemented by a set of custom \
transformation for the precession code. \
\>", "Subsubsection",ExpressionUUID->"9492543b-a14c-4dce-9a67-eb806edc393b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToPython", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"numpyprefix_", ":", "\"\<np\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"expression", "=", "x"}], ",", "greekrule", ",", "PythonForm", 
       ",", 
       RowBox[{"numpypre", "=", "numpyprefix"}], ",", "lp", ",", "rp", ",", 
       "a", ",", "b"}], "}"}], ",", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"By", " ", "Gustavo", " ", "Wiederhecker"}], ",", " ", 
       RowBox[{"minor", " ", "edits", " ", "by", " ", "Davide", " ", 
        RowBox[{"Gerosa", "."}]}]}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numpyprefix", "==", "\"\<\>\""}], ",", 
        RowBox[{"sep", "=", "\"\<\>\""}], ",", 
        RowBox[{"sep", "=", "\"\<.\>\""}]}], "]"}], ";", "\n", 
      RowBox[{"lp", "=", "\"\<(\>\""}], ";", "\n", 
      RowBox[{"rp", "=", "\"\<)\>\""}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Rational", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\</\>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<complex\>\"", "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Times", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\< * \>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Plus", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\< + \>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"h_", "[", "args__", "]"}], "]"}], ":=", 
       RowBox[{"numpypre", "<>", "sep", "<>", 
        RowBox[{"ToLowerCase", "[", 
         RowBox[{"PythonForm", "[", "h", "]"}], "]"}], "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "args", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Power", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "rp", "<>", "\"\<**\>\"",
         "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "a_ListQ", "]"}], ":=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<array\>\"", "<>", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "a", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<{\>\"", "->", " ", "\"\<[\>\""}], ",", 
            RowBox[{"\"\<}\>\"", "->", " ", "\"\<]\>\""}]}], "}"}]}], 
         "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Arg", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<angle\>\""}]}], ";", "\n", 
      
      RowBox[{
       RowBox[{"PythonForm", "[", "Csc", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<sin\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Sec", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<cos\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Cot", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<tan\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Csch", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<sinh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Sech", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<cosh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Coth", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<tanh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"List", "[", "args__", "]"}], "]"}], ":=", 
       RowBox[{
       "numpypre", "<>", "sep", "<>", "\"\<array\>\"", "<>", "lp", "<>", 
        "\"\<[\>\"", "<>", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PythonForm", "[", 
            RowBox[{
             RowBox[{"{", "args", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "<>", "\"\<,\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"{", "args", "}"}]}]}], "}"}]}], "]"}], "<>", 
        "\"\<]\>\"", "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "\[Pi]", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<pi\>\""}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "E", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<e\>\""}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "r_Real", "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", "=", 
           RowBox[{"MantissaExponent", "[", "r", "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"r", ">=", "0"}], ",", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "]"}], "]"}], 
            "<>", "\"\<e\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"\"\<(\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "]"}], "]"}], 
            "<>", "\"\<e\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<)\>\""}]}], 
          "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"greekrule", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<\[Alpha]\>\"", "->", "\"\<alpha\>\""}], ",", 
         RowBox[{"\"\<\[Beta]\>\"", "->", "\"\<beta\>\""}], ",", 
         RowBox[{"\"\<\[Gamma]\>\"", "->", "\"\<gamma\>\""}], ",", 
         RowBox[{"\"\<\[Delta]\>\"", "->", "\"\<delta\>\""}], ",", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", "->", "\"\<curlyepsilon\>\""}], 
         ",", 
         RowBox[{"\"\<\[Zeta]\>\"", "->", "\"\<zeta\>\""}], ",", 
         RowBox[{"\"\<\[Eta]\>\"", "->", "\"\<eta\>\""}], ",", 
         RowBox[{"\"\<\[Theta]\>\"", "->", "\"\<theta\>\""}], ",", 
         RowBox[{"\"\<\[Iota]\>\"", "->", "\"\<iota\>\""}], ",", 
         RowBox[{"\"\<\[Kappa]\>\"", "->", "\"\<kappa\>\""}], ",", 
         RowBox[{"\"\<\[Lambda]\>\"", "->", "\"\<lambda\>\""}], ",", 
         RowBox[{"\"\<\[Mu]\>\"", "->", "\"\<mu\>\""}], ",", 
         RowBox[{"\"\<\[Nu]\>\"", "->", "\"\<nu\>\""}], ",", 
         RowBox[{"\"\<\[Xi]\>\"", "->", "\"\<xi\>\""}], ",", 
         RowBox[{"\"\<\[Omicron]\>\"", "->", "\"\<omicron\>\""}], ",", 
         RowBox[{"\"\<\[Pi]\>\"", "->", "\"\<pi\>\""}], ",", 
         RowBox[{"\"\<\[Rho]\>\"", "->", "\"\<rho\>\""}], ",", 
         RowBox[{"\"\<\[FinalSigma]\>\"", "->", "\"\<finalsigma\>\""}], ",", 
         RowBox[{"\"\<\[Sigma]\>\"", "->", "\"\<sigma\>\""}], ",", 
         RowBox[{"\"\<\[Tau]\>\"", "->", "\"\<tau\>\""}], ",", 
         RowBox[{"\"\<\[Upsilon]\>\"", "->", "\"\<upsilon\>\""}], ",", 
         RowBox[{"\"\<\[CurlyPhi]\>\"", "->", "\"\<curlyphi\>\""}], ",", 
         RowBox[{"\"\<\[Chi]\>\"", "->", "\"\<chi\>\""}], ",", 
         RowBox[{"\"\<\[Psi]\>\"", "->", "\"\<psi\>\""}], ",", 
         RowBox[{"\"\<\[Omega]\>\"", "->", "\"\<omega\>\""}], ",", 
         RowBox[{"\"\<\[CapitalAlpha]\>\"", "->", "\"\<Alpha\>\""}], ",", 
         RowBox[{"\"\<\[CapitalBeta]\>\"", "->", "\"\<Beta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalGamma]\>\"", "->", "\"\<Gamma\>\""}], ",", 
         RowBox[{"\"\<\[CapitalDelta]\>\"", "->", "\"\<Delta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalEpsilon]\>\"", "->", "\"\<CurlyEpsilon\>\""}], 
         ",", 
         RowBox[{"\"\<\[CapitalZeta]\>\"", "->", "\"\<Zeta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalEta]\>\"", "->", "\"\<Eta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalTheta]\>\"", "->", "\"\<Theta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalIota]\>\"", "->", "\"\<Iota\>\""}], ",", 
         RowBox[{"\"\<\[CapitalKappa]\>\"", "->", "\"\<Kappa\>\""}], ",", 
         RowBox[{"\"\<\[CapitalLambda]\>\"", "->", "\"\<Lambda\>\""}], ",", 
         RowBox[{"\"\<\[CapitalMu]\>\"", "->", "\"\<Mu\>\""}], ",", 
         RowBox[{"\"\<\[CapitalNu]\>\"", "->", "\"\<Nu\>\""}], ",", 
         RowBox[{"\"\<\[CapitalXi]\>\"", "->", "\"\<Xi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalOmicron]\>\"", "->", "\"\<Omicron\>\""}], ",", 
         
         RowBox[{"\"\<\[CapitalPi]\>\"", "->", "\"\<Pi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalRho]\>\"", "->", "\"\<Rho\>\""}], ",", 
         RowBox[{"\"\<\[CapitalSigma]\>\"", "->", "\"\<Sigma\>\""}], ",", 
         RowBox[{"\"\<\[CapitalTau]\>\"", "->", "\"\<Tau\>\""}], ",", 
         RowBox[{"\"\<\[CapitalUpsilon]\>\"", "->", "\"\<Upsilon\>\""}], ",", 
         
         RowBox[{"\"\<\[CapitalPhi]\>\"", "->", "\"\<CurlyPhi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalChi]\>\"", "->", "\"\<Chi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalPsi]\>\"", "->", "\"\<Psi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalOmega]\>\"", "->", "\"\<Omega\>\""}]}], 
        "}"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "allOther_", "]"}], ":=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"allOther", ",", "FortranForm"}], "]"}], ",", "greekrule"}],
         "]"}]}], ";", "\n", 
      RowBox[{"PythonForm", "[", "expression", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"7f2c8181-f40d-47d6-a9eb-838a2df8c1e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"precessionform", "[", 
    RowBox[{"label_", ",", "expression_"}], "]"}], ":=", 
   RowBox[{"\"\<# Machine generated with \>\"", "<>", 
    RowBox[{"Last", "@", 
     RowBox[{"FileNameSplit", "@", 
      RowBox[{"NotebookFileName", "[", "]"}]}]}], "<>", "\"\<\\n\>\"", "<>", 
    " ", "label", "<>", "\"\< = \>\"", "<>", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToPython", "[", "expression", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<(q)\>\"", "\[Rule]", "\"\<q\>\""}], ",", 
        RowBox[{"\"\<(L)\>\"", "\[Rule]", "\"\<L\>\""}], ",", 
        RowBox[{"\"\<(S)\>\"", "\[Rule]", "\"\<S\>\""}], ",", 
        RowBox[{"\"\<(J)\>\"", "\[Rule]", "\"\<J\>\""}], ",", 
        RowBox[{"\"\<(S1)\>\"", "\[Rule]", "\"\<S1\>\""}], ",", 
        RowBox[{"\"\<(S2)\>\"", "\[Rule]", "\"\<S2\>\""}], ",", 
        RowBox[{"\"\<(u)\>\"", "->", "\"\<u\>\""}], ",", 
        RowBox[{"\"\<(kappa)\>\"", "->", "\"\<kappa\>\""}], ",", 
        RowBox[{"\"\<(xi)\>\"", "->", "\"\<xi\>\""}], ",", 
        RowBox[{"\"\<(2)\>\"", "->", "\"\<2\>\""}], ",", 
        RowBox[{"\"\<(3)\>\"", "->", "\"\<3\>\""}], ",", 
        RowBox[{"\"\<(4)\>\"", "->", "\"\<4\>\""}], ",", 
        RowBox[{"\"\<(5)\>\"", "->", "\"\<5\>\""}], ",", 
        RowBox[{"\"\<(6)\>\"", "->", "\"\<6\>\""}], ",", 
        RowBox[{"\"\<(7)\>\"", "->", "\"\<7\>\""}], ",", 
        RowBox[{"\"\<(8)\>\"", "->", "\"\<8\>\""}], ",", 
        RowBox[{"\"\<(9)\>\"", "->", "\"\<9\>\""}], ",", 
        RowBox[{"\"\<(10)\>\"", "->", "\"\<10\>\""}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"d7529ef7-9d21-43da-a43e-773609d29250"]
}, Open  ]],

Cell[CellGroupData[{

Cell["(i) Cubic equation in S^2 ", \
"Section",ExpressionUUID->"e7621dc9-6859-411e-8bc8-7fcdfdab8352"],

Cell[CellGroupData[{

Cell["\<\
Effective potentials; see Eqs. (13-14) of Gerosa et al. (2015), \
arxiv:1506.03492. \
\>", "Subsubsection",ExpressionUUID->"e1d6bd4d-08d3-4d11-9a7d-4008c6fab99e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", 
   FractionBox["1", 
    RowBox[{"4", "q", "  ", 
     RowBox[{"S", "^", "2"}], " ", "L"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "^", "2"}], " ", "-", " ", 
      RowBox[{"L", "^", "2"}], "-", 
      RowBox[{"S", "^", "2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "^", "2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"S1", "^", "2"}], "-", 
         RowBox[{"S2", "^", "2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"q", "^", "2"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "S"}], ")"}], "^", "2"}], "-", 
       RowBox[{"J", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "  ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "S"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "+", "S2"}], ")"}], "^", "2"}], "-", 
       RowBox[{"S", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "-", "S2"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}]}], " ", ";"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"86c9162b-f09f-43cc-9ffd-7977a9cb2e6b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xiSvarphi", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"t1", 
     RowBox[{"(", 
      RowBox[{"t2", "-", 
       RowBox[{
        RowBox[{"Cos", "[", "varphi", "]"}], "t3"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<xi\>\"", ",", "xiSvarphi"}], "]"}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"7e3f5b5a-097c-4fe1-b65c-6e2ce4d6b531"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\nxi = 1/4 * \
L**(-1) * q**(-1) * S**(-2) * ((J**2 + (-1 * L**2 + -1 * S**2)) * (((1 + \
q))**2 * S**2 + (-1 + q**2) * (S1**2 + -1 * S2**2)) + -1 * (1 + -1 * q**2) * \
((J**2 + -1 * ((L + -1 * S))**2))**(1/2) * ((-1 * J**2 + ((L + \
S))**2))**(1/2) * ((S**2 + -1 * ((S1 + -1 * S2))**2))**(1/2) * ((-1 * S**2 + \
((S1 + S2))**2))**(1/2) * np.cos(varphi))\"\>"], "Output",
 CellLabel->"Out[7]=",ExpressionUUID->"ea29d338-9e82-4291-b7eb-5f925ebcf857"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Equation (\[Xi]_\[PlusMinus](S)-\[Xi])^2=0; substitute  \[Kappa] and u; \
multiply by some constant factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"01677cc4-4de9-4c13-9d41-d16e8f014aa4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"effpot", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"t3", "^", "2"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "/", "t1"}], ")"}], " ", "-", " ", "t2"}], ")"}], 
     "^", "2"}]}], " ", "]"}]}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"78baebac-5128-4c8c-99d7-1081f39a15c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["J", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "-", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["J", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "+", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["S", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "-", "S2"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "+", "S2"}], ")"}], "2"]}], ")"}]}], "-", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["J", "2"], "-", 
        SuperscriptBox["L", "2"], "-", 
        SuperscriptBox["S", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox["S", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["S1", "2"], "-", 
           SuperscriptBox["S2", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", "L", " ", "q", " ", 
      SuperscriptBox["S", "2"], " ", "\[Xi]"}]}], ")"}], "2"]}]], "Output",
 CellLabel->"Out[8]=",ExpressionUUID->"9907ec5a-0e06-4ffc-832b-975e02318359"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"effpot", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "^", "2"}], "  ", 
         RowBox[{"effpot", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"S", "^", "2"}]}], ")"}]}]}], "//.", 
        RowBox[{"{", 
         RowBox[{"J", "\[Rule]", 
          RowBox[{"Sqrt", "[", "Js", "]"}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{"Js", "->", 
         RowBox[{
          RowBox[{"2", " ", "L", " ", "\[Kappa]"}], " ", "+", " ", 
          RowBox[{"L", "^", "2"}]}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{"L", "\[Rule]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "u"}], ")"}]}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Sqrt", "[", "Ss", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"8f2d8930-0bbb-41f2-b252-8f3911622a78"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "-", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "+", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["Ss"]}], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox["Ss"], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["S1", "2"], "-", 
             SuperscriptBox["S2", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "Ss"}]}], ")"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "+", 
       RowBox[{"2", " ", "q", " ", "Ss", " ", "\[Xi]"}]}], ")"}], "2"]}], 
   RowBox[{"4", " ", "Ss"}]]}]], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"316a831a-957b-49e0-9aea-b054065744c2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract coefficients.", \
"Subsubsection",ExpressionUUID->"8b07b8ac-0fbf-4656-8c34-849a3c399112"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"465955aa-d15a-495e-85f8-967c1d0f47fd"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = q * \
((1 + q))**2 * u**2\"\>"], "Output",
 CellLabel->
  "Out[11]=",ExpressionUUID->"761c8158-a7ad-4460-bfb0-8c24f8ee4cfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"68632716-b0b3-4583-b1b5-89910bcf8643"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = 1/4 \
* ((1 + q))**2 * (1 + (4 * S2**2 * u**2 + (q**2 * (1 + 4 * S1**2 * u**2) + -2 \
* q * (1 + 2 * u * ((S1**2 + S2**2) * u + (2 * kappa + -1 * xi))))))\"\>"], \
"Output",
 CellLabel->
  "Out[13]=",ExpressionUUID->"814ef230-3ec5-4cfe-9e35-79218c0bd22d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"eba66036-8690-4de4-98cf-09ff6e9db448"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = (q \
* (kappa + (q * kappa + -1 * xi)) * (kappa + (q * kappa + -1 * q * xi)) + \
(-1/2 * (-1 + q**2) * S1**2 * ((1 + q) * (-1 + (q + 4 * q * u * kappa)) + -2 \
* q * u * xi) + -1/2 * (-1 + q**2) * S2**2 * ((1 + q) * (-1 + (q + -4 * u * \
kappa)) + 2 * q * u * xi)))\"\>"], "Output",
 CellLabel->
  "Out[15]=",ExpressionUUID->"e86b526e-c05d-4f1d-bd97-6804fb74a11e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"7c17f9b3-2582-4b30-a3a5-a2d26faf2b78"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = 1/4 \
* (-1 + q) * (1 + q) * ((1 + q) * ((-1 + q) * ((S1**2 + -1 * S2**2))**2 + 4 * \
(q * S1**2 + -1 * S2**2) * kappa**2) + -4 * q * (S1 + -1 * S2) * (S1 + S2) * \
kappa * xi)\"\>"], "Output",
 CellLabel->
  "Out[17]=",ExpressionUUID->"2aee94ce-e8a9-41d8-b2c6-f5ba4c6e08aa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"32910c26-9a18-4125-ae41-a90c65af00fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Scoeff3", "*", " ", 
    RowBox[{"Ss", "^", "3"}]}], "+", 
   RowBox[{"Scoeff2", "*", 
    RowBox[{"Ss", "^", "2"}]}], "+", 
   RowBox[{"Scoeff1", "*", "Ss"}], " ", "+", " ", "Scoeff0", " ", "-", " ", 
   "effpot"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"2e24b2f1-e6a2-408c-a363-7be25e052522"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[18]=",ExpressionUUID->"a7f134bc-cc2a-4197-9939-4973a7f126e5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(ii) Spin-orbit resonances in \[Kappa] ", \
"Section",ExpressionUUID->"cfda2c47-b632-4d6d-92b4-d53e4acb4c0a"],

Cell[CellGroupData[{

Cell["\<\
Compute discriminant of the cubic equation in S^2; multiply by some constant \
factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"c851382c-e32c-4249-98b4-ba0b4f82e003"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"discr", " ", "=", " ", 
   RowBox[{
    RowBox[{"Discriminant", "[", 
     RowBox[{"effpot", ",", "Ss"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"discr", "=", " ", 
  RowBox[{"discr", 
   FractionBox["256", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["q", "2"]}], ")"}], "2"]]}]}]}], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"48a88c7d-a32d-4f8b-85ab-2458943de372"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "16"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["q", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "6"], " ", 
     SuperscriptBox["S1", "10"], " ", 
     SuperscriptBox["u", "6"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["q", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
     SuperscriptBox["S1", "8"], " ", 
     SuperscriptBox["u", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"48", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["q", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"9", "+", 
          RowBox[{"40", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"40", " ", "u", " ", "\[Kappa]"}], "-", 
          RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "47"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Xi]", "2"]}], "-", 
          RowBox[{"8", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", "\[Kappa]"}], "+", 
             RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "9"}], "+", 
          RowBox[{"20", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]", "+", 
             RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["S1", "6"], " ", 
     SuperscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "7"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"16", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "-", 
          RowBox[{"32", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"144", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"17", "+", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "+", 
          RowBox[{"40", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"13", "-", 
             RowBox[{"40", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"51", "+", 
             RowBox[{"88", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"272", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"34", " ", "\[Kappa]"}], "-", 
             RowBox[{"19", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", 
           SuperscriptBox["\[Xi]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"44", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"11", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
             RowBox[{"14", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "5"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"112", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
           SuperscriptBox["\[Xi]", "2"]}], "+", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "116"}], " ", "\[Kappa]"}], "+", 
             RowBox[{"74", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "176"}], " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"40", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
             RowBox[{"88", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "21"}], "-", 
             RowBox[{"32", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "4"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"44", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"28", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"80", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "6"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"28", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"20", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"6", " ", "\[Xi]"}], "-", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"23", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"13", "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"\[Kappa]", "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", 
           SuperscriptBox["S2", "2"], " ", "u"}], ")"}]}], "+", "\[Kappa]", 
        "+", 
        RowBox[{"q", " ", "\[Kappa]"}], "-", 
        RowBox[{"q", " ", "\[Xi]"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["q", "4"], "+", 
          RowBox[{"8", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "8"}], "+", 
          SuperscriptBox["q", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"24", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"12", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "47"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"24", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"5", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"24", " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"5", " ", "\[Xi]"}], "+", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{"8", "-", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"18", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"5", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"19", " ", "\[Kappa]"}], "-", 
                RowBox[{"9", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "72"}], " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"\[Xi]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "q"}], ")"}], " ", 
     SuperscriptBox["S1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "5"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"3", " ", "q"}]}], ")"}], " ", 
        SuperscriptBox["S2", "8"], " ", 
        SuperscriptBox["u", "6"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           SuperscriptBox["q", "4"]}], "-", 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "22"}], "-", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "24"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"20", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q", "8"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{
           SuperscriptBox["q", "10"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "9"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "36"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"15", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "86"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"20", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"12", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", "+", 
          RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"16", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{"3", " ", "q"}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"5", " ", 
              SuperscriptBox["q", "5"]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"5", "-", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "5"}], "-", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"13", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"52", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"18", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "q", "-", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"10", " ", "q", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"10", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["S1", "4"], " ", "u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"6", " ", "q"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "5"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "6"]}], "+", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"134", "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{"10", "-", 
             RowBox[{"12", " ", "q"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["q", "2"]}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["q", "6"]}], "-", 
             RowBox[{"30", " ", "q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"15", "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"10", "+", 
                RowBox[{"36", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"11", "+", 
                RowBox[{"60", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "60"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"3", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"16", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"22", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"35", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"98", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "7"]}], "+", 
             RowBox[{"u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"23", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"25", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"47", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"120", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->
  "Out[20]=",ExpressionUUID->"7ddc46ff-91ed-4f34-994a-815a6d49775f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"1db1bfdc-7d08-45d4-ba0b-f7dbf5614baf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"00398501-a010-4b4c-890d-b071d4c07c14"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff5 = \
-256 * q**3 * ((1 + q))**6 * u\"\>"], "Output",
 CellLabel->
  "Out[22]=",ExpressionUUID->"2c928693-f4d1-4013-aaf6-e284a0b2fbbf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"e90dd0c6-599d-4430-9948-9f9ef987284f"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff4 = 16 \
* q**2 * ((1 + q))**4 * (((-1 + q**2))**2 + (-16 * ((1 + q))**2 * (q * (-5 + \
3 * q) * S1**2 + (3 + -5 * q) * S2**2) * u**2 + (40 * q * ((1 + q))**2 * u * \
xi + 16 * q**2 * u**2 * xi**2)))\"\>"], "Output",
 CellLabel->
  "Out[24]=",ExpressionUUID->"2167efb4-f288-4d7b-b180-09c12d793d50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"4730e454-cab2-4f83-b336-41547bae487c"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = -32 \
* q * ((1 + q))**4 * (2 * q**6 * S1**2 * u * (-5 + 12 * S1**2 * u**2) + (2 * \
S2**2 * u * (-5 + 12 * S2**2 * u**2) + (2 * q**2 * u * (40 * S1**4 * u**2 + \
(-44 * S2**4 * u**2 + (8 * xi**2 + (S1**2 * (-5 + (-8 * S2**2 * u**2 + 40 * u \
* xi)) + -2 * S2**2 * (-5 + 4 * u * xi * (1 + u * xi)))))) + (2 * q**3 * (32 \
* S1**4 * u**3 + (32 * S2**4 * u**3 + (xi * (-1 + 8 * u * xi * (3 + u * xi)) \
+ (2 * S2**2 * u * (-1 + u * xi * (17 + 8 * u * xi)) + 2 * S1**2 * u * (-1 + \
(40 * S2**2 * u**2 + u * xi * (17 + 8 * u * xi))))))) + (q * (xi + 2 * u * \
(S1**2 * (1 + -48 * S2**2 * u**2) + S2**2 * (1 + -2 * u * (12 * S2**2 * u + \
xi)))) + (q**5 * (xi + 2 * u * (S2**2 + S1**2 * (1 + -2 * u * (12 * (S1**2 + \
2 * S2**2) * u + xi)))) + -2 * q**4 * u * (5 * S2**2 + (44 * S1**4 * u**2 + \
(-8 * (5 * S2**4 * u**2 + (5 * S2**2 * u * xi + xi**2)) + 2 * S1**2 * (-5 + 4 \
* u * (xi + u * (S2**2 + xi**2))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[26]=",ExpressionUUID->"f0658899-8937-4fef-b53d-b82f094b6579"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"c98aabf9-ef1e-43a4-b8bd-a0d4d3805603"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = -16 \
* ((1 + q))**2 * (16 * (-1 + q) * q**3 * ((1 + q))**4 * (10 + (-8 + q) * q) * \
S1**6 * u**4 + (-16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (-1 * \
((-1 + q**2))**2 * S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * \
(-4 + q) * q * (1 + q) * u * xi + 16 * q**2 * u**2 * xi**2)) + (-1 * q**2 * \
(((1 + q) * S2**2 * u + q * xi))**2 * ((-1 + q) * ((1 + q))**2 * (-1 + (q + \
48 * S2**2 * u**2)) + (8 * q * (1 + q) * (5 + q) * u * xi + 16 * q**2 * u**2 \
* xi**2)) + (2 * q**2 * ((1 + q))**2 * S1**4 * u**2 * ((-1 + q) * ((1 + \
q))**2 * ((-1 + q) * (-3 + (30 * q + 4 * q**2)) + -72 * (2 + (-2 + q) * q) * \
S2**2 * u**2) + (4 * q * (1 + q) * (-30 + q * (39 + q * (-19 + 4 * q))) * u * \
xi + -8 * q**2 * (6 + (-6 + q) * q) * u**2 * xi**2)) + (-4 * q * (-1 * (1 + \
q) * S2**2 * u + -1 * q * xi) * (-1 * ((-1 + q))**2 * ((1 + q))**3 * S2**2 * \
u * (-10 + (q + 24 * S2**2 * u**2)) + (-1 * (-1 + q) * q * ((1 + q))**2 * (-1 \
+ (q + 4 * (1 + 2 * q) * S2**2 * u**2)) * xi + (-8 * q**2 * (1 + q) * u * (2 \
+ (q + 2 * (-1 + q) * S2**2 * u**2)) * xi**2 + -16 * q**3 * u**2 * xi**3))) + \
(q * (1 + q) * S1**2 * ((-1 + q) * ((1 + q))**3 * (((-1 + q))**3 * q + (4 * \
(-1 + q) * (15 + q * (-29 + 15 * q)) * S2**2 * u**2 + 144 * (1 + 2 * (-1 + q) \
* q) * S2**4 * u**4)) + (2 * q * ((1 + q))**2 * u * (((-1 + q))**2 * (-3 + q \
* (23 + 4 * q)) + 12 * (1 + q) * (1 + q**2) * S2**2 * u**2) * xi + (8 * q**2 \
* (1 + q) * u**2 * (-12 + (-2 * q + (-11 * q**2 + (q**3 + 4 * (3 + q * (-5 + \
3 * q)) * S2**2 * u**2)))) * xi**2 + -32 * q**3 * (3 + (-1 + q) * q) * u**3 * \
xi**3))) + (S2**2 * (((-1 + q**2))**4 + (2 * ((-1 + q))**2 * q * ((1 + q))**3 \
* (4 + 5 * q) * u * xi + (8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * \
u**2 * xi**2 + 32 * q**3 * (-1 + q**2) * u**3 * xi**3))) + -1 * q**2 * xi**2 \
* (1 + q * (8 * u * xi + q * (-2 + (16 * u * xi + ((q + 4 * u * \
xi))**2))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[28]=",ExpressionUUID->"0d8af05a-81bf-40f5-bd59-20b9b425a066"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"9a93643e-0eb0-42dc-8f77-6ae2c82d2585"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = -16 \
* (1 + q) * (-16 * ((-1 + q))**2 * q**3 * ((1 + q))**5 * (-5 + 2 * q) * S1**8 \
* u**5 + (-4 * (-1 + q) * q**2 * ((1 + q))**3 * S1**6 * u**3 * ((-1 + q) * \
((1 + q))**2 * (-1 + (15 * q + (4 * q**2 + 8 * (6 + (-1 + q) * q) * S2**2 * \
u**2))) + (2 * q * (1 + q) * (20 + q * (-29 + 12 * q)) * u * xi + -8 * (-2 + \
q) * q**2 * u**2 * xi**2)) + (-2 * q * (((1 + q) * S2**2 * u + q * xi))**2 * \
(-1 * ((-1 + q))**2 * ((1 + q))**3 * S2**2 * u * (-10 + (q + 24 * S2**2 * \
u**2)) + (-1 * (-1 + q) * q * ((1 + q))**2 * (-1 + (q + 4 * (1 + 2 * q) * \
S2**2 * u**2)) * xi + (-8 * q**2 * (1 + q) * u * (2 + (q + 2 * (-1 + q) * \
S2**2 * u**2)) * xi**2 + -16 * q**3 * u**2 * xi**3))) + (-2 * q * ((1 + \
q))**2 * S1**4 * u * (((-1 + q))**2 * ((1 + q))**3 * (((-1 + q))**2 * q + (2 \
* (15 + q * (-55 + 2 * q * (9 + 2 * q))) * S2**2 * u**2 + -72 * (1 + q**2) * \
S2**4 * u**4)) + ((-1 + q) * q * ((1 + q))**2 * u * (3 + (-52 * q + (33 * \
q**2 + (16 * q**3 + 4 * (-3 + 2 * q**2 * (-7 + 4 * q)) * S2**2 * u**2)))) * \
xi + (-8 * q**2 * (1 + q) * u**2 * (6 + (-16 * q + (18 * q**2 + (-5 * q**3 + \
2 * (-1 + q) * (3 + (-1 + q) * q) * S2**2 * u**2)))) * xi**2 + -16 * q**3 * \
(3 + q * (-5 + 3 * q)) * u**3 * xi**3))) + (S1**2 * (-32 * ((-1 + q))**2 * \
((1 + q))**5 * (1 + q * (-1 + 6 * q)) * S2**6 * u**5 + (-4 * (-1 + q) * ((1 + \
q))**3 * S2**4 * u**3 * ((-1 + q) * ((1 + q))**2 * (4 + q * (18 + 5 * q * \
(-11 + 3 * q))) + (2 * q * (1 + q) * (-8 + (14 * q + 3 * q**3)) * u * xi + 8 \
* q**2 * (1 + q * (-1 + 3 * q)) * u**2 * xi**2)) + (2 * ((1 + q))**3 * S2**2 \
* u * (-1 * ((-1 + q))**4 * ((1 + q))**2 * (1 + (-12 + q) * q) + (-2 * q * \
((-1 + q**2))**2 * (4 + q * (-7 + 4 * q)) * u * xi + (-8 * q**2 * (1 + q * \
(-8 + q * (20 + (-8 + q) * q))) * u**2 * xi**2 + 16 * (-2 + q) * q**3 * (-1 + \
2 * q) * u**3 * xi**3))) + 2 * q**2 * xi * (-1 * ((-1 + q**2))**4 + (-1 * \
((-1 + q))**2 * ((1 + q))**3 * (-1 + q * (18 + 7 * q)) * u * xi + (4 * q * \
((1 + q))**2 * (2 + q * (-5 + 19 * q)) * u**2 * xi**2 + 16 * q**2 * (1 + q**2 \
* (2 + 3 * q)) * u**3 * xi**3)))))) + -2 * (-1 * (1 + q) * S2**2 * u + -1 * q \
* xi) * (16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (((-1 + q**2))**2 \
* S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * (-4 + q) * q * \
(1 + q) * u * xi + 16 * q**2 * u**2 * xi**2)) + (S2**2 * (-1 * ((-1 + \
q**2))**4 + (-2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u * xi + \
(-8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * xi**2 + -32 * \
q**3 * (-1 + q**2) * u**3 * xi**3))) + q**2 * xi**2 * (1 + q * (8 * u * xi + \
q * (-2 + (16 * u * xi + ((q + 4 * u * xi))**2))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[30]=",ExpressionUUID->"7fd726d8-90d1-4697-84a6-3cff673bde45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"709c896a-3a70-4fc9-b922-53ff9c25d127"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = -16 \
* (16 * ((-1 + q))**3 * q**3 * ((1 + q))**6 * S1**10 * u**6 + (-1 * ((-1 + \
q))**2 * q**2 * ((1 + q))**4 * S1**8 * u**4 * (((1 + q))**2 * (1 + (-20 * q + \
(-8 * q**2 + 16 * (-3 + (q + 2 * q**2)) * S2**2 * u**2))) + (-8 * q * (1 + q) \
* (-5 + 8 * q) * u * xi + 16 * q**2 * u**2 * xi**2)) + ((-1 + q) * q * ((1 + \
q))**3 * S1**6 * u**2 * (q * ((-1 + q**2))**3 + (-4 * (-1 + q) * ((1 + q))**3 \
* (-5 + q * (27 + q * (-3 + 8 * q))) * S2**2 * u**2 + (16 * ((-1 + q))**2 * \
((1 + q))**3 * (3 + q * (6 + q)) * S2**4 * u**4 + (-2 * (-1 + q) * q * ((1 + \
q))**2 * u * (1 + (-25 * q + (-12 * q**2 + 4 * (-1 + (q + 12 * q**2)) * S2**2 \
* u**2))) * xi + (8 * q**2 * (1 + q) * u**2 * (4 + (-18 * q + (11 * q**2 + 4 \
* (-1 + q**2) * S2**2 * u**2))) * xi**2 + 32 * (1 + -2 * q) * q**3 * u**3 * \
xi**3))))) + (((1 + q))**2 * S1**4 * u * (-16 * ((-1 + q))**3 * ((1 + q))**4 \
* (1 + 3 * q * (2 + q)) * S2**6 * u**5 + (2 * S2**4 * u**3 * (((-1 + q))**2 * \
((1 + q))**4 * (4 + q * (6 + q * (61 + (6 * q + 4 * q**2)))) + (4 * ((-1 + \
q))**2 * q * ((1 + q))**4 * (4 + (q + 4 * q**2)) * u * xi + -8 * q**2 * ((-1 \
+ q**2))**2 * (1 + q * (4 + q)) * u**2 * xi**2)) + (xi * (2 * ((-1 + q))**4 * \
q**2 * ((1 + q))**3 + (((q + -1 * q**3))**2 * (-1 + q * (40 + 23 * q)) * u * \
xi + (8 * q**3 * (1 + q) * (-1 + q * (14 + 5 * (-4 + q) * q)) * u**2 * xi**2 \
+ -16 * q**4 * (1 + 6 * (-1 + q) * q) * u**3 * xi**3))) + (-1 + q) * (1 + q) \
* S2**2 * u * (-1 * ((-1 + q**2))**3 * (-1 + 2 * q * (12 + 5 * q)) + (-2 * \
(-1 + q) * q * ((1 + q))**2 * (-4 + q * (29 + q * (-21 + 32 * q))) * u * xi + \
(-8 * q**2 * (1 + q) * (1 + 2 * (-2 + q) * q * (1 + 4 * q)) * u**2 * xi**2 + \
32 * q**3 * (1 + q * (-1 + 3 * q)) * u**3 * xi**3)))))) + ((1 + q) * S1**2 * \
(16 * ((-1 + q))**3 * ((1 + q))**5 * (2 + 3 * q) * S2**8 * u**6 + (q**2 * \
xi**2 * (((-1 + q))**4 * ((1 + q))**3 + (2 * q * (5 + 3 * q) * ((-1 + \
q**2))**2 * u * xi + (-8 * q**2 * (1 + q) * (-4 + q * (7 + q)) * u**2 * xi**2 \
+ 32 * (1 + -2 * q) * q**3 * u**3 * xi**3))) + ((-1 + q) * ((1 + q))**2 * \
S2**4 * u**2 * ((-10 + (-24 + q) * q) * ((-1 + q**2))**3 + (2 * (-1 + q) * q \
* ((1 + q))**2 * (-32 + q * (21 + q * (-29 + 4 * q))) * u * xi + (8 * q**2 * \
(1 + q) * (8 + q * (-14 + (-4 + q) * q)) * u**2 * xi**2 + -32 * q**3 * (3 + \
(-1 + q) * q) * u**3 * xi**3))) + (S2**2 * (-1 * ((-1 + q))**6 * ((1 + q))**5 \
+ (-10 * ((-1 + q))**4 * q * ((1 + q))**5 * u * xi + (-2 * ((-1 + q))**2 * \
q**2 * ((1 + q))**3 * (11 + q * (-24 + 11 * q)) * u**2 * xi**2 + (16 * q**3 * \
((1 + q))**3 * (2 + q * (-3 + 2 * q)) * u**3 * xi**3 + 32 * q**4 * (1 + q) * \
(3 + q * (-5 + 3 * q)) * u**4 * xi**4)))) + 4 * ((-1 + q))**2 * ((1 + q))**4 \
* S2**6 * u**4 * (-8 + q * (-5 + (-24 * q + (-22 * q**2 + (5 * q**3 + (2 * \
(-4 + q) * (3 + q) * u * xi + 8 * q * u**2 * xi**2)))))))))) + -1 * (((1 + q) \
* S2**2 * u + q * xi))**2 * (16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 \
+ (((-1 + q**2))**2 * S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + \
(8 * (-4 + q) * q * (1 + q) * u * xi + 16 * q**2 * u**2 * xi**2)) + (S2**2 * \
(-1 * ((-1 + q**2))**4 + (-2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) \
* u * xi + (-8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * xi**2 \
+ -32 * q**3 * (-1 + q**2) * u**3 * xi**3))) + q**2 * xi**2 * (1 + q * (8 * u \
* xi + q * (-2 + (16 * u * xi + ((q + 4 * u * xi))**2))))))))))))\"\>"], \
"Output",
 CellLabel->
  "Out[32]=",ExpressionUUID->"fab3a080-c552-49f3-b334-ffd1500739b2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"7ea4fb9d-f5ca-4d22-9aab-2abf6b4a1eef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kappacoeff5", "*", " ", 
    RowBox[{"\[Kappa]", "^", "5"}]}], "+", 
   RowBox[{"kappacoeff4", "*", " ", 
    RowBox[{"\[Kappa]", "^", "4"}]}], "+", 
   RowBox[{"kappacoeff3", "*", " ", 
    RowBox[{"\[Kappa]", "^", "3"}]}], "+", 
   RowBox[{"kappacoeff2", "*", " ", 
    RowBox[{"\[Kappa]", "^", "2"}]}], "+", 
   RowBox[{"kappacoeff1", "*", " ", "\[Kappa]"}], "+", "kappacoeff0", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"4941b746-95b0-4bfb-9922-bf9f6dadac08"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[33]=",ExpressionUUID->"5f5234ff-0fb5-4a52-b74c-d1a7dbb25f03"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(iii) Spin-orbit resonances in xi ", \
"Section",ExpressionUUID->"0b7223bc-c715-4f8e-bf33-838f7dec2ce8"],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"8155620a-6718-4c8f-8645-f5c4dd07a4a0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff6", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "6"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff6\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"9d70ea06-27f5-41b4-a41b-d4fe983949a6"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff6 = 256 \
* q**6 * u**2\"\>"], "Output",
 CellLabel->
  "Out[35]=",ExpressionUUID->"2e2d561c-a851-4b58-b06a-dca2ffc45ad8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"f726bc69-7fe9-4256-bde9-127e1ce7f678"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff5 = 128 \
* q**5 * (1 + q) * u * (1 + (q + (8 * q * S1**2 * u**2 + (-4 * u * (S1**2 * u \
+ (-2 * S2**2 * u + kappa)) + -4 * q * u * (S2**2 * u + kappa)))))\"\>"], \
"Output",
 CellLabel->
  "Out[37]=",ExpressionUUID->"d4573903-d733-4596-ba1d-ecf57eb0e4ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"495da9d4-101d-49c2-a0dc-1b46eef5dacb"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff4 = 16 \
* q**4 * ((1 + q))**2 * (1 + (-32 * S1**2 * u**2 + (8 * u * (12 * S2**4 * \
u**3 + (-2 * kappa + (2 * u * ((-1 * S1**2 * u + kappa))**2 + S2**2 * u * (1 \
+ -12 * u * (S1**2 * u + kappa))))) + (q * (-2 + (-96 * S1**4 * u**4 + (8 * \
S1**2 * u**2 * (7 + 4 * u * (5 * S2**2 * u + kappa)) + 8 * u * (-12 * S2**4 * \
u**3 + (2 * kappa * (-3 + 4 * u * kappa) + S2**2 * u * (7 + 4 * u * \
kappa)))))) + q**2 * (1 + 8 * u * (-2 * kappa + u * (-4 * S2**2 + (12 * S1**4 \
* u**2 + (2 * ((-1 * S2**2 * u + kappa))**2 + S1**2 * (1 + -12 * u * (S2**2 * \
u + kappa)))))))))))\"\>"], "Output",
 CellLabel->
  "Out[39]=",ExpressionUUID->"2d0c4616-bfe6-4a3b-b6c9-3fbe17760380"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"9375065a-5620-4322-b145-957bf7373534"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = 32 \
* q**3 * ((1 + q))**3 * (16 * (-1 + q) * q * (-1 + 2 * q) * S1**6 * u**5 + \
(16 * (-2 + q) * (-1 + q) * S2**6 * u**5 + (4 * S2**4 * u**3 * (-5 + (20 * q \
+ (-14 * q**2 + (q**3 + -4 * (3 + q * (-5 + 3 * q)) * u * kappa)))) + ((1 + \
q) * kappa * (-1 * ((-1 + q))**2 + (4 * (1 + q * (8 + q)) * u * kappa + -16 * \
q * u**2 * kappa**2)) + (S2**2 * u * (-1 * ((-1 + q))**2 * (3 + 5 * q) + (-4 \
* q * (19 + q * (-5 + 2 * q)) * u * kappa + 16 * (1 + q * (-1 + 3 * q)) * \
u**2 * kappa**2)) + (-4 * S1**4 * u**3 * (-1 + (-4 * S2**2 * u**2 + q * (14 + \
(5 * (-4 + q) * q + (8 * S2**2 * u**2 + (4 * q * (-4 + 3 * q) * S2**2 * u**2 \
+ 4 * (3 + q * (-5 + 3 * q)) * u * kappa)))))) + S1**2 * u * (-5 + (-8 * u * \
(6 * S2**4 * u**3 + (kappa + 2 * S2**2 * u * (1 + 2 * u * kappa))) + (q * (7 \
+ (64 * S2**4 * u**4 + (8 * S2**2 * u**2 * (1 + 6 * u * kappa) + 4 * u * \
kappa * (5 + 12 * u * kappa)))) + (q**3 * (-3 + 16 * u**2 * (S2**4 * u**2 + \
(kappa**2 + -1 * S2**2 * (1 + 2 * u * kappa)))) + q**2 * (1 + -4 * u * (8 * \
S2**4 * u**3 + (kappa * (19 + 4 * u * kappa) + -2 * S2**2 * u * (1 + 6 * u * \
kappa))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[41]=",ExpressionUUID->"465b3e7c-1aa7-45cc-8ae4-4672a40b1c84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"eb8d39ef-e220-46e0-8c14-b999bc2c8c89"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = 16 \
* q**2 * ((1 + q))**4 * (16 * ((-1 + q))**2 * q**2 * S1**8 * u**6 + (16 * \
((-1 + q))**2 * S2**8 * u**6 + (kappa**2 * (((-1 + q))**2 * (1 + q * (4 + q)) \
+ (-32 * q * (1 + q * (3 + q)) * u * kappa + 16 * q**2 * u**2 * kappa**2)) + \
(S2**4 * u**2 * (((-1 + q))**2 * (-23 + (-40 + q) * q) + (16 * (5 + -2 * q * \
(9 + q * (-8 + 3 * q))) * u * kappa + 16 * (1 + 6 * (-1 + q) * q) * u**2 * \
kappa**2)) + (S2**2 * (-1 * ((-1 + q))**4 + (-2 * ((-1 + q))**2 * (-7 + (-18 \
+ q) * q) * u * kappa + (8 * (-1 + q * (11 + 2 * q * (1 + 6 * q))) * u**2 * \
kappa**2 + 32 * (1 + -2 * q) * q * u**3 * kappa**3))) + (8 * (-1 + q) * S2**6 \
* u**4 * (11 + (4 * u * kappa + 2 * q * (-9 + (2 * q + -4 * u * kappa)))) + \
(-8 * (-1 + q) * q * S1**6 * u**4 * (4 + (-4 * S2**2 * u**2 + q * (-18 + (-8 \
* u * kappa + q * (11 + 4 * u * (S2**2 * u + kappa)))))) + (S1**4 * u**2 * \
(((1 + -4 * S2**2 * u**2))**2 + (q**4 * (-23 + 16 * u * (S2**4 * u**3 + (-2 * \
S2**2 * u * (-2 + u * kappa) + kappa * (5 + u * kappa)))) + (2 * q**3 * (3 + \
8 * u * (2 * S2**4 * u**3 + (-6 * kappa * (3 + u * kappa) + S2**2 * u * (-11 \
+ 4 * u * kappa)))) + (q**2 * (58 + -16 * u * (6 * S2**4 * u**3 + (-2 * kappa \
* (8 + 3 * u * kappa) + S2**2 * u * (-5 + 8 * u * kappa)))) + q * (-42 + 8 * \
u * (-12 * kappa + S2**2 * u * (5 + 4 * u * (S2**2 * u + 3 * kappa)))))))) + \
S1**2 * (-1 + (4 * q**3 * (1 + (-8 * S2**6 * u**6 + (2 * S2**4 * u**4 * (5 + \
12 * u * kappa) + (-1 * S2**2 * u**2 * (23 + 8 * u * kappa * (4 + 3 * u * \
kappa)) + 2 * u * kappa * (1 + u * kappa * (11 + 4 * u * kappa)))))) + (q**4 \
* (-1 + 2 * u * (-4 * S2**4 * u**3 + (kappa * (7 + -4 * u * kappa) + S2**2 * \
u * (11 + 8 * u * kappa)))) + (2 * q**2 * (-3 + 2 * u * (8 * S2**6 * u**5 + \
(4 * S2**4 * u**3 * (5 + -8 * u * kappa) + (kappa * (-15 + 4 * u * kappa * (1 \
+ -4 * u * kappa)) + 5 * S2**2 * u * (7 + 8 * u * kappa * (2 + u * \
kappa)))))) + (4 * q * (1 + u * (8 * S2**6 * u**5 + (4 * S2**4 * u**3 * (-11 \
+ 4 * u * kappa) + (2 * kappa * (5 + 12 * u * kappa) + -1 * S2**2 * u * (23 + \
8 * u * kappa * (4 + 3 * u * kappa)))))) + 2 * u * (-1 * kappa + S2**2 * u * \
(11 + 8 * u * (kappa + -2 * S2**2 * u * (-2 + u * (S2**2 * u + \
kappa))))))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[43]=",ExpressionUUID->"ff32710d-0744-4ca4-8214-cea0a6fab6b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"7eb56112-22a3-4e91-8a4d-beeabff2bb6b"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = -32 \
* q * ((1 + q))**2 * (4 * ((-1 + q))**2 * q**2 * ((1 + q))**3 * (-5 + 8 * q) \
* S1**8 * u**5 + (-1 * (-1 + q) * q * ((1 + q))**3 * S1**6 * u**3 * (-1 + (26 \
* q + (-13 * q**2 + (-12 * q**3 + (4 * (-1 + q) * (1 + 3 * q) * (-1 + 4 * q) \
* S2**2 * u**2 + 4 * q * (20 + q * (-29 + 12 * q)) * u * kappa))))) + ((-1 * \
(1 + q) * S2**2 * u + (kappa + q * kappa)) * (16 * ((-1 + q))**3 * ((1 + \
q))**2 * S2**6 * u**4 + (q**2 * ((1 + q))**2 * kappa**2 * (((-1 + q))**2 + \
-16 * q * u * kappa) + (-1 * (-1 + q) * ((1 + q))**2 * S2**2 * (((-1 + q))**3 \
+ (2 * (-10 + q) * (-1 + q) * q * u * kappa + -48 * q**2 * u**2 * kappa**2)) \
+ ((-1 + q**2))**2 * S2**4 * u**2 * (-8 + q * (-20 + (q + -48 * u * \
kappa)))))) + (-1 * (1 + q) * ((-1 * (1 + q) * S2**2 * u + (kappa + q * \
kappa)))**2 * (4 * (-4 + q) * ((-1 + q))**2 * S2**4 * u**3 + (q * kappa * (-1 \
* ((-1 + q))**2 + 4 * q * (5 + q) * u * kappa) + -1 * (-1 + q) * S2**2 * u * \
(-4 + q * (-1 + (4 * u * kappa + q * (5 + 8 * u * kappa)))))) + (((1 + q))**3 \
* S1**2 * (4 * (-4 + q) * ((-1 + q))**2 * (3 + q) * S2**6 * u**5 + ((1 + q) * \
S2**2 * u * (-5 * ((-1 + q))**4 + (-2 * ((-1 + q))**2 * (4 + q * (-7 + 4 * \
q)) * u * kappa + 12 * q * (1 + q**2) * u**2 * kappa**2)) + (q * kappa * (-1 \
* ((-1 + q))**4 + (((-1 + q))**2 * (-3 + q * (23 + 4 * q)) * u * kappa + -4 * \
q * (-20 + q * (3 + q)) * u**2 * kappa**2)) + (-1 + q) * S2**4 * u**3 * (32 * \
(1 + u * kappa) + q * (-53 + (-56 * u * kappa + q * (50 + q * (-33 + (4 * q + \
-12 * u * kappa))))))))) + -1 * ((1 + q))**2 * S1**4 * u * (-4 * ((-1 + \
q**2))**2 * (4 + (q + 4 * q**2)) * S2**4 * u**4 + (q * (1 + q) * (-1 * ((-1 + \
q))**4 + (((-1 + q))**2 * (-3 + q * (49 + 16 * q)) * u * kappa + 4 * q * (30 \
+ q * (-39 + (19 + -4 * q) * q)) * u**2 * kappa**2)) + (-1 + q**2) * S2**2 * \
u**2 * (4 + q * (-3 * (11 + 4 * u * kappa) + q * (50 + q * (-53 + (32 * q + 8 \
* (-7 + 4 * q) * u * kappa))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[45]=",ExpressionUUID->"3d6c1031-2191-4c57-80e3-595c3098e0b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"cd7a1188-23c3-46a9-b4b2-379813f0f34b"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = -16 \
* ((1 + q))**4 * (16 * ((-1 + q))**3 * q**3 * ((1 + q))**2 * S1**10 * u**6 + \
((-1 + q) * q * ((1 + q))**2 * S1**6 * u**2 * ((-1 + q) * (((-1 + q))**2 * q \
+ (-4 * (-5 + q * (27 + q * (-3 + 8 * q))) * S2**2 * u**2 + 16 * (-1 + q) * \
(3 + q * (6 + q)) * S2**4 * u**4)) + (-4 * (-1 + q) * q * u * (-1 + (15 * q + \
(4 * q**2 + 8 * (6 + (-1 + q) * q) * S2**2 * u**2))) * kappa + 16 * q**2 * \
(10 + (-8 + q) * q) * u**2 * kappa**2)) + (-1 * S1**4 * u * (16 * ((-1 + \
q))**3 * ((1 + q))**2 * (1 + 3 * q * (2 + q)) * S2**6 * u**5 + (-2 * ((-1 + \
q**2))**2 * S2**4 * u**3 * (4 + (q * (6 + q * (61 + (6 * q + 4 * q**2))) + 72 \
* (q + q**3) * u * kappa)) + (2 * kappa * (((-1 + q))**4 * q**2 * ((1 + \
q))**2 + (-1 * (-3 + (30 * q + 4 * q**2)) * ((q + -1 * q**3))**2 * u * kappa \
+ -8 * q**3 * ((1 + q))**2 * (10 + 3 * (-4 + q) * q) * u**2 * kappa**2)) + \
(-1 + q) * ((1 + q))**2 * S2**2 * u * (((-1 + q))**3 * (-1 + 2 * q * (12 + 5 \
* q)) + (4 * (-1 + q) * q * (15 + q * (-55 + 2 * q * (9 + 2 * q))) * u * \
kappa + 144 * q**2 * (2 + (-2 + q) * q) * u**2 * kappa**2))))) + (((1 + \
q))**2 * S1**2 * (16 * ((-1 + q))**3 * (2 + 3 * q) * S2**8 * u**6 + (4 * ((-1 \
+ q))**2 * S2**6 * u**4 * (-8 + (3 * q + (-27 * q**2 + (5 * q**3 + 8 * (-1 + \
(q + -6 * q**2)) * u * kappa)))) + (q**2 * kappa**2 * (((-1 + q))**4 + (-4 * \
((-1 + q))**2 * (-1 + 5 * q) * u * kappa + 16 * q * (-5 + 3 * q) * u**2 * \
kappa**2)) + ((-1 + q) * S2**4 * u**2 * (((-1 + q))**3 * (-10 + (-24 + q) * \
q) + (-4 * (-1 + q) * (4 + q * (18 + 5 * q * (-11 + 3 * q))) * u * kappa + \
144 * q * (1 + 2 * (-1 + q) * q) * u**2 * kappa**2)) + S2**2 * (-1 * ((-1 + \
q))**6 + (-2 * ((-1 + q))**4 * (1 + (-12 + q) * q) * u * kappa + (4 * ((-1 + \
q))**2 * q * (15 + q * (-29 + 15 * q)) * u**2 * kappa**2 + -32 * q**2 * (6 + \
q * (-11 + 6 * q)) * u**3 * kappa**3))))))) + (-1 * ((-1 * S2**2 * u + \
kappa))**2 * (16 * ((-1 + q))**3 * ((1 + q))**2 * S2**6 * u**4 + (q**2 * ((1 \
+ q))**2 * kappa**2 * (((-1 + q))**2 + -16 * q * u * kappa) + (-1 * (-1 + q) \
* ((1 + q))**2 * S2**2 * (((-1 + q))**3 + (2 * (-10 + q) * (-1 + q) * q * u * \
kappa + -48 * q**2 * u**2 * kappa**2)) + ((-1 + q**2))**2 * S2**4 * u**2 * \
(-8 + q * (-20 + (q + -48 * u * kappa)))))) + -1 * ((q + -1 * q**3))**2 * \
S1**8 * u**4 * (1 + (-48 * S2**2 * u**2 + 4 * q * (-5 + (4 * u * (S2**2 * u + \
-5 * kappa) + q * (-2 + 8 * u * (S2**2 * u + kappa)))))))))))\"\>"], "Output",
 
 CellLabel->
  "Out[47]=",ExpressionUUID->"b6c5473a-f6dd-451f-93e4-a9d40b40623f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"ce19b8c5-6f70-425c-bba6-322a34a17cfc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xicoeff6", "*", " ", 
    RowBox[{"\[Xi]", "^", "6"}]}], "+", 
   RowBox[{"xicoeff5", "*", " ", 
    RowBox[{"\[Xi]", "^", "5"}]}], "+", " ", 
   RowBox[{"xicoeff4", "*", " ", 
    RowBox[{"\[Xi]", "^", "4"}]}], "+", 
   RowBox[{"xicoeff3", "*", " ", 
    RowBox[{"\[Xi]", "^", "3"}]}], " ", "+", " ", 
   RowBox[{"xicoeff2", "*", " ", 
    RowBox[{"\[Xi]", "^", "2"}]}], " ", "+", " ", 
   RowBox[{"xicoeff1", "*", " ", "\[Xi]"}], "+", " ", "xicoeff0", " ", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"d95e825c-c206-4f06-8ed0-e34071bbe60e"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[48]=",ExpressionUUID->"18ff1260-f760-4afd-a2a4-7d9180dc777e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Clean this notebook for inclusion in git repository. ",
 StyleBox["Credits: http://bhptoolkit.org/cleannb.html", "Subsection"],
 " "
}], "Subsubsection",ExpressionUUID->"9bc2331b-48ed-4351-97b7-f9794daee1cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CleanNotebook", "[", "file_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nb", ",", "contents", ",", "newcontents"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nb", "=", 
       RowBox[{"NotebookOpen", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetOptions", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"\"\<TrackCellChangeTimes\>\"", "->", "False"}], ",", 
        RowBox[{"PrivateNotebookOptions", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<FileOutlineCache\>\"", "->", "False"}], "}"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"contents", "=", 
       RowBox[{"NotebookGet", "[", "nb", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"newcontents", "=", 
       RowBox[{"contents", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellChangeTimes", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellTags", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NotebookPut", "[", 
       RowBox[{"newcontents", ",", "nb"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"NotebookSave", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NotebookClose", "[", "nb", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"0c75dd10-8a15-45e0-9a92-2975d60d10cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanNotebook", "[", 
   RowBox[{"NotebookFileName", "[", "]"}], "]"}], ";"}]], "Input",
 CellLabel->
  "In[50]:=",ExpressionUUID->"a2ab0607-6ac8-4b67-a02e-dc730441c5c7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1654, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False,
ExpressionUUID->"ceb27b6a-17ef-40ed-91d0-092d78b52fe3"
]

