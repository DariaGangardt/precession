Notebook[{

Cell[CellGroupData[{
Cell["precession v2: polynomial coefficients", \
"Title",ExpressionUUID->"df97b6ce-6f3c-4484-a8ac-f7def5a98a30"],

Cell["Davide Gerosa", \
"Subtitle",ExpressionUUID->"e4f4e6e0-6210-4e03-aca4-03b35fe7b4c6"],

Cell[TextData[StyleBox["This is a notebook to derive some long polynomial \
coefficients that describe the dynamics of spinning black-hole binaries at \
2PN. In particular, we present \[LineSeparator]expressions for (i) the \
evolution of the total spin on the precessional timescale, (ii) the \
identification of the spin-orbit resonances in terms of the generalized \
angular momentum \[Kappa], and (iii)  the identification of the spin-orbit \
resonances in terms of the effective spin \[Xi].  ", "Subsection"]], \
"Subtitle",ExpressionUUID->"3c7119ff-8eca-45de-b8e1-bb0017a45407"],

Cell[CellGroupData[{

Cell["\<\
Package to export expressions in a format that python and numpy are going to \
like. This packaged was written by Gustavo Wiederhecker, to which I made \
minor edits; I \[LineSeparator]use my fork until the related pull request is \
accepted. \
\>", "Subsubsection",ExpressionUUID->"24e4e467-bf85-43a7-acb7-4e68685e9eed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"URLDownload", "[", 
    RowBox[{
    "\"\<https://raw.githubusercontent.com/gwiederhecker/ToPython/master/\
ToPython.wl\>\"", ",", "\"\<ToPython.wl\>\""}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<ToPython`\>\"", "]"}]}], "Input",
 CellLabel->"In[170]:=",ExpressionUUID->"411dc8e9-b9b7-46d8-9d11-bbd3bae0d8b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Custom function to convert in a form that is ready for precession v2\
\>", "Subsubsection",ExpressionUUID->"e7b01c7c-0fc8-4100-9555-ec4b826dae94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"precessionform", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"x", "<>", "\"\< = \>\"", "<>", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToPython", "[", 
      RowBox[{"y", ",", 
       RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<(q)\>\"", "\[Rule]", "\"\<q\>\""}], ",", 
       RowBox[{"\"\<(L)\>\"", "\[Rule]", "\"\<L\>\""}], ",", 
       RowBox[{"\"\<(S)\>\"", "\[Rule]", "\"\<S\>\""}], ",", 
       RowBox[{"\"\<(J)\>\"", "\[Rule]", "\"\<J\>\""}], ",", 
       RowBox[{"\"\<(S1)\>\"", "\[Rule]", "\"\<S1\>\""}], ",", 
       RowBox[{"\"\<(S2)\>\"", "\[Rule]", "\"\<S2\>\""}], ",", 
       RowBox[{"\"\<(u)\>\"", "->", "\"\<u\>\""}], ",", 
       RowBox[{"\"\<(kappa)\>\"", "->", "\"\<kappa\>\""}], ",", 
       RowBox[{"\"\<(xi)\>\"", "->", "\"\<xi\>\""}], ",", 
       RowBox[{"\"\<(2)\>\"", "->", "\"\<2\>\""}], ",", 
       RowBox[{"\"\<(3)\>\"", "->", "\"\<3\>\""}], ",", 
       RowBox[{"\"\<(4)\>\"", "->", "\"\<4\>\""}], ",", 
       RowBox[{"\"\<(5)\>\"", "->", "\"\<5\>\""}], ",", 
       RowBox[{"\"\<(6)\>\"", "->", "\"\<6\>\""}], ",", 
       RowBox[{"\"\<(7)\>\"", "->", "\"\<7\>\""}], ",", 
       RowBox[{"\"\<(8)\>\"", "->", "\"\<8\>\""}], ",", 
       RowBox[{"\"\<(9)\>\"", "->", "\"\<9\>\""}], ",", 
       RowBox[{"\"\<(10)\>\"", "->", "\"\<10\>\""}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellLabel->"In[172]:=",ExpressionUUID->"b93aa900-6b2a-4037-9225-18b886369648"]
}, Open  ]],

Cell[CellGroupData[{

Cell["(i) Cubic equation in S^2 ", \
"Section",ExpressionUUID->"c0e869be-ff54-446f-a2b6-df21502ac588"],

Cell[CellGroupData[{

Cell["\<\
Effective potentials; see Eqs. (13-14) of Gerosa et al. (2015), \
arxiv:1506.03492. \
\>", "Subsubsection",ExpressionUUID->"c0c58bd8-8d16-4fd6-9c68-dd04e516faa5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", 
   FractionBox["1", 
    RowBox[{"4", "q", "  ", 
     RowBox[{"S", "^", "2"}], " ", "L"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "^", "2"}], " ", "-", " ", 
      RowBox[{"L", "^", "2"}], "-", 
      RowBox[{"S", "^", "2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "^", "2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"S1", "^", "2"}], "-", 
         RowBox[{"S2", "^", "2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"q", "^", "2"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "S"}], ")"}], "^", "2"}], "-", 
       RowBox[{"J", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "  ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "S"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "+", "S2"}], ")"}], "^", "2"}], "-", 
       RowBox[{"S", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "-", "S2"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}]}], " ", ";"}]}], "Input",
 CellLabel->
  "In[173]:=",ExpressionUUID->"e4d2c0bc-b46c-46bd-83db-cdc908942fc7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xiSvarphi", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"t1", 
     RowBox[{"(", 
      RowBox[{"t2", "-", 
       RowBox[{
        RowBox[{"Cos", "[", "varphi", "]"}], "t3"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<xi\>\"", ",", "xiSvarphi"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->
  "In[176]:=",ExpressionUUID->"ad2238e9-6b82-40b1-963b-8c6c1e46b27b"],

Cell[BoxData["\<\"xi = 1/4 * L**(-1) * q**(-1) * S**(-2) * ((J**2 + (-1 * \
L**2 + -1 * S**2)) * (((1 + q))**2 * S**2 + (-1 + q**2) * (S1**2 + -1 * \
S2**2)) + -1 * (1 + -1 * q**2) * ((J**2 + -1 * ((L + -1 * S))**2))**(1/2) * \
((-1 * J**2 + ((L + S))**2))**(1/2) * ((S**2 + -1 * ((S1 + -1 * \
S2))**2))**(1/2) * ((-1 * S**2 + ((S1 + S2))**2))**(1/2) * \
np.cos(varphi))\"\>"], "Output",
 CellLabel->"Out[177]=",ExpressionUUID->"aa9bd920-1e2d-4d91-b1a0-8937ce252a0b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Equation (\[Xi]_\[PlusMinus](S)-\[Xi])^2=0; substitute  \[Kappa] and u; \
multiply by some constant factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"ee7dffd3-d7d3-4fcb-874a-e6ba74540778"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"effpot", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"t3", "^", "2"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "/", "t1"}], ")"}], " ", "-", " ", "t2"}], ")"}], 
     "^", "2"}]}], " ", "]"}]}]], "Input",
 CellLabel->
  "In[178]:=",ExpressionUUID->"4e672101-9b8f-4bf1-82b0-322e6c1b52b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["J", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "-", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["J", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "+", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["S", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "-", "S2"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "+", "S2"}], ")"}], "2"]}], ")"}]}], "-", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["J", "2"], "-", 
        SuperscriptBox["L", "2"], "-", 
        SuperscriptBox["S", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox["S", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["S1", "2"], "-", 
           SuperscriptBox["S2", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", "L", " ", "q", " ", 
      SuperscriptBox["S", "2"], " ", "\[Xi]"}]}], ")"}], "2"]}]], "Output",
 CellLabel->"Out[178]=",ExpressionUUID->"f8eb9bfd-d33e-4598-b94f-6eb55a70fae7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"effpot", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "^", "2"}], "  ", 
         RowBox[{"effpot", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"S", "^", "2"}]}], ")"}]}]}], "//.", 
        RowBox[{"{", 
         RowBox[{"J", "\[Rule]", 
          RowBox[{"Sqrt", "[", "Js", "]"}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{"Js", "->", 
         RowBox[{
          RowBox[{"2", " ", "L", " ", "\[Kappa]"}], " ", "+", " ", 
          RowBox[{"L", "^", "2"}]}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{"L", "\[Rule]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "u"}], ")"}]}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Sqrt", "[", "Ss", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->
  "In[179]:=",ExpressionUUID->"3c6202c4-bdd5-40f8-a5e6-9df48d2ca59e"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "-", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "+", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["Ss"]}], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox["Ss"], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["S1", "2"], "-", 
             SuperscriptBox["S2", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "Ss"}]}], ")"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "+", 
       RowBox[{"2", " ", "q", " ", "Ss", " ", "\[Xi]"}]}], ")"}], "2"]}], 
   RowBox[{"4", " ", "Ss"}]]}]], "Output",
 CellLabel->"Out[179]=",ExpressionUUID->"45ec7efa-75dd-40d2-a227-5d7a76bf2994"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract coefficients.", \
"Subsubsection",ExpressionUUID->"13e1838a-cc7e-45e8-8ddf-4872cf4e4cfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[180]:=",ExpressionUUID->"079f3ded-03a7-47c8-a9be-9cbcab1515df"],

Cell[BoxData["\<\"coeff3 = q * ((1 + q))**2 * u**2\"\>"], "Output",
 CellLabel->"Out[181]=",ExpressionUUID->"79462131-75bb-480d-b1f0-4459195456de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[182]:=",ExpressionUUID->"68e66e7d-53fb-4980-917a-c0decd9bb1f3"],

Cell[BoxData["\<\"coeff2 = 1/4 * ((1 + q))**2 * (1 + (4 * S2**2 * u**2 + \
(q**2 * (1 + 4 * S1**2 * u**2) + -2 * q * (1 + 2 * u * ((S1**2 + S2**2) * u + \
(2 * kappa + -1 * xi))))))\"\>"], "Output",
 CellLabel->"Out[183]=",ExpressionUUID->"6c183766-dcda-4826-a4da-5a1cf0b8d718"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[184]:=",ExpressionUUID->"da2ca2c6-88f6-46d3-bdb0-29d6386c92a1"],

Cell[BoxData["\<\"coeff1 = (q * (kappa + (q * kappa + -1 * xi)) * (kappa + (q \
* kappa + -1 * q * xi)) + (-1/2 * (-1 + q**2) * S1**2 * ((1 + q) * (-1 + (q + \
4 * q * u * kappa)) + -2 * q * u * xi) + -1/2 * (-1 + q**2) * S2**2 * ((1 + \
q) * (-1 + (q + -4 * u * kappa)) + 2 * q * u * xi)))\"\>"], "Output",
 CellLabel->"Out[185]=",ExpressionUUID->"111f5bde-90b7-4584-a656-5ca3b8e10a4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff0 = \>\"", "<>", " ", 
  RowBox[{"ToPython", "[", 
   RowBox[{"%", ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[186]:=",ExpressionUUID->"21a01190-f31b-4719-8014-c348f8749abb"],

Cell[BoxData["\<\"coeff0 = 1/4 * (-1 + q) * (1 + q) * ((1 + q) * ((-1 + q) * \
(((S1)**(2) + -1 * (S2)**(2)))**(2) + 4 * (q * (S1)**(2) + -1 * (S2)**(2)) * \
(kappa)**(2)) + -4 * q * (S1 + -1 * S2) * (S1 + S2) * kappa * xi)\"\>"], \
"Output",
 CellLabel->"Out[187]=",ExpressionUUID->"31612049-fef6-400b-a7bb-83f81c7e3f44"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"32f94662-aa1e-4294-a7ff-d286f22ffde8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Scoeff3", "*", " ", 
    RowBox[{"Ss", "^", "3"}]}], "+", 
   RowBox[{"Scoeff2", "*", 
    RowBox[{"Ss", "^", "2"}]}], "+", 
   RowBox[{"Scoeff1", "*", "Ss"}], " ", "+", " ", "Scoeff0", " ", "-", " ", 
   "effpot"}], "//", "FullSimplify"}]], "Input",
 CellLabel->
  "In[188]:=",ExpressionUUID->"4b017317-5de6-4ea9-bbb6-418dc7dbd5ec"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[188]=",ExpressionUUID->"3d209d59-790f-45e9-a6fb-aa76187f4e22"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(ii) Spin-orbit resonances in \[Kappa] ", \
"Section",ExpressionUUID->"0e3686cf-3fec-4ac4-aa71-77d95cb051d3"],

Cell[CellGroupData[{

Cell["\<\
Compute discriminant of the cubic equation in S^2; multiply by some constant \
factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"793bf80c-c2ed-4af6-884d-fe0a570e8c56"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"discr", " ", "=", " ", 
   RowBox[{
    RowBox[{"Discriminant", "[", 
     RowBox[{"effpot", ",", "Ss"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"discr", "=", " ", 
  RowBox[{"discr", 
   FractionBox["256", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["q", "2"]}], ")"}], "2"]]}]}]}], "Input",
 CellLabel->
  "In[189]:=",ExpressionUUID->"0db8634f-557a-4032-b2e4-6cc75722cdee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "16"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["q", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "6"], " ", 
     SuperscriptBox["S1", "10"], " ", 
     SuperscriptBox["u", "6"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["q", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
     SuperscriptBox["S1", "8"], " ", 
     SuperscriptBox["u", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"48", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["q", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"9", "+", 
          RowBox[{"40", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"40", " ", "u", " ", "\[Kappa]"}], "-", 
          RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "47"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Xi]", "2"]}], "-", 
          RowBox[{"8", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", "\[Kappa]"}], "+", 
             RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "9"}], "+", 
          RowBox[{"20", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]", "+", 
             RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["S1", "6"], " ", 
     SuperscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "7"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"16", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "-", 
          RowBox[{"32", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"144", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"17", "+", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "+", 
          RowBox[{"40", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"13", "-", 
             RowBox[{"40", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"51", "+", 
             RowBox[{"88", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"272", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"34", " ", "\[Kappa]"}], "-", 
             RowBox[{"19", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", 
           SuperscriptBox["\[Xi]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"44", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"11", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
             RowBox[{"14", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "5"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"112", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
           SuperscriptBox["\[Xi]", "2"]}], "+", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "116"}], " ", "\[Kappa]"}], "+", 
             RowBox[{"74", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "176"}], " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"40", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
             RowBox[{"88", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "21"}], "-", 
             RowBox[{"32", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "4"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"44", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"28", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"80", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "6"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"28", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"20", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"6", " ", "\[Xi]"}], "-", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"23", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"13", "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"\[Kappa]", "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", 
           SuperscriptBox["S2", "2"], " ", "u"}], ")"}]}], "+", "\[Kappa]", 
        "+", 
        RowBox[{"q", " ", "\[Kappa]"}], "-", 
        RowBox[{"q", " ", "\[Xi]"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["q", "4"], "+", 
          RowBox[{"8", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "8"}], "+", 
          SuperscriptBox["q", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"24", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"12", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "47"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"24", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"5", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"24", " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"5", " ", "\[Xi]"}], "+", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{"8", "-", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"18", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"5", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"19", " ", "\[Kappa]"}], "-", 
                RowBox[{"9", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "72"}], " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"\[Xi]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "q"}], ")"}], " ", 
     SuperscriptBox["S1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "5"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"3", " ", "q"}]}], ")"}], " ", 
        SuperscriptBox["S2", "8"], " ", 
        SuperscriptBox["u", "6"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           SuperscriptBox["q", "4"]}], "-", 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "22"}], "-", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "24"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"20", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q", "8"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{
           SuperscriptBox["q", "10"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "9"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "36"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"15", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "86"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"20", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"12", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", "+", 
          RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"16", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{"3", " ", "q"}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"5", " ", 
              SuperscriptBox["q", "5"]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"5", "-", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "5"}], "-", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"13", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"52", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"18", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "q", "-", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"10", " ", "q", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"10", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["S1", "4"], " ", "u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"6", " ", "q"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "5"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "6"]}], "+", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"134", "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{"10", "-", 
             RowBox[{"12", " ", "q"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["q", "2"]}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["q", "6"]}], "-", 
             RowBox[{"30", " ", "q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"15", "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"10", "+", 
                RowBox[{"36", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"11", "+", 
                RowBox[{"60", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "60"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"3", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"16", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"22", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"35", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"98", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "7"]}], "+", 
             RowBox[{"u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"23", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"25", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"47", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"120", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[190]=",ExpressionUUID->"d1e003f3-39d2-4aa8-b335-9b3680aa8dbb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"b3a25883-2730-480f-80d0-4532fdef53cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[191]:=",ExpressionUUID->"1e6dcdbf-a1a8-4c06-8c99-7e9e5f8dfaed"],

Cell[BoxData["\<\"coeff5 = -256 * q**3 * ((1 + q))**6 * u\"\>"], "Output",
 CellLabel->"Out[192]=",ExpressionUUID->"784b3d02-6c0f-4e97-bb22-a77489219f8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[193]:=",ExpressionUUID->"1755cb53-8a18-4227-b893-09bce1de93e6"],

Cell[BoxData["\<\"coeff4 = 16 * q**2 * ((1 + q))**4 * (((-1 + q**2))**2 + \
(-16 * ((1 + q))**2 * (q * (-5 + 3 * q) * S1**2 + (3 + -5 * q) * S2**2) * \
u**2 + (40 * q * ((1 + q))**2 * u * xi + 16 * q**2 * u**2 * xi**2)))\"\>"], \
"Output",
 CellLabel->"Out[194]=",ExpressionUUID->"c39006de-d487-41cc-911d-b6bb7fc2967d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[195]:=",ExpressionUUID->"d775cf2e-ece1-44d5-be79-ec6a616adeb5"],

Cell[BoxData["\<\"coeff3 = -32 * q * ((1 + q))**4 * (2 * q**6 * S1**2 * u * \
(-5 + 12 * S1**2 * u**2) + (2 * S2**2 * u * (-5 + 12 * S2**2 * u**2) + (2 * \
q**2 * u * (40 * S1**4 * u**2 + (-44 * S2**4 * u**2 + (8 * xi**2 + (S1**2 * \
(-5 + (-8 * S2**2 * u**2 + 40 * u * xi)) + -2 * S2**2 * (-5 + 4 * u * xi * (1 \
+ u * xi)))))) + (2 * q**3 * (32 * S1**4 * u**3 + (32 * S2**4 * u**3 + (xi * \
(-1 + 8 * u * xi * (3 + u * xi)) + (2 * S2**2 * u * (-1 + u * xi * (17 + 8 * \
u * xi)) + 2 * S1**2 * u * (-1 + (40 * S2**2 * u**2 + u * xi * (17 + 8 * u * \
xi))))))) + (q * (xi + 2 * u * (S1**2 * (1 + -48 * S2**2 * u**2) + S2**2 * (1 \
+ -2 * u * (12 * S2**2 * u + xi)))) + (q**5 * (xi + 2 * u * (S2**2 + S1**2 * \
(1 + -2 * u * (12 * (S1**2 + 2 * S2**2) * u + xi)))) + -2 * q**4 * u * (5 * \
S2**2 + (44 * S1**4 * u**2 + (-8 * (5 * S2**4 * u**2 + (5 * S2**2 * u * xi + \
xi**2)) + 2 * S1**2 * (-5 + 4 * u * (xi + u * (S2**2 + \
xi**2))))))))))))\"\>"], "Output",
 CellLabel->"Out[196]=",ExpressionUUID->"ff44e87d-f8b4-4f4a-9ada-987885b00609"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[197]:=",ExpressionUUID->"a9037bba-8b36-4941-ba07-164b00121afe"],

Cell[BoxData["\<\"coeff2 = -16 * ((1 + q))**2 * (16 * (-1 + q) * q**3 * ((1 + \
q))**4 * (10 + (-8 + q) * q) * S1**6 * u**4 + (-16 * ((-1 + q))**3 * ((1 + \
q))**4 * S2**6 * u**4 + (-1 * ((-1 + q**2))**2 * S2**4 * u**2 * (((1 + q))**2 \
* (-8 + (-20 + q) * q) + (8 * (-4 + q) * q * (1 + q) * u * xi + 16 * q**2 * \
u**2 * xi**2)) + (-1 * q**2 * (((1 + q) * S2**2 * u + q * xi))**2 * ((-1 + q) \
* ((1 + q))**2 * (-1 + (q + 48 * S2**2 * u**2)) + (8 * q * (1 + q) * (5 + q) \
* u * xi + 16 * q**2 * u**2 * xi**2)) + (2 * q**2 * ((1 + q))**2 * S1**4 * \
u**2 * ((-1 + q) * ((1 + q))**2 * ((-1 + q) * (-3 + (30 * q + 4 * q**2)) + \
-72 * (2 + (-2 + q) * q) * S2**2 * u**2) + (4 * q * (1 + q) * (-30 + q * (39 \
+ q * (-19 + 4 * q))) * u * xi + -8 * q**2 * (6 + (-6 + q) * q) * u**2 * \
xi**2)) + (-4 * q * (-1 * (1 + q) * S2**2 * u + -1 * q * xi) * (-1 * ((-1 + \
q))**2 * ((1 + q))**3 * S2**2 * u * (-10 + (q + 24 * S2**2 * u**2)) + (-1 * \
(-1 + q) * q * ((1 + q))**2 * (-1 + (q + 4 * (1 + 2 * q) * S2**2 * u**2)) * \
xi + (-8 * q**2 * (1 + q) * u * (2 + (q + 2 * (-1 + q) * S2**2 * u**2)) * \
xi**2 + -16 * q**3 * u**2 * xi**3))) + (q * (1 + q) * S1**2 * ((-1 + q) * ((1 \
+ q))**3 * (((-1 + q))**3 * q + (4 * (-1 + q) * (15 + q * (-29 + 15 * q)) * \
S2**2 * u**2 + 144 * (1 + 2 * (-1 + q) * q) * S2**4 * u**4)) + (2 * q * ((1 + \
q))**2 * u * (((-1 + q))**2 * (-3 + q * (23 + 4 * q)) + 12 * (1 + q) * (1 + \
q**2) * S2**2 * u**2) * xi + (8 * q**2 * (1 + q) * u**2 * (-12 + (-2 * q + \
(-11 * q**2 + (q**3 + 4 * (3 + q * (-5 + 3 * q)) * S2**2 * u**2)))) * xi**2 + \
-32 * q**3 * (3 + (-1 + q) * q) * u**3 * xi**3))) + (S2**2 * (((-1 + \
q**2))**4 + (2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u * xi + (8 \
* (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * xi**2 + 32 * q**3 * \
(-1 + q**2) * u**3 * xi**3))) + -1 * q**2 * xi**2 * (1 + q * (8 * u * xi + q \
* (-2 + (16 * u * xi + ((q + 4 * u * xi))**2))))))))))))\"\>"], "Output",
 CellLabel->"Out[198]=",ExpressionUUID->"b22c8a0a-9036-4fad-9c45-abf3be03ffed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[199]:=",ExpressionUUID->"afb466df-c96a-4af2-8f3a-1b5b31346992"],

Cell[BoxData["\<\"coeff1 = -16 * (1 + q) * (-16 * ((-1 + q))**2 * q**3 * ((1 \
+ q))**5 * (-5 + 2 * q) * S1**8 * u**5 + (-4 * (-1 + q) * q**2 * ((1 + q))**3 \
* S1**6 * u**3 * ((-1 + q) * ((1 + q))**2 * (-1 + (15 * q + (4 * q**2 + 8 * \
(6 + (-1 + q) * q) * S2**2 * u**2))) + (2 * q * (1 + q) * (20 + q * (-29 + 12 \
* q)) * u * xi + -8 * (-2 + q) * q**2 * u**2 * xi**2)) + (-2 * q * (((1 + q) \
* S2**2 * u + q * xi))**2 * (-1 * ((-1 + q))**2 * ((1 + q))**3 * S2**2 * u * \
(-10 + (q + 24 * S2**2 * u**2)) + (-1 * (-1 + q) * q * ((1 + q))**2 * (-1 + \
(q + 4 * (1 + 2 * q) * S2**2 * u**2)) * xi + (-8 * q**2 * (1 + q) * u * (2 + \
(q + 2 * (-1 + q) * S2**2 * u**2)) * xi**2 + -16 * q**3 * u**2 * xi**3))) + \
(-2 * q * ((1 + q))**2 * S1**4 * u * (((-1 + q))**2 * ((1 + q))**3 * (((-1 + \
q))**2 * q + (2 * (15 + q * (-55 + 2 * q * (9 + 2 * q))) * S2**2 * u**2 + -72 \
* (1 + q**2) * S2**4 * u**4)) + ((-1 + q) * q * ((1 + q))**2 * u * (3 + (-52 \
* q + (33 * q**2 + (16 * q**3 + 4 * (-3 + 2 * q**2 * (-7 + 4 * q)) * S2**2 * \
u**2)))) * xi + (-8 * q**2 * (1 + q) * u**2 * (6 + (-16 * q + (18 * q**2 + \
(-5 * q**3 + 2 * (-1 + q) * (3 + (-1 + q) * q) * S2**2 * u**2)))) * xi**2 + \
-16 * q**3 * (3 + q * (-5 + 3 * q)) * u**3 * xi**3))) + (S1**2 * (-32 * ((-1 \
+ q))**2 * ((1 + q))**5 * (1 + q * (-1 + 6 * q)) * S2**6 * u**5 + (-4 * (-1 + \
q) * ((1 + q))**3 * S2**4 * u**3 * ((-1 + q) * ((1 + q))**2 * (4 + q * (18 + \
5 * q * (-11 + 3 * q))) + (2 * q * (1 + q) * (-8 + (14 * q + 3 * q**3)) * u * \
xi + 8 * q**2 * (1 + q * (-1 + 3 * q)) * u**2 * xi**2)) + (2 * ((1 + q))**3 * \
S2**2 * u * (-1 * ((-1 + q))**4 * ((1 + q))**2 * (1 + (-12 + q) * q) + (-2 * \
q * ((-1 + q**2))**2 * (4 + q * (-7 + 4 * q)) * u * xi + (-8 * q**2 * (1 + q \
* (-8 + q * (20 + (-8 + q) * q))) * u**2 * xi**2 + 16 * (-2 + q) * q**3 * (-1 \
+ 2 * q) * u**3 * xi**3))) + 2 * q**2 * xi * (-1 * ((-1 + q**2))**4 + (-1 * \
((-1 + q))**2 * ((1 + q))**3 * (-1 + q * (18 + 7 * q)) * u * xi + (4 * q * \
((1 + q))**2 * (2 + q * (-5 + 19 * q)) * u**2 * xi**2 + 16 * q**2 * (1 + q**2 \
* (2 + 3 * q)) * u**3 * xi**3)))))) + -2 * (-1 * (1 + q) * S2**2 * u + -1 * q \
* xi) * (16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (((-1 + q**2))**2 \
* S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * (-4 + q) * q * \
(1 + q) * u * xi + 16 * q**2 * u**2 * xi**2)) + (S2**2 * (-1 * ((-1 + \
q**2))**4 + (-2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u * xi + \
(-8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * xi**2 + -32 * \
q**3 * (-1 + q**2) * u**3 * xi**3))) + q**2 * xi**2 * (1 + q * (8 * u * xi + \
q * (-2 + (16 * u * xi + ((q + 4 * u * xi))**2))))))))))))\"\>"], "Output",
 CellLabel->"Out[200]=",ExpressionUUID->"9f07bf51-84d8-40f8-9a40-aee95d89814a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[201]:=",ExpressionUUID->"a7715d25-d1f4-4b7d-ac62-d6c669d78b4e"],

Cell[BoxData["\<\"coeff0 = -16 * (16 * ((-1 + q))**3 * q**3 * ((1 + q))**6 * \
S1**10 * u**6 + (-1 * ((-1 + q))**2 * q**2 * ((1 + q))**4 * S1**8 * u**4 * \
(((1 + q))**2 * (1 + (-20 * q + (-8 * q**2 + 16 * (-3 + (q + 2 * q**2)) * \
S2**2 * u**2))) + (-8 * q * (1 + q) * (-5 + 8 * q) * u * xi + 16 * q**2 * \
u**2 * xi**2)) + ((-1 + q) * q * ((1 + q))**3 * S1**6 * u**2 * (q * ((-1 + \
q**2))**3 + (-4 * (-1 + q) * ((1 + q))**3 * (-5 + q * (27 + q * (-3 + 8 * \
q))) * S2**2 * u**2 + (16 * ((-1 + q))**2 * ((1 + q))**3 * (3 + q * (6 + q)) \
* S2**4 * u**4 + (-2 * (-1 + q) * q * ((1 + q))**2 * u * (1 + (-25 * q + (-12 \
* q**2 + 4 * (-1 + (q + 12 * q**2)) * S2**2 * u**2))) * xi + (8 * q**2 * (1 + \
q) * u**2 * (4 + (-18 * q + (11 * q**2 + 4 * (-1 + q**2) * S2**2 * u**2))) * \
xi**2 + 32 * (1 + -2 * q) * q**3 * u**3 * xi**3))))) + (((1 + q))**2 * S1**4 \
* u * (-16 * ((-1 + q))**3 * ((1 + q))**4 * (1 + 3 * q * (2 + q)) * S2**6 * \
u**5 + (2 * S2**4 * u**3 * (((-1 + q))**2 * ((1 + q))**4 * (4 + q * (6 + q * \
(61 + (6 * q + 4 * q**2)))) + (4 * ((-1 + q))**2 * q * ((1 + q))**4 * (4 + (q \
+ 4 * q**2)) * u * xi + -8 * q**2 * ((-1 + q**2))**2 * (1 + q * (4 + q)) * \
u**2 * xi**2)) + (xi * (2 * ((-1 + q))**4 * q**2 * ((1 + q))**3 + (((q + -1 * \
q**3))**2 * (-1 + q * (40 + 23 * q)) * u * xi + (8 * q**3 * (1 + q) * (-1 + q \
* (14 + 5 * (-4 + q) * q)) * u**2 * xi**2 + -16 * q**4 * (1 + 6 * (-1 + q) * \
q) * u**3 * xi**3))) + (-1 + q) * (1 + q) * S2**2 * u * (-1 * ((-1 + \
q**2))**3 * (-1 + 2 * q * (12 + 5 * q)) + (-2 * (-1 + q) * q * ((1 + q))**2 * \
(-4 + q * (29 + q * (-21 + 32 * q))) * u * xi + (-8 * q**2 * (1 + q) * (1 + 2 \
* (-2 + q) * q * (1 + 4 * q)) * u**2 * xi**2 + 32 * q**3 * (1 + q * (-1 + 3 * \
q)) * u**3 * xi**3)))))) + ((1 + q) * S1**2 * (16 * ((-1 + q))**3 * ((1 + \
q))**5 * (2 + 3 * q) * S2**8 * u**6 + (q**2 * xi**2 * (((-1 + q))**4 * ((1 + \
q))**3 + (2 * q * (5 + 3 * q) * ((-1 + q**2))**2 * u * xi + (-8 * q**2 * (1 + \
q) * (-4 + q * (7 + q)) * u**2 * xi**2 + 32 * (1 + -2 * q) * q**3 * u**3 * \
xi**3))) + ((-1 + q) * ((1 + q))**2 * S2**4 * u**2 * ((-10 + (-24 + q) * q) * \
((-1 + q**2))**3 + (2 * (-1 + q) * q * ((1 + q))**2 * (-32 + q * (21 + q * \
(-29 + 4 * q))) * u * xi + (8 * q**2 * (1 + q) * (8 + q * (-14 + (-4 + q) * \
q)) * u**2 * xi**2 + -32 * q**3 * (3 + (-1 + q) * q) * u**3 * xi**3))) + \
(S2**2 * (-1 * ((-1 + q))**6 * ((1 + q))**5 + (-10 * ((-1 + q))**4 * q * ((1 \
+ q))**5 * u * xi + (-2 * ((-1 + q))**2 * q**2 * ((1 + q))**3 * (11 + q * \
(-24 + 11 * q)) * u**2 * xi**2 + (16 * q**3 * ((1 + q))**3 * (2 + q * (-3 + 2 \
* q)) * u**3 * xi**3 + 32 * q**4 * (1 + q) * (3 + q * (-5 + 3 * q)) * u**4 * \
xi**4)))) + 4 * ((-1 + q))**2 * ((1 + q))**4 * S2**6 * u**4 * (-8 + q * (-5 + \
(-24 * q + (-22 * q**2 + (5 * q**3 + (2 * (-4 + q) * (3 + q) * u * xi + 8 * q \
* u**2 * xi**2)))))))))) + -1 * (((1 + q) * S2**2 * u + q * xi))**2 * (16 * \
((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (((-1 + q**2))**2 * S2**4 * \
u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * (-4 + q) * q * (1 + q) * u \
* xi + 16 * q**2 * u**2 * xi**2)) + (S2**2 * (-1 * ((-1 + q**2))**4 + (-2 * \
((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u * xi + (-8 * (-1 + q) * \
q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * xi**2 + -32 * q**3 * (-1 + q**2) \
* u**3 * xi**3))) + q**2 * xi**2 * (1 + q * (8 * u * xi + q * (-2 + (16 * u * \
xi + ((q + 4 * u * xi))**2))))))))))))\"\>"], "Output",
 CellLabel->"Out[202]=",ExpressionUUID->"5f0b6b14-9f8b-4c98-93e9-f13b729cee1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"e844d0b4-5781-4bc6-ba98-7334e6a0b589"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kappacoeff5", "*", " ", 
    RowBox[{"\[Kappa]", "^", "5"}]}], "+", 
   RowBox[{"kappacoeff4", "*", " ", 
    RowBox[{"\[Kappa]", "^", "4"}]}], "+", 
   RowBox[{"kappacoeff3", "*", " ", 
    RowBox[{"\[Kappa]", "^", "3"}]}], "+", 
   RowBox[{"kappacoeff2", "*", " ", 
    RowBox[{"\[Kappa]", "^", "2"}]}], "+", 
   RowBox[{"kappacoeff1", "*", " ", "\[Kappa]"}], "+", "kappacoeff0", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->
  "In[203]:=",ExpressionUUID->"092f68e7-4b8f-4bd1-a3c3-fb5f257b20a9"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[203]=",ExpressionUUID->"5c96b776-0da0-45d0-8416-ecf3dde400ea"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(iii) Spin-orbit resonances in xi ", \
"Section",ExpressionUUID->"d1275de9-c0f2-4c68-9e9b-6b549b44d512"],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"04e18a09-ed76-4e7d-a612-75639f6d8292"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff6", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "6"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff6\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[204]:=",ExpressionUUID->"e1706b26-bf8a-49bc-8376-e5809624ac96"],

Cell[BoxData["\<\"coeff6 = 256 * q**6 * u**2\"\>"], "Output",
 CellLabel->"Out[205]=",ExpressionUUID->"9f854d16-0c77-455d-b7b9-4e5c37cb6d06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[206]:=",ExpressionUUID->"1dce127f-f170-41f1-b034-e10f136317e4"],

Cell[BoxData["\<\"coeff5 = 128 * q**5 * (1 + q) * u * (1 + (q + (8 * q * \
S1**2 * u**2 + (-4 * u * (S1**2 * u + (-2 * S2**2 * u + kappa)) + -4 * q * u \
* (S2**2 * u + kappa)))))\"\>"], "Output",
 CellLabel->"Out[207]=",ExpressionUUID->"e36c2eea-5233-4a0f-af47-ae172fa11349"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[208]:=",ExpressionUUID->"347b33e8-c702-4982-98af-6c9a8950811a"],

Cell[BoxData["\<\"coeff4 = 16 * q**4 * ((1 + q))**2 * (1 + (-32 * S1**2 * \
u**2 + (8 * u * (12 * S2**4 * u**3 + (-2 * kappa + (2 * u * ((-1 * S1**2 * u \
+ kappa))**2 + S2**2 * u * (1 + -12 * u * (S1**2 * u + kappa))))) + (q * (-2 \
+ (-96 * S1**4 * u**4 + (8 * S1**2 * u**2 * (7 + 4 * u * (5 * S2**2 * u + \
kappa)) + 8 * u * (-12 * S2**4 * u**3 + (2 * kappa * (-3 + 4 * u * kappa) + \
S2**2 * u * (7 + 4 * u * kappa)))))) + q**2 * (1 + 8 * u * (-2 * kappa + u * \
(-4 * S2**2 + (12 * S1**4 * u**2 + (2 * ((-1 * S2**2 * u + kappa))**2 + S1**2 \
* (1 + -12 * u * (S2**2 * u + kappa)))))))))))\"\>"], "Output",
 CellLabel->"Out[209]=",ExpressionUUID->"0962cb2d-234f-4f05-b4b9-b4c8b76fa2a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[210]:=",ExpressionUUID->"5c40291b-e180-4bd5-86ea-11bdda4a8b10"],

Cell[BoxData["\<\"coeff3 = 32 * q**3 * ((1 + q))**3 * (16 * (-1 + q) * q * \
(-1 + 2 * q) * S1**6 * u**5 + (16 * (-2 + q) * (-1 + q) * S2**6 * u**5 + (4 * \
S2**4 * u**3 * (-5 + (20 * q + (-14 * q**2 + (q**3 + -4 * (3 + q * (-5 + 3 * \
q)) * u * kappa)))) + ((1 + q) * kappa * (-1 * ((-1 + q))**2 + (4 * (1 + q * \
(8 + q)) * u * kappa + -16 * q * u**2 * kappa**2)) + (S2**2 * u * (-1 * ((-1 \
+ q))**2 * (3 + 5 * q) + (-4 * q * (19 + q * (-5 + 2 * q)) * u * kappa + 16 * \
(1 + q * (-1 + 3 * q)) * u**2 * kappa**2)) + (-4 * S1**4 * u**3 * (-1 + (-4 * \
S2**2 * u**2 + q * (14 + (5 * (-4 + q) * q + (8 * S2**2 * u**2 + (4 * q * (-4 \
+ 3 * q) * S2**2 * u**2 + 4 * (3 + q * (-5 + 3 * q)) * u * kappa)))))) + \
S1**2 * u * (-5 + (-8 * u * (6 * S2**4 * u**3 + (kappa + 2 * S2**2 * u * (1 + \
2 * u * kappa))) + (q * (7 + (64 * S2**4 * u**4 + (8 * S2**2 * u**2 * (1 + 6 \
* u * kappa) + 4 * u * kappa * (5 + 12 * u * kappa)))) + (q**3 * (-3 + 16 * \
u**2 * (S2**4 * u**2 + (kappa**2 + -1 * S2**2 * (1 + 2 * u * kappa)))) + q**2 \
* (1 + -4 * u * (8 * S2**4 * u**3 + (kappa * (19 + 4 * u * kappa) + -2 * \
S2**2 * u * (1 + 6 * u * kappa))))))))))))))\"\>"], "Output",
 CellLabel->"Out[211]=",ExpressionUUID->"f4f460dc-d7c1-4504-ba90-e1f065142e07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[212]:=",ExpressionUUID->"a2c8caad-ffc6-4a30-ae69-48d20614cac0"],

Cell[BoxData["\<\"coeff2 = 16 * q**2 * ((1 + q))**4 * (16 * ((-1 + q))**2 * \
q**2 * S1**8 * u**6 + (16 * ((-1 + q))**2 * S2**8 * u**6 + (kappa**2 * (((-1 \
+ q))**2 * (1 + q * (4 + q)) + (-32 * q * (1 + q * (3 + q)) * u * kappa + 16 \
* q**2 * u**2 * kappa**2)) + (S2**4 * u**2 * (((-1 + q))**2 * (-23 + (-40 + \
q) * q) + (16 * (5 + -2 * q * (9 + q * (-8 + 3 * q))) * u * kappa + 16 * (1 + \
6 * (-1 + q) * q) * u**2 * kappa**2)) + (S2**2 * (-1 * ((-1 + q))**4 + (-2 * \
((-1 + q))**2 * (-7 + (-18 + q) * q) * u * kappa + (8 * (-1 + q * (11 + 2 * q \
* (1 + 6 * q))) * u**2 * kappa**2 + 32 * (1 + -2 * q) * q * u**3 * \
kappa**3))) + (8 * (-1 + q) * S2**6 * u**4 * (11 + (4 * u * kappa + 2 * q * \
(-9 + (2 * q + -4 * u * kappa)))) + (-8 * (-1 + q) * q * S1**6 * u**4 * (4 + \
(-4 * S2**2 * u**2 + q * (-18 + (-8 * u * kappa + q * (11 + 4 * u * (S2**2 * \
u + kappa)))))) + (S1**4 * u**2 * (((1 + -4 * S2**2 * u**2))**2 + (q**4 * \
(-23 + 16 * u * (S2**4 * u**3 + (-2 * S2**2 * u * (-2 + u * kappa) + kappa * \
(5 + u * kappa)))) + (2 * q**3 * (3 + 8 * u * (2 * S2**4 * u**3 + (-6 * kappa \
* (3 + u * kappa) + S2**2 * u * (-11 + 4 * u * kappa)))) + (q**2 * (58 + -16 \
* u * (6 * S2**4 * u**3 + (-2 * kappa * (8 + 3 * u * kappa) + S2**2 * u * (-5 \
+ 8 * u * kappa)))) + q * (-42 + 8 * u * (-12 * kappa + S2**2 * u * (5 + 4 * \
u * (S2**2 * u + 3 * kappa)))))))) + S1**2 * (-1 + (4 * q**3 * (1 + (-8 * \
S2**6 * u**6 + (2 * S2**4 * u**4 * (5 + 12 * u * kappa) + (-1 * S2**2 * u**2 \
* (23 + 8 * u * kappa * (4 + 3 * u * kappa)) + 2 * u * kappa * (1 + u * kappa \
* (11 + 4 * u * kappa)))))) + (q**4 * (-1 + 2 * u * (-4 * S2**4 * u**3 + \
(kappa * (7 + -4 * u * kappa) + S2**2 * u * (11 + 8 * u * kappa)))) + (2 * \
q**2 * (-3 + 2 * u * (8 * S2**6 * u**5 + (4 * S2**4 * u**3 * (5 + -8 * u * \
kappa) + (kappa * (-15 + 4 * u * kappa * (1 + -4 * u * kappa)) + 5 * S2**2 * \
u * (7 + 8 * u * kappa * (2 + u * kappa)))))) + (4 * q * (1 + u * (8 * S2**6 \
* u**5 + (4 * S2**4 * u**3 * (-11 + 4 * u * kappa) + (2 * kappa * (5 + 12 * u \
* kappa) + -1 * S2**2 * u * (23 + 8 * u * kappa * (4 + 3 * u * kappa)))))) + \
2 * u * (-1 * kappa + S2**2 * u * (11 + 8 * u * (kappa + -2 * S2**2 * u * (-2 \
+ u * (S2**2 * u + kappa))))))))))))))))))\"\>"], "Output",
 CellLabel->"Out[213]=",ExpressionUUID->"10c72996-2828-4d2a-bc6b-a7a91fe2de7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[214]:=",ExpressionUUID->"4a2582bf-7a0f-4e32-aa35-3f9661df29db"],

Cell[BoxData["\<\"coeff1 = -32 * q * ((1 + q))**2 * (4 * ((-1 + q))**2 * q**2 \
* ((1 + q))**3 * (-5 + 8 * q) * S1**8 * u**5 + (-1 * (-1 + q) * q * ((1 + \
q))**3 * S1**6 * u**3 * (-1 + (26 * q + (-13 * q**2 + (-12 * q**3 + (4 * (-1 \
+ q) * (1 + 3 * q) * (-1 + 4 * q) * S2**2 * u**2 + 4 * q * (20 + q * (-29 + \
12 * q)) * u * kappa))))) + ((-1 * (1 + q) * S2**2 * u + (kappa + q * kappa)) \
* (16 * ((-1 + q))**3 * ((1 + q))**2 * S2**6 * u**4 + (q**2 * ((1 + q))**2 * \
kappa**2 * (((-1 + q))**2 + -16 * q * u * kappa) + (-1 * (-1 + q) * ((1 + \
q))**2 * S2**2 * (((-1 + q))**3 + (2 * (-10 + q) * (-1 + q) * q * u * kappa + \
-48 * q**2 * u**2 * kappa**2)) + ((-1 + q**2))**2 * S2**4 * u**2 * (-8 + q * \
(-20 + (q + -48 * u * kappa)))))) + (-1 * (1 + q) * ((-1 * (1 + q) * S2**2 * \
u + (kappa + q * kappa)))**2 * (4 * (-4 + q) * ((-1 + q))**2 * S2**4 * u**3 + \
(q * kappa * (-1 * ((-1 + q))**2 + 4 * q * (5 + q) * u * kappa) + -1 * (-1 + \
q) * S2**2 * u * (-4 + q * (-1 + (4 * u * kappa + q * (5 + 8 * u * \
kappa)))))) + (((1 + q))**3 * S1**2 * (4 * (-4 + q) * ((-1 + q))**2 * (3 + q) \
* S2**6 * u**5 + ((1 + q) * S2**2 * u * (-5 * ((-1 + q))**4 + (-2 * ((-1 + \
q))**2 * (4 + q * (-7 + 4 * q)) * u * kappa + 12 * q * (1 + q**2) * u**2 * \
kappa**2)) + (q * kappa * (-1 * ((-1 + q))**4 + (((-1 + q))**2 * (-3 + q * \
(23 + 4 * q)) * u * kappa + -4 * q * (-20 + q * (3 + q)) * u**2 * kappa**2)) \
+ (-1 + q) * S2**4 * u**3 * (32 * (1 + u * kappa) + q * (-53 + (-56 * u * \
kappa + q * (50 + q * (-33 + (4 * q + -12 * u * kappa))))))))) + -1 * ((1 + \
q))**2 * S1**4 * u * (-4 * ((-1 + q**2))**2 * (4 + (q + 4 * q**2)) * S2**4 * \
u**4 + (q * (1 + q) * (-1 * ((-1 + q))**4 + (((-1 + q))**2 * (-3 + q * (49 + \
16 * q)) * u * kappa + 4 * q * (30 + q * (-39 + (19 + -4 * q) * q)) * u**2 * \
kappa**2)) + (-1 + q**2) * S2**2 * u**2 * (4 + q * (-3 * (11 + 4 * u * kappa) \
+ q * (50 + q * (-53 + (32 * q + 8 * (-7 + 4 * q) * u * \
kappa))))))))))))\"\>"], "Output",
 CellLabel->"Out[215]=",ExpressionUUID->"dd7336df-9e04-4832-82d6-f0c67e112cac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->
  "In[216]:=",ExpressionUUID->"d76be14e-c5a4-4c1a-84ea-aa00328c26fc"],

Cell[BoxData["\<\"coeff0 = -16 * ((1 + q))**4 * (16 * ((-1 + q))**3 * q**3 * \
((1 + q))**2 * S1**10 * u**6 + ((-1 + q) * q * ((1 + q))**2 * S1**6 * u**2 * \
((-1 + q) * (((-1 + q))**2 * q + (-4 * (-5 + q * (27 + q * (-3 + 8 * q))) * \
S2**2 * u**2 + 16 * (-1 + q) * (3 + q * (6 + q)) * S2**4 * u**4)) + (-4 * (-1 \
+ q) * q * u * (-1 + (15 * q + (4 * q**2 + 8 * (6 + (-1 + q) * q) * S2**2 * \
u**2))) * kappa + 16 * q**2 * (10 + (-8 + q) * q) * u**2 * kappa**2)) + (-1 * \
S1**4 * u * (16 * ((-1 + q))**3 * ((1 + q))**2 * (1 + 3 * q * (2 + q)) * \
S2**6 * u**5 + (-2 * ((-1 + q**2))**2 * S2**4 * u**3 * (4 + (q * (6 + q * (61 \
+ (6 * q + 4 * q**2))) + 72 * (q + q**3) * u * kappa)) + (2 * kappa * (((-1 + \
q))**4 * q**2 * ((1 + q))**2 + (-1 * (-3 + (30 * q + 4 * q**2)) * ((q + -1 * \
q**3))**2 * u * kappa + -8 * q**3 * ((1 + q))**2 * (10 + 3 * (-4 + q) * q) * \
u**2 * kappa**2)) + (-1 + q) * ((1 + q))**2 * S2**2 * u * (((-1 + q))**3 * \
(-1 + 2 * q * (12 + 5 * q)) + (4 * (-1 + q) * q * (15 + q * (-55 + 2 * q * (9 \
+ 2 * q))) * u * kappa + 144 * q**2 * (2 + (-2 + q) * q) * u**2 * \
kappa**2))))) + (((1 + q))**2 * S1**2 * (16 * ((-1 + q))**3 * (2 + 3 * q) * \
S2**8 * u**6 + (4 * ((-1 + q))**2 * S2**6 * u**4 * (-8 + (3 * q + (-27 * q**2 \
+ (5 * q**3 + 8 * (-1 + (q + -6 * q**2)) * u * kappa)))) + (q**2 * kappa**2 * \
(((-1 + q))**4 + (-4 * ((-1 + q))**2 * (-1 + 5 * q) * u * kappa + 16 * q * \
(-5 + 3 * q) * u**2 * kappa**2)) + ((-1 + q) * S2**4 * u**2 * (((-1 + q))**3 \
* (-10 + (-24 + q) * q) + (-4 * (-1 + q) * (4 + q * (18 + 5 * q * (-11 + 3 * \
q))) * u * kappa + 144 * q * (1 + 2 * (-1 + q) * q) * u**2 * kappa**2)) + \
S2**2 * (-1 * ((-1 + q))**6 + (-2 * ((-1 + q))**4 * (1 + (-12 + q) * q) * u * \
kappa + (4 * ((-1 + q))**2 * q * (15 + q * (-29 + 15 * q)) * u**2 * kappa**2 \
+ -32 * q**2 * (6 + q * (-11 + 6 * q)) * u**3 * kappa**3))))))) + (-1 * ((-1 \
* S2**2 * u + kappa))**2 * (16 * ((-1 + q))**3 * ((1 + q))**2 * S2**6 * u**4 \
+ (q**2 * ((1 + q))**2 * kappa**2 * (((-1 + q))**2 + -16 * q * u * kappa) + \
(-1 * (-1 + q) * ((1 + q))**2 * S2**2 * (((-1 + q))**3 + (2 * (-10 + q) * (-1 \
+ q) * q * u * kappa + -48 * q**2 * u**2 * kappa**2)) + ((-1 + q**2))**2 * \
S2**4 * u**2 * (-8 + q * (-20 + (q + -48 * u * kappa)))))) + -1 * ((q + -1 * \
q**3))**2 * S1**8 * u**4 * (1 + (-48 * S2**2 * u**2 + 4 * q * (-5 + (4 * u * \
(S2**2 * u + -5 * kappa) + q * (-2 + 8 * u * (S2**2 * u + \
kappa)))))))))))\"\>"], "Output",
 CellLabel->"Out[217]=",ExpressionUUID->"c4c8566d-83e6-4b35-9175-f49e9b1bc255"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"c2737fd2-18b5-4558-8143-b5f1e1df2ffe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xicoeff6", "*", " ", 
    RowBox[{"\[Xi]", "^", "6"}]}], "+", 
   RowBox[{"xicoeff5", "*", " ", 
    RowBox[{"\[Xi]", "^", "5"}]}], "+", " ", 
   RowBox[{"xicoeff4", "*", " ", 
    RowBox[{"\[Xi]", "^", "4"}]}], "+", 
   RowBox[{"xicoeff3", "*", " ", 
    RowBox[{"\[Xi]", "^", "3"}]}], " ", "+", " ", 
   RowBox[{"xicoeff2", "*", " ", 
    RowBox[{"\[Xi]", "^", "2"}]}], " ", "+", " ", 
   RowBox[{"xicoeff1", "*", " ", "\[Xi]"}], "+", " ", "xicoeff0", " ", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->
  "In[218]:=",ExpressionUUID->"0341a26f-d499-4ae4-90d0-0087e93cdbf6"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[218]=",ExpressionUUID->"96e0fbd8-4c6f-4148-a59e-fb07be4b50e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Clean this notebook for inclusion in git repository. ",
 StyleBox["Credits: http://bhptoolkit.org/cleannb.html", "Subsection"],
 " "
}], "Subsubsection",ExpressionUUID->"e56a6f41-c8fe-47cc-bedd-a416fce017cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CleanNotebook", "[", "file_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nb", ",", "contents", ",", "newcontents"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nb", "=", 
       RowBox[{"NotebookOpen", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetOptions", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"\"\<TrackCellChangeTimes\>\"", "->", "False"}], ",", 
        RowBox[{"PrivateNotebookOptions", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<FileOutlineCache\>\"", "->", "False"}], "}"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"contents", "=", 
       RowBox[{"NotebookGet", "[", "nb", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"newcontents", "=", 
       RowBox[{"contents", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellChangeTimes", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellTags", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NotebookPut", "[", 
       RowBox[{"newcontents", ",", "nb"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"NotebookSave", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NotebookClose", "[", "nb", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[219]:=",ExpressionUUID->"57b4396a-76f6-4214-ba68-ae042ddc2572"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanNotebook", "[", 
   RowBox[{"NotebookFileName", "[", "]"}], "]"}], ";"}]], "Input",
 CellLabel->"In[220]:=",ExpressionUUID->"ee26a3e4-87d9-41fd-93be-d159f37bcf65"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1654, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False,
ExpressionUUID->"ceb27b6a-17ef-40ed-91d0-092d78b52fe3"
]

