Notebook[{

Cell[CellGroupData[{
Cell["precession v2: polynomial coefficients", \
"Title",ExpressionUUID->"6383118c-d443-42eb-a95b-32b9581dcfd8"],

Cell["Davide Gerosa", \
"Subtitle",ExpressionUUID->"0b2e0e77-f582-44f2-a573-e384163a73b0"],

Cell[TextData[StyleBox["This is a notebook to derive some long polynomial \
coefficients that describe the dynamics of spinning black-hole binaries at \
2PN. In particular, we present \[LineSeparator]expressions for (i) the \
effective potentials, (ii) the evolution of the total spin on the \
precessional timescale, (iii) the identification of the spin-orbit resonances \
in terms of the generalized angular momentum \[Kappa], and (iv)  the \
identification of the spin-orbit resonances in terms of the effective spin \
\[Xi].  ", "Subsection"]], \
"Subtitle",ExpressionUUID->"0e3d0172-8950-4d99-b055-7b5438182de5"],

Cell[CellGroupData[{

Cell["\<\
Export expressions in a format that python and numpy are going to like. Use a \
modified version of the packaged by Gustavo Wiederhecker  \
https://github.com/gwiederhecker/ToPython, supplemented by a set of custom \
transformation for the precession code. \
\>", "Subsubsection",ExpressionUUID->"ff845be3-3aca-4898-b479-dd93a6ae26d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToPython", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"numpyprefix_", ":", "\"\<np\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"expression", "=", "x"}], ",", "greekrule", ",", "PythonForm", 
       ",", 
       RowBox[{"numpypre", "=", "numpyprefix"}], ",", "lp", ",", "rp", ",", 
       "a", ",", "b"}], "}"}], ",", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"By", " ", "Gustavo", " ", "Wiederhecker"}], ",", " ", 
       RowBox[{"minor", " ", "edits", " ", "by", " ", "Davide", " ", 
        RowBox[{"Gerosa", "."}]}]}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numpyprefix", "==", "\"\<\>\""}], ",", 
        RowBox[{"sep", "=", "\"\<\>\""}], ",", 
        RowBox[{"sep", "=", "\"\<.\>\""}]}], "]"}], ";", "\n", 
      RowBox[{"lp", "=", "\"\<(\>\""}], ";", "\n", 
      RowBox[{"rp", "=", "\"\<)\>\""}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Rational", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\</\>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Complex", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<complex\>\"", "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Times", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\< * \>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Plus", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "\"\< + \>\"", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"h_", "[", "args__", "]"}], "]"}], ":=", 
       RowBox[{"numpypre", "<>", "sep", "<>", 
        RowBox[{"ToLowerCase", "[", 
         RowBox[{"PythonForm", "[", "h", "]"}], "]"}], "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "args", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"Power", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
       RowBox[{"lp", "<>", 
        RowBox[{"PythonForm", "[", "a", "]"}], "<>", "rp", "<>", "\"\<**\>\"",
         "<>", "lp", "<>", 
        RowBox[{"PythonForm", "[", "b", "]"}], "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "a_ListQ", "]"}], ":=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<array\>\"", "<>", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "a", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<{\>\"", "->", " ", "\"\<[\>\""}], ",", 
            RowBox[{"\"\<}\>\"", "->", " ", "\"\<]\>\""}]}], "}"}]}], 
         "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Arg", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<angle\>\""}]}], ";", "\n", 
      
      RowBox[{
       RowBox[{"PythonForm", "[", "Csc", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<sin\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Sec", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<cos\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Cot", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<tan\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Csch", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<sinh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Sech", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<cosh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "Coth", "]"}], ":=", 
       RowBox[{
       "\"\<1/\>\"", "<>", "numpypre", "<>", "sep", "<>", "\"\<tanh\>\""}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", 
        RowBox[{"List", "[", "args__", "]"}], "]"}], ":=", 
       RowBox[{
       "numpypre", "<>", "sep", "<>", "\"\<array\>\"", "<>", "lp", "<>", 
        "\"\<[\>\"", "<>", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PythonForm", "[", 
            RowBox[{
             RowBox[{"{", "args", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "<>", "\"\<,\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"{", "args", "}"}]}]}], "}"}]}], "]"}], "<>", 
        "\"\<]\>\"", "<>", "rp"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "\[Pi]", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<pi\>\""}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "E", "]"}], "=", 
       RowBox[{"numpypre", "<>", "sep", "<>", "\"\<e\>\""}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "r_Real", "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", "=", 
           RowBox[{"MantissaExponent", "[", "r", "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"r", ">=", "0"}], ",", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "]"}], "]"}], 
            "<>", "\"\<e\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"\"\<(\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "]"}], "]"}], 
            "<>", "\"\<e\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<)\>\""}]}], 
          "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"greekrule", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<\[Alpha]\>\"", "->", "\"\<alpha\>\""}], ",", 
         RowBox[{"\"\<\[Beta]\>\"", "->", "\"\<beta\>\""}], ",", 
         RowBox[{"\"\<\[Gamma]\>\"", "->", "\"\<gamma\>\""}], ",", 
         RowBox[{"\"\<\[Delta]\>\"", "->", "\"\<delta\>\""}], ",", 
         RowBox[{"\"\<\[CurlyEpsilon]\>\"", "->", "\"\<curlyepsilon\>\""}], 
         ",", 
         RowBox[{"\"\<\[Zeta]\>\"", "->", "\"\<zeta\>\""}], ",", 
         RowBox[{"\"\<\[Eta]\>\"", "->", "\"\<eta\>\""}], ",", 
         RowBox[{"\"\<\[Theta]\>\"", "->", "\"\<theta\>\""}], ",", 
         RowBox[{"\"\<\[Iota]\>\"", "->", "\"\<iota\>\""}], ",", 
         RowBox[{"\"\<\[Kappa]\>\"", "->", "\"\<kappa\>\""}], ",", 
         RowBox[{"\"\<\[Lambda]\>\"", "->", "\"\<lambda\>\""}], ",", 
         RowBox[{"\"\<\[Mu]\>\"", "->", "\"\<mu\>\""}], ",", 
         RowBox[{"\"\<\[Nu]\>\"", "->", "\"\<nu\>\""}], ",", 
         RowBox[{"\"\<\[Xi]\>\"", "->", "\"\<xi\>\""}], ",", 
         RowBox[{"\"\<\[Omicron]\>\"", "->", "\"\<omicron\>\""}], ",", 
         RowBox[{"\"\<\[Pi]\>\"", "->", "\"\<pi\>\""}], ",", 
         RowBox[{"\"\<\[Rho]\>\"", "->", "\"\<rho\>\""}], ",", 
         RowBox[{"\"\<\[FinalSigma]\>\"", "->", "\"\<finalsigma\>\""}], ",", 
         RowBox[{"\"\<\[Sigma]\>\"", "->", "\"\<sigma\>\""}], ",", 
         RowBox[{"\"\<\[Tau]\>\"", "->", "\"\<tau\>\""}], ",", 
         RowBox[{"\"\<\[Upsilon]\>\"", "->", "\"\<upsilon\>\""}], ",", 
         RowBox[{"\"\<\[CurlyPhi]\>\"", "->", "\"\<curlyphi\>\""}], ",", 
         RowBox[{"\"\<\[Chi]\>\"", "->", "\"\<chi\>\""}], ",", 
         RowBox[{"\"\<\[Psi]\>\"", "->", "\"\<psi\>\""}], ",", 
         RowBox[{"\"\<\[Omega]\>\"", "->", "\"\<omega\>\""}], ",", 
         RowBox[{"\"\<\[CapitalAlpha]\>\"", "->", "\"\<Alpha\>\""}], ",", 
         RowBox[{"\"\<\[CapitalBeta]\>\"", "->", "\"\<Beta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalGamma]\>\"", "->", "\"\<Gamma\>\""}], ",", 
         RowBox[{"\"\<\[CapitalDelta]\>\"", "->", "\"\<Delta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalEpsilon]\>\"", "->", "\"\<CurlyEpsilon\>\""}], 
         ",", 
         RowBox[{"\"\<\[CapitalZeta]\>\"", "->", "\"\<Zeta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalEta]\>\"", "->", "\"\<Eta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalTheta]\>\"", "->", "\"\<Theta\>\""}], ",", 
         RowBox[{"\"\<\[CapitalIota]\>\"", "->", "\"\<Iota\>\""}], ",", 
         RowBox[{"\"\<\[CapitalKappa]\>\"", "->", "\"\<Kappa\>\""}], ",", 
         RowBox[{"\"\<\[CapitalLambda]\>\"", "->", "\"\<Lambda\>\""}], ",", 
         RowBox[{"\"\<\[CapitalMu]\>\"", "->", "\"\<Mu\>\""}], ",", 
         RowBox[{"\"\<\[CapitalNu]\>\"", "->", "\"\<Nu\>\""}], ",", 
         RowBox[{"\"\<\[CapitalXi]\>\"", "->", "\"\<Xi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalOmicron]\>\"", "->", "\"\<Omicron\>\""}], ",", 
         
         RowBox[{"\"\<\[CapitalPi]\>\"", "->", "\"\<Pi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalRho]\>\"", "->", "\"\<Rho\>\""}], ",", 
         RowBox[{"\"\<\[CapitalSigma]\>\"", "->", "\"\<Sigma\>\""}], ",", 
         RowBox[{"\"\<\[CapitalTau]\>\"", "->", "\"\<Tau\>\""}], ",", 
         RowBox[{"\"\<\[CapitalUpsilon]\>\"", "->", "\"\<Upsilon\>\""}], ",", 
         
         RowBox[{"\"\<\[CapitalPhi]\>\"", "->", "\"\<CurlyPhi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalChi]\>\"", "->", "\"\<Chi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalPsi]\>\"", "->", "\"\<Psi\>\""}], ",", 
         RowBox[{"\"\<\[CapitalOmega]\>\"", "->", "\"\<Omega\>\""}]}], 
        "}"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"PythonForm", "[", "allOther_", "]"}], ":=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"allOther", ",", "FortranForm"}], "]"}], ",", "greekrule"}],
         "]"}]}], ";", "\n", 
      RowBox[{"PythonForm", "[", "expression", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"5c7b5ae4-9126-427d-a0b5-6924edb5ba15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"precessionform", "[", 
    RowBox[{"label_", ",", "expression_"}], "]"}], ":=", 
   RowBox[{"\"\<# Machine generated with \>\"", "<>", 
    RowBox[{"Last", "@", 
     RowBox[{"FileNameSplit", "@", 
      RowBox[{"NotebookFileName", "[", "]"}]}]}], "<>", "\"\<\\n\>\"", "<>", 
    " ", "label", "<>", "\"\< = \>\"", "<>", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToPython", "[", "expression", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<(q)\>\"", "\[Rule]", "\"\<q\>\""}], ",", 
        RowBox[{"\"\<(L)\>\"", "\[Rule]", "\"\<L\>\""}], ",", 
        RowBox[{"\"\<(S)\>\"", "\[Rule]", "\"\<S\>\""}], ",", 
        RowBox[{"\"\<(J)\>\"", "\[Rule]", "\"\<J\>\""}], ",", 
        RowBox[{"\"\<(S1)\>\"", "\[Rule]", "\"\<S1\>\""}], ",", 
        RowBox[{"\"\<(S2)\>\"", "\[Rule]", "\"\<S2\>\""}], ",", 
        RowBox[{"\"\<(u)\>\"", "->", "\"\<u\>\""}], ",", 
        RowBox[{"\"\<(kappa)\>\"", "->", "\"\<kappa\>\""}], ",", 
        RowBox[{"\"\<(xi)\>\"", "->", "\"\<xi\>\""}], ",", 
        RowBox[{"\"\<(2)\>\"", "->", "\"\<2\>\""}], ",", 
        RowBox[{"\"\<(3)\>\"", "->", "\"\<3\>\""}], ",", 
        RowBox[{"\"\<(4)\>\"", "->", "\"\<4\>\""}], ",", 
        RowBox[{"\"\<(5)\>\"", "->", "\"\<5\>\""}], ",", 
        RowBox[{"\"\<(6)\>\"", "->", "\"\<6\>\""}], ",", 
        RowBox[{"\"\<(7)\>\"", "->", "\"\<7\>\""}], ",", 
        RowBox[{"\"\<(8)\>\"", "->", "\"\<8\>\""}], ",", 
        RowBox[{"\"\<(9)\>\"", "->", "\"\<9\>\""}], ",", 
        RowBox[{"\"\<(10)\>\"", "->", "\"\<10\>\""}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"43a78cde-85e5-4b54-abbc-bf7cdbd03a6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["(ii) Effective potentials", \
"Section",ExpressionUUID->"f78820e6-597a-4d8d-8c92-cb09c1a72eab"],

Cell[CellGroupData[{

Cell["See Eqs. (13-14) of Gerosa et al. (2015), arxiv:1506.03492. ", \
"Subsubsection",ExpressionUUID->"04cb541c-b1e2-46b6-aff2-7645e5e2c13e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", 
   FractionBox["1", 
    RowBox[{"4", "q", "  ", 
     RowBox[{"S", "^", "2"}], " ", "L"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "^", "2"}], " ", "-", " ", 
      RowBox[{"L", "^", "2"}], "-", 
      RowBox[{"S", "^", "2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "^", "2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"S1", "^", "2"}], "-", 
         RowBox[{"S2", "^", "2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"q", "^", "2"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "S"}], ")"}], "^", "2"}], "-", 
       RowBox[{"J", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "  ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "S"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "+", "S2"}], ")"}], "^", "2"}], "-", 
       RowBox[{"S", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "-", "S2"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}]}], " ", ";"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"57e858d0-d213-4967-9ada-dbabc0d22af8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xiSvarphi", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"t1", 
     RowBox[{"(", 
      RowBox[{"t2", "-", 
       RowBox[{
        RowBox[{"Cos", "[", "varphi", "]"}], "t3"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<xi\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"4b489380-6c2d-443b-af85-ce19b1bd1588"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\nxi = 1/4 * \
L**(-1) * q**(-1) * S**(-2) * ((J**2 + (-1 * L**2 + -1 * S**2)) * (((1 + \
q))**2 * S**2 + (-1 + q**2) * (S1**2 + -1 * S2**2)) + -1 * (1 + -1 * q**2) * \
((J**2 + -1 * ((L + -1 * S))**2))**(1/2) * ((-1 * J**2 + ((L + \
S))**2))**(1/2) * ((S**2 + -1 * ((S1 + -1 * S2))**2))**(1/2) * ((-1 * S**2 + \
((S1 + S2))**2))**(1/2) * np.cos(varphi))\"\>"], "Output",
 CellLabel->"Out[7]=",ExpressionUUID->"b6206b0b-3b0e-41ad-a46b-b0cc8970a206"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosvarphi", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Xi]"}], " ", "/", "t1"}], " ", "+", " ", "t2"}], 
      ")"}], "/", "t3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<cosvarphi\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"a7295460-fc36-4e4f-b406-56568d16b805"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncosvarphi = \
((1 + -1 * q**2))**(-1) * ((J**2 + -1 * ((L + -1 * S))**2))**(-1/2) * ((-1 * \
J**2 + ((L + S))**2))**(-1/2) * ((S**2 + -1 * ((S1 + -1 * S2))**2))**(-1/2) * \
((-1 * S**2 + ((S1 + S2))**2))**(-1/2) * ((J**2 + (-1 * L**2 + -1 * S**2)) * \
(((1 + q))**2 * S**2 + (-1 + q**2) * (S1**2 + -1 * S2**2)) + -4 * L * q * \
S**2 * xi)\"\>"], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"cefac524-546d-4780-b13e-614f8c8c7875"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(ii) Cubic equation in S^2 ", \
"Section",ExpressionUUID->"99fa2989-4f42-49cb-a4c1-473d2e10142c"],

Cell[CellGroupData[{

Cell["\<\
Equation (\[Xi]_\[PlusMinus](S)-\[Xi])^2=0; substitute  \[Kappa] and u; \
multiply by some constant factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"813d57bc-be9f-4ff5-8819-de50f7159eaa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"effpot", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"t3", "^", "2"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "/", "t1"}], ")"}], " ", "-", " ", "t2"}], ")"}], 
     "^", "2"}]}], " ", "]"}]}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"5406f93a-938d-4ea3-93c9-64f438e395ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["J", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "-", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["J", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "+", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["S", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "-", "S2"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "+", "S2"}], ")"}], "2"]}], ")"}]}], "-", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["J", "2"], "-", 
        SuperscriptBox["L", "2"], "-", 
        SuperscriptBox["S", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox["S", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["S1", "2"], "-", 
           SuperscriptBox["S2", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", "L", " ", "q", " ", 
      SuperscriptBox["S", "2"], " ", "\[Xi]"}]}], ")"}], "2"]}]], "Output",
 CellLabel->
  "Out[10]=",ExpressionUUID->"b31bc47c-1e6a-49cd-a481-a7dd5af0885d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"effpot", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "^", "2"}], "  ", 
         RowBox[{"effpot", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"S", "^", "2"}]}], ")"}]}]}], "//.", 
        RowBox[{"{", 
         RowBox[{"J", "\[Rule]", 
          RowBox[{"Sqrt", "[", "Js", "]"}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{"Js", "->", 
         RowBox[{
          RowBox[{"2", " ", "L", " ", "\[Kappa]"}], " ", "+", " ", 
          RowBox[{"L", "^", "2"}]}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{"L", "\[Rule]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "u"}], ")"}]}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Sqrt", "[", "Ss", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"7ac4b074-aadd-494a-a795-663b5f29bd53"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "-", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "+", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["Ss"]}], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox["Ss"], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["S1", "2"], "-", 
             SuperscriptBox["S2", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "Ss"}]}], ")"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "+", 
       RowBox[{"2", " ", "q", " ", "Ss", " ", "\[Xi]"}]}], ")"}], "2"]}], 
   RowBox[{"4", " ", "Ss"}]]}]], "Output",
 CellLabel->
  "Out[11]=",ExpressionUUID->"f70f2b75-7557-4c62-9cff-847670f148f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract coefficients.", \
"Subsubsection",ExpressionUUID->"4b15e786-6647-4d2b-be29-6fe842686c59"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"e27be02c-cb58-4e9a-9f52-e5b1d7573532"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = q * \
((1 + q))**2 * u**2\"\>"], "Output",
 CellLabel->
  "Out[13]=",ExpressionUUID->"5d20aea5-8ca5-414f-bc57-148b261360f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"2fb87423-9e2c-4b8f-a904-bf0ba5dacfbb"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = 1/4 \
* ((1 + q))**2 * (1 + (4 * S2**2 * u**2 + (q**2 * (1 + 4 * S1**2 * u**2) + -2 \
* q * (1 + 2 * u * ((S1**2 + S2**2) * u + (2 * kappa + -1 * xi))))))\"\>"], \
"Output",
 CellLabel->
  "Out[15]=",ExpressionUUID->"3d972502-40c2-4196-a68c-d39190050ecc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"dcbfe62d-6ad9-408d-a53d-cfd8f724b451"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = (q \
* (kappa + (q * kappa + -1 * xi)) * (kappa + (q * kappa + -1 * q * xi)) + \
(-1/2 * (-1 + q**2) * S1**2 * ((1 + q) * (-1 + (q + 4 * q * u * kappa)) + -2 \
* q * u * xi) + -1/2 * (-1 + q**2) * S2**2 * ((1 + q) * (-1 + (q + -4 * u * \
kappa)) + 2 * q * u * xi)))\"\>"], "Output",
 CellLabel->
  "Out[17]=",ExpressionUUID->"bc488b55-e35e-4e47-bed6-17d2056fbe8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"7e762373-b504-4df2-b529-46cebd26f2a3"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = 1/4 \
* (-1 + q) * (1 + q) * ((1 + q) * ((-1 + q) * ((S1**2 + -1 * S2**2))**2 + 4 * \
(q * S1**2 + -1 * S2**2) * kappa**2) + -4 * q * (S1 + -1 * S2) * (S1 + S2) * \
kappa * xi)\"\>"], "Output",
 CellLabel->
  "Out[19]=",ExpressionUUID->"0e04852e-cb5d-43e4-a9b5-c99d94a9c50a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"8c6e55c8-3f43-41d8-a2ce-1a3781741053"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Scoeff3", "*", " ", 
    RowBox[{"Ss", "^", "3"}]}], "+", 
   RowBox[{"Scoeff2", "*", 
    RowBox[{"Ss", "^", "2"}]}], "+", 
   RowBox[{"Scoeff1", "*", "Ss"}], " ", "+", " ", "Scoeff0", " ", "-", " ", 
   "effpot"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"708510a4-4e36-48ed-a7e5-c8b6390791c4"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[20]=",ExpressionUUID->"bdd88a1d-3fd5-4554-ba3e-6e69d045a4b2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(iii) Spin-orbit resonances in \[Kappa] ", \
"Section",ExpressionUUID->"5d122305-161c-433b-90cd-b72270faa66f"],

Cell[CellGroupData[{

Cell["\<\
Compute discriminant of the cubic equation in S^2; multiply by some constant \
factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"4e52729f-b449-4a33-82b3-deb1ac963888"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"discr", " ", "=", " ", 
   RowBox[{
    RowBox[{"Discriminant", "[", 
     RowBox[{"effpot", ",", "Ss"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"discr", "=", " ", 
  RowBox[{"discr", 
   FractionBox["256", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["q", "2"]}], ")"}], "2"]]}]}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"54d58a33-0f4b-459a-a5aa-145726cdcedf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "16"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["q", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "6"], " ", 
     SuperscriptBox["S1", "10"], " ", 
     SuperscriptBox["u", "6"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["q", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
     SuperscriptBox["S1", "8"], " ", 
     SuperscriptBox["u", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"48", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["q", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"9", "+", 
          RowBox[{"40", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"40", " ", "u", " ", "\[Kappa]"}], "-", 
          RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "47"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Xi]", "2"]}], "-", 
          RowBox[{"8", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", "\[Kappa]"}], "+", 
             RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "9"}], "+", 
          RowBox[{"20", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]", "+", 
             RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["S1", "6"], " ", 
     SuperscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "7"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"16", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "-", 
          RowBox[{"32", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"144", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"17", "+", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "+", 
          RowBox[{"40", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"13", "-", 
             RowBox[{"40", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"51", "+", 
             RowBox[{"88", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"272", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"34", " ", "\[Kappa]"}], "-", 
             RowBox[{"19", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", 
           SuperscriptBox["\[Xi]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"44", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"11", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
             RowBox[{"14", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "5"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"112", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
           SuperscriptBox["\[Xi]", "2"]}], "+", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "116"}], " ", "\[Kappa]"}], "+", 
             RowBox[{"74", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "176"}], " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"40", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
             RowBox[{"88", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "21"}], "-", 
             RowBox[{"32", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "4"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"44", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"28", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"80", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "6"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"28", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"20", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"6", " ", "\[Xi]"}], "-", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"23", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"13", "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"\[Kappa]", "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", 
           SuperscriptBox["S2", "2"], " ", "u"}], ")"}]}], "+", "\[Kappa]", 
        "+", 
        RowBox[{"q", " ", "\[Kappa]"}], "-", 
        RowBox[{"q", " ", "\[Xi]"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["q", "4"], "+", 
          RowBox[{"8", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "8"}], "+", 
          SuperscriptBox["q", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"24", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"12", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "47"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"24", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"5", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"24", " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"5", " ", "\[Xi]"}], "+", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{"8", "-", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"18", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"5", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"19", " ", "\[Kappa]"}], "-", 
                RowBox[{"9", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "72"}], " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"\[Xi]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "q"}], ")"}], " ", 
     SuperscriptBox["S1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "5"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"3", " ", "q"}]}], ")"}], " ", 
        SuperscriptBox["S2", "8"], " ", 
        SuperscriptBox["u", "6"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           SuperscriptBox["q", "4"]}], "-", 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "22"}], "-", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "24"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"20", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q", "8"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{
           SuperscriptBox["q", "10"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "9"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "36"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"15", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "86"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"20", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"12", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", "+", 
          RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"16", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{"3", " ", "q"}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"5", " ", 
              SuperscriptBox["q", "5"]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"5", "-", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "5"}], "-", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"13", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"52", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"18", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "q", "-", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"10", " ", "q", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"10", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["S1", "4"], " ", "u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"6", " ", "q"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "5"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "6"]}], "+", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"134", "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{"10", "-", 
             RowBox[{"12", " ", "q"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["q", "2"]}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["q", "6"]}], "-", 
             RowBox[{"30", " ", "q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"15", "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"10", "+", 
                RowBox[{"36", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"11", "+", 
                RowBox[{"60", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "60"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"3", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"16", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"22", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"35", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"98", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "7"]}], "+", 
             RowBox[{"u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"23", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"25", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"47", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"120", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->
  "Out[22]=",ExpressionUUID->"9ab96036-2089-4f04-ae7e-cb5a9043b7b1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"46bedb19-5013-4603-9087-af18215161f9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"6635d524-314b-4594-bb4e-07a3893bb4e2"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff5 = \
-256 * q**3 * ((1 + q))**6 * u\"\>"], "Output",
 CellLabel->
  "Out[24]=",ExpressionUUID->"fc3609a0-03dc-4403-ba98-4201075a4f28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"6c8a0fd5-5bd9-4fbd-a0f6-303ca9a0b940"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff4 = 16 \
* q**2 * ((1 + q))**4 * (((-1 + q**2))**2 + (-16 * ((1 + q))**2 * (q * (-5 + \
3 * q) * S1**2 + (3 + -5 * q) * S2**2) * u**2 + (40 * q * ((1 + q))**2 * u * \
xi + 16 * q**2 * u**2 * xi**2)))\"\>"], "Output",
 CellLabel->
  "Out[26]=",ExpressionUUID->"dbe59583-edd0-4969-a141-9da96dd9f29f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"fb6278e0-4aa6-4add-9edc-7558be694823"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = -32 \
* q * ((1 + q))**4 * (2 * q**6 * S1**2 * u * (-5 + 12 * S1**2 * u**2) + (2 * \
S2**2 * u * (-5 + 12 * S2**2 * u**2) + (2 * q**2 * u * (40 * S1**4 * u**2 + \
(-44 * S2**4 * u**2 + (8 * xi**2 + (S1**2 * (-5 + (-8 * S2**2 * u**2 + 40 * u \
* xi)) + -2 * S2**2 * (-5 + 4 * u * xi * (1 + u * xi)))))) + (2 * q**3 * (32 \
* S1**4 * u**3 + (32 * S2**4 * u**3 + (xi * (-1 + 8 * u * xi * (3 + u * xi)) \
+ (2 * S2**2 * u * (-1 + u * xi * (17 + 8 * u * xi)) + 2 * S1**2 * u * (-1 + \
(40 * S2**2 * u**2 + u * xi * (17 + 8 * u * xi))))))) + (q * (xi + 2 * u * \
(S1**2 * (1 + -48 * S2**2 * u**2) + S2**2 * (1 + -2 * u * (12 * S2**2 * u + \
xi)))) + (q**5 * (xi + 2 * u * (S2**2 + S1**2 * (1 + -2 * u * (12 * (S1**2 + \
2 * S2**2) * u + xi)))) + -2 * q**4 * u * (5 * S2**2 + (44 * S1**4 * u**2 + \
(-8 * (5 * S2**4 * u**2 + (5 * S2**2 * u * xi + xi**2)) + 2 * S1**2 * (-5 + 4 \
* u * (xi + u * (S2**2 + xi**2))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[28]=",ExpressionUUID->"6eaa72b8-a744-4d65-9188-8e94c737bdbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"a33fd552-0d70-4f29-9d23-4d5ead8e51f9"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = -16 \
* ((1 + q))**2 * (16 * (-1 + q) * q**3 * ((1 + q))**4 * (10 + (-8 + q) * q) * \
S1**6 * u**4 + (-16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (-1 * \
((-1 + q**2))**2 * S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * \
(-4 + q) * q * (1 + q) * u * xi + 16 * q**2 * u**2 * xi**2)) + (-1 * q**2 * \
(((1 + q) * S2**2 * u + q * xi))**2 * ((-1 + q) * ((1 + q))**2 * (-1 + (q + \
48 * S2**2 * u**2)) + (8 * q * (1 + q) * (5 + q) * u * xi + 16 * q**2 * u**2 \
* xi**2)) + (2 * q**2 * ((1 + q))**2 * S1**4 * u**2 * ((-1 + q) * ((1 + \
q))**2 * ((-1 + q) * (-3 + (30 * q + 4 * q**2)) + -72 * (2 + (-2 + q) * q) * \
S2**2 * u**2) + (4 * q * (1 + q) * (-30 + q * (39 + q * (-19 + 4 * q))) * u * \
xi + -8 * q**2 * (6 + (-6 + q) * q) * u**2 * xi**2)) + (-4 * q * (-1 * (1 + \
q) * S2**2 * u + -1 * q * xi) * (-1 * ((-1 + q))**2 * ((1 + q))**3 * S2**2 * \
u * (-10 + (q + 24 * S2**2 * u**2)) + (-1 * (-1 + q) * q * ((1 + q))**2 * (-1 \
+ (q + 4 * (1 + 2 * q) * S2**2 * u**2)) * xi + (-8 * q**2 * (1 + q) * u * (2 \
+ (q + 2 * (-1 + q) * S2**2 * u**2)) * xi**2 + -16 * q**3 * u**2 * xi**3))) + \
(q * (1 + q) * S1**2 * ((-1 + q) * ((1 + q))**3 * (((-1 + q))**3 * q + (4 * \
(-1 + q) * (15 + q * (-29 + 15 * q)) * S2**2 * u**2 + 144 * (1 + 2 * (-1 + q) \
* q) * S2**4 * u**4)) + (2 * q * ((1 + q))**2 * u * (((-1 + q))**2 * (-3 + q \
* (23 + 4 * q)) + 12 * (1 + q) * (1 + q**2) * S2**2 * u**2) * xi + (8 * q**2 \
* (1 + q) * u**2 * (-12 + (-2 * q + (-11 * q**2 + (q**3 + 4 * (3 + q * (-5 + \
3 * q)) * S2**2 * u**2)))) * xi**2 + -32 * q**3 * (3 + (-1 + q) * q) * u**3 * \
xi**3))) + (S2**2 * (((-1 + q**2))**4 + (2 * ((-1 + q))**2 * q * ((1 + q))**3 \
* (4 + 5 * q) * u * xi + (8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * \
u**2 * xi**2 + 32 * q**3 * (-1 + q**2) * u**3 * xi**3))) + -1 * q**2 * xi**2 \
* (1 + q * (8 * u * xi + q * (-2 + (16 * u * xi + ((q + 4 * u * \
xi))**2))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[30]=",ExpressionUUID->"628cc365-7dd4-4ab1-a9b9-3148eed73ef2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"bccaacb5-cef1-4bf4-8bdf-9aff873c6e9b"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = -16 \
* (1 + q) * (-16 * ((-1 + q))**2 * q**3 * ((1 + q))**5 * (-5 + 2 * q) * S1**8 \
* u**5 + (-4 * (-1 + q) * q**2 * ((1 + q))**3 * S1**6 * u**3 * ((-1 + q) * \
((1 + q))**2 * (-1 + (15 * q + (4 * q**2 + 8 * (6 + (-1 + q) * q) * S2**2 * \
u**2))) + (2 * q * (1 + q) * (20 + q * (-29 + 12 * q)) * u * xi + -8 * (-2 + \
q) * q**2 * u**2 * xi**2)) + (-2 * q * (((1 + q) * S2**2 * u + q * xi))**2 * \
(-1 * ((-1 + q))**2 * ((1 + q))**3 * S2**2 * u * (-10 + (q + 24 * S2**2 * \
u**2)) + (-1 * (-1 + q) * q * ((1 + q))**2 * (-1 + (q + 4 * (1 + 2 * q) * \
S2**2 * u**2)) * xi + (-8 * q**2 * (1 + q) * u * (2 + (q + 2 * (-1 + q) * \
S2**2 * u**2)) * xi**2 + -16 * q**3 * u**2 * xi**3))) + (-2 * q * ((1 + \
q))**2 * S1**4 * u * (((-1 + q))**2 * ((1 + q))**3 * (((-1 + q))**2 * q + (2 \
* (15 + q * (-55 + 2 * q * (9 + 2 * q))) * S2**2 * u**2 + -72 * (1 + q**2) * \
S2**4 * u**4)) + ((-1 + q) * q * ((1 + q))**2 * u * (3 + (-52 * q + (33 * \
q**2 + (16 * q**3 + 4 * (-3 + 2 * q**2 * (-7 + 4 * q)) * S2**2 * u**2)))) * \
xi + (-8 * q**2 * (1 + q) * u**2 * (6 + (-16 * q + (18 * q**2 + (-5 * q**3 + \
2 * (-1 + q) * (3 + (-1 + q) * q) * S2**2 * u**2)))) * xi**2 + -16 * q**3 * \
(3 + q * (-5 + 3 * q)) * u**3 * xi**3))) + (S1**2 * (-32 * ((-1 + q))**2 * \
((1 + q))**5 * (1 + q * (-1 + 6 * q)) * S2**6 * u**5 + (-4 * (-1 + q) * ((1 + \
q))**3 * S2**4 * u**3 * ((-1 + q) * ((1 + q))**2 * (4 + q * (18 + 5 * q * \
(-11 + 3 * q))) + (2 * q * (1 + q) * (-8 + (14 * q + 3 * q**3)) * u * xi + 8 \
* q**2 * (1 + q * (-1 + 3 * q)) * u**2 * xi**2)) + (2 * ((1 + q))**3 * S2**2 \
* u * (-1 * ((-1 + q))**4 * ((1 + q))**2 * (1 + (-12 + q) * q) + (-2 * q * \
((-1 + q**2))**2 * (4 + q * (-7 + 4 * q)) * u * xi + (-8 * q**2 * (1 + q * \
(-8 + q * (20 + (-8 + q) * q))) * u**2 * xi**2 + 16 * (-2 + q) * q**3 * (-1 + \
2 * q) * u**3 * xi**3))) + 2 * q**2 * xi * (-1 * ((-1 + q**2))**4 + (-1 * \
((-1 + q))**2 * ((1 + q))**3 * (-1 + q * (18 + 7 * q)) * u * xi + (4 * q * \
((1 + q))**2 * (2 + q * (-5 + 19 * q)) * u**2 * xi**2 + 16 * q**2 * (1 + q**2 \
* (2 + 3 * q)) * u**3 * xi**3)))))) + -2 * (-1 * (1 + q) * S2**2 * u + -1 * q \
* xi) * (16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 + (((-1 + q**2))**2 \
* S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + (8 * (-4 + q) * q * \
(1 + q) * u * xi + 16 * q**2 * u**2 * xi**2)) + (S2**2 * (-1 * ((-1 + \
q**2))**4 + (-2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) * u * xi + \
(-8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * xi**2 + -32 * \
q**3 * (-1 + q**2) * u**3 * xi**3))) + q**2 * xi**2 * (1 + q * (8 * u * xi + \
q * (-2 + (16 * u * xi + ((q + 4 * u * xi))**2))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[32]=",ExpressionUUID->"c2ad67be-a486-4d59-89c4-2eb91bb74fb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"afa39167-df9e-4f8b-97a1-b3973d7c88cf"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = -16 \
* (16 * ((-1 + q))**3 * q**3 * ((1 + q))**6 * S1**10 * u**6 + (-1 * ((-1 + \
q))**2 * q**2 * ((1 + q))**4 * S1**8 * u**4 * (((1 + q))**2 * (1 + (-20 * q + \
(-8 * q**2 + 16 * (-3 + (q + 2 * q**2)) * S2**2 * u**2))) + (-8 * q * (1 + q) \
* (-5 + 8 * q) * u * xi + 16 * q**2 * u**2 * xi**2)) + ((-1 + q) * q * ((1 + \
q))**3 * S1**6 * u**2 * (q * ((-1 + q**2))**3 + (-4 * (-1 + q) * ((1 + q))**3 \
* (-5 + q * (27 + q * (-3 + 8 * q))) * S2**2 * u**2 + (16 * ((-1 + q))**2 * \
((1 + q))**3 * (3 + q * (6 + q)) * S2**4 * u**4 + (-2 * (-1 + q) * q * ((1 + \
q))**2 * u * (1 + (-25 * q + (-12 * q**2 + 4 * (-1 + (q + 12 * q**2)) * S2**2 \
* u**2))) * xi + (8 * q**2 * (1 + q) * u**2 * (4 + (-18 * q + (11 * q**2 + 4 \
* (-1 + q**2) * S2**2 * u**2))) * xi**2 + 32 * (1 + -2 * q) * q**3 * u**3 * \
xi**3))))) + (((1 + q))**2 * S1**4 * u * (-16 * ((-1 + q))**3 * ((1 + q))**4 \
* (1 + 3 * q * (2 + q)) * S2**6 * u**5 + (2 * S2**4 * u**3 * (((-1 + q))**2 * \
((1 + q))**4 * (4 + q * (6 + q * (61 + (6 * q + 4 * q**2)))) + (4 * ((-1 + \
q))**2 * q * ((1 + q))**4 * (4 + (q + 4 * q**2)) * u * xi + -8 * q**2 * ((-1 \
+ q**2))**2 * (1 + q * (4 + q)) * u**2 * xi**2)) + (xi * (2 * ((-1 + q))**4 * \
q**2 * ((1 + q))**3 + (((q + -1 * q**3))**2 * (-1 + q * (40 + 23 * q)) * u * \
xi + (8 * q**3 * (1 + q) * (-1 + q * (14 + 5 * (-4 + q) * q)) * u**2 * xi**2 \
+ -16 * q**4 * (1 + 6 * (-1 + q) * q) * u**3 * xi**3))) + (-1 + q) * (1 + q) \
* S2**2 * u * (-1 * ((-1 + q**2))**3 * (-1 + 2 * q * (12 + 5 * q)) + (-2 * \
(-1 + q) * q * ((1 + q))**2 * (-4 + q * (29 + q * (-21 + 32 * q))) * u * xi + \
(-8 * q**2 * (1 + q) * (1 + 2 * (-2 + q) * q * (1 + 4 * q)) * u**2 * xi**2 + \
32 * q**3 * (1 + q * (-1 + 3 * q)) * u**3 * xi**3)))))) + ((1 + q) * S1**2 * \
(16 * ((-1 + q))**3 * ((1 + q))**5 * (2 + 3 * q) * S2**8 * u**6 + (q**2 * \
xi**2 * (((-1 + q))**4 * ((1 + q))**3 + (2 * q * (5 + 3 * q) * ((-1 + \
q**2))**2 * u * xi + (-8 * q**2 * (1 + q) * (-4 + q * (7 + q)) * u**2 * xi**2 \
+ 32 * (1 + -2 * q) * q**3 * u**3 * xi**3))) + ((-1 + q) * ((1 + q))**2 * \
S2**4 * u**2 * ((-10 + (-24 + q) * q) * ((-1 + q**2))**3 + (2 * (-1 + q) * q \
* ((1 + q))**2 * (-32 + q * (21 + q * (-29 + 4 * q))) * u * xi + (8 * q**2 * \
(1 + q) * (8 + q * (-14 + (-4 + q) * q)) * u**2 * xi**2 + -32 * q**3 * (3 + \
(-1 + q) * q) * u**3 * xi**3))) + (S2**2 * (-1 * ((-1 + q))**6 * ((1 + q))**5 \
+ (-10 * ((-1 + q))**4 * q * ((1 + q))**5 * u * xi + (-2 * ((-1 + q))**2 * \
q**2 * ((1 + q))**3 * (11 + q * (-24 + 11 * q)) * u**2 * xi**2 + (16 * q**3 * \
((1 + q))**3 * (2 + q * (-3 + 2 * q)) * u**3 * xi**3 + 32 * q**4 * (1 + q) * \
(3 + q * (-5 + 3 * q)) * u**4 * xi**4)))) + 4 * ((-1 + q))**2 * ((1 + q))**4 \
* S2**6 * u**4 * (-8 + q * (-5 + (-24 * q + (-22 * q**2 + (5 * q**3 + (2 * \
(-4 + q) * (3 + q) * u * xi + 8 * q * u**2 * xi**2)))))))))) + -1 * (((1 + q) \
* S2**2 * u + q * xi))**2 * (16 * ((-1 + q))**3 * ((1 + q))**4 * S2**6 * u**4 \
+ (((-1 + q**2))**2 * S2**4 * u**2 * (((1 + q))**2 * (-8 + (-20 + q) * q) + \
(8 * (-4 + q) * q * (1 + q) * u * xi + 16 * q**2 * u**2 * xi**2)) + (S2**2 * \
(-1 * ((-1 + q**2))**4 + (-2 * ((-1 + q))**2 * q * ((1 + q))**3 * (4 + 5 * q) \
* u * xi + (-8 * (-1 + q) * q**2 * ((1 + q))**2 * (-1 + 4 * q) * u**2 * xi**2 \
+ -32 * q**3 * (-1 + q**2) * u**3 * xi**3))) + q**2 * xi**2 * (1 + q * (8 * u \
* xi + q * (-2 + (16 * u * xi + ((q + 4 * u * xi))**2))))))))))))\"\>"], \
"Output",
 CellLabel->
  "Out[34]=",ExpressionUUID->"b7975855-d6d5-4f82-8e26-b38b8813e534"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"cb67963a-71fe-4a0b-b1b0-1850cbc21af7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kappacoeff5", "*", " ", 
    RowBox[{"\[Kappa]", "^", "5"}]}], "+", 
   RowBox[{"kappacoeff4", "*", " ", 
    RowBox[{"\[Kappa]", "^", "4"}]}], "+", 
   RowBox[{"kappacoeff3", "*", " ", 
    RowBox[{"\[Kappa]", "^", "3"}]}], "+", 
   RowBox[{"kappacoeff2", "*", " ", 
    RowBox[{"\[Kappa]", "^", "2"}]}], "+", 
   RowBox[{"kappacoeff1", "*", " ", "\[Kappa]"}], "+", "kappacoeff0", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"19797581-62e6-4ecf-8096-38de6f668f90"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[35]=",ExpressionUUID->"7a8a01f2-d42c-4953-ac3f-92a2e3c4f27d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(iv) Spin-orbit resonances in xi ", \
"Section",ExpressionUUID->"39461754-dd01-487a-8968-ecb677c37e64"],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"bee680af-bff5-498d-9132-317e1c83ca6c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff6", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "6"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff6\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"b212d19e-ab9f-4918-835b-60082bd20834"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff6 = 256 \
* q**6 * u**2\"\>"], "Output",
 CellLabel->
  "Out[37]=",ExpressionUUID->"ecb80434-8c91-426b-abb2-c8074ebd01ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff5\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"626114f4-6253-445b-b3a8-08ec7a2e27ed"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff5 = 128 \
* q**5 * (1 + q) * u * (1 + (q + (8 * q * S1**2 * u**2 + (-4 * u * (S1**2 * u \
+ (-2 * S2**2 * u + kappa)) + -4 * q * u * (S2**2 * u + kappa)))))\"\>"], \
"Output",
 CellLabel->
  "Out[39]=",ExpressionUUID->"e1a6768a-4e4a-4cf1-8cd5-ad86525b9d86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff4\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"90854944-bdfb-4708-aca7-27e3c2bc02cc"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff4 = 16 \
* q**4 * ((1 + q))**2 * (1 + (-32 * S1**2 * u**2 + (8 * u * (12 * S2**4 * \
u**3 + (-2 * kappa + (2 * u * ((-1 * S1**2 * u + kappa))**2 + S2**2 * u * (1 \
+ -12 * u * (S1**2 * u + kappa))))) + (q * (-2 + (-96 * S1**4 * u**4 + (8 * \
S1**2 * u**2 * (7 + 4 * u * (5 * S2**2 * u + kappa)) + 8 * u * (-12 * S2**4 * \
u**3 + (2 * kappa * (-3 + 4 * u * kappa) + S2**2 * u * (7 + 4 * u * \
kappa)))))) + q**2 * (1 + 8 * u * (-2 * kappa + u * (-4 * S2**2 + (12 * S1**4 \
* u**2 + (2 * ((-1 * S2**2 * u + kappa))**2 + S1**2 * (1 + -12 * u * (S2**2 * \
u + kappa)))))))))))\"\>"], "Output",
 CellLabel->
  "Out[41]=",ExpressionUUID->"36fdf49a-4fff-4913-8823-93271f6f1ab9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff3\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"fc4a5960-2871-46b5-a9c9-1d02bb7cfece"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff3 = 32 \
* q**3 * ((1 + q))**3 * (16 * (-1 + q) * q * (-1 + 2 * q) * S1**6 * u**5 + \
(16 * (-2 + q) * (-1 + q) * S2**6 * u**5 + (4 * S2**4 * u**3 * (-5 + (20 * q \
+ (-14 * q**2 + (q**3 + -4 * (3 + q * (-5 + 3 * q)) * u * kappa)))) + ((1 + \
q) * kappa * (-1 * ((-1 + q))**2 + (4 * (1 + q * (8 + q)) * u * kappa + -16 * \
q * u**2 * kappa**2)) + (S2**2 * u * (-1 * ((-1 + q))**2 * (3 + 5 * q) + (-4 \
* q * (19 + q * (-5 + 2 * q)) * u * kappa + 16 * (1 + q * (-1 + 3 * q)) * \
u**2 * kappa**2)) + (-4 * S1**4 * u**3 * (-1 + (-4 * S2**2 * u**2 + q * (14 + \
(5 * (-4 + q) * q + (8 * S2**2 * u**2 + (4 * q * (-4 + 3 * q) * S2**2 * u**2 \
+ 4 * (3 + q * (-5 + 3 * q)) * u * kappa)))))) + S1**2 * u * (-5 + (-8 * u * \
(6 * S2**4 * u**3 + (kappa + 2 * S2**2 * u * (1 + 2 * u * kappa))) + (q * (7 \
+ (64 * S2**4 * u**4 + (8 * S2**2 * u**2 * (1 + 6 * u * kappa) + 4 * u * \
kappa * (5 + 12 * u * kappa)))) + (q**3 * (-3 + 16 * u**2 * (S2**4 * u**2 + \
(kappa**2 + -1 * S2**2 * (1 + 2 * u * kappa)))) + q**2 * (1 + -4 * u * (8 * \
S2**4 * u**3 + (kappa * (19 + 4 * u * kappa) + -2 * S2**2 * u * (1 + 6 * u * \
kappa))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[43]=",ExpressionUUID->"a11579a0-b337-49fc-8f87-e05482fb7b5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff2\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"211990ed-b978-45a9-924d-8772f1806016"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff2 = 16 \
* q**2 * ((1 + q))**4 * (16 * ((-1 + q))**2 * q**2 * S1**8 * u**6 + (16 * \
((-1 + q))**2 * S2**8 * u**6 + (kappa**2 * (((-1 + q))**2 * (1 + q * (4 + q)) \
+ (-32 * q * (1 + q * (3 + q)) * u * kappa + 16 * q**2 * u**2 * kappa**2)) + \
(S2**4 * u**2 * (((-1 + q))**2 * (-23 + (-40 + q) * q) + (16 * (5 + -2 * q * \
(9 + q * (-8 + 3 * q))) * u * kappa + 16 * (1 + 6 * (-1 + q) * q) * u**2 * \
kappa**2)) + (S2**2 * (-1 * ((-1 + q))**4 + (-2 * ((-1 + q))**2 * (-7 + (-18 \
+ q) * q) * u * kappa + (8 * (-1 + q * (11 + 2 * q * (1 + 6 * q))) * u**2 * \
kappa**2 + 32 * (1 + -2 * q) * q * u**3 * kappa**3))) + (8 * (-1 + q) * S2**6 \
* u**4 * (11 + (4 * u * kappa + 2 * q * (-9 + (2 * q + -4 * u * kappa)))) + \
(-8 * (-1 + q) * q * S1**6 * u**4 * (4 + (-4 * S2**2 * u**2 + q * (-18 + (-8 \
* u * kappa + q * (11 + 4 * u * (S2**2 * u + kappa)))))) + (S1**4 * u**2 * \
(((1 + -4 * S2**2 * u**2))**2 + (q**4 * (-23 + 16 * u * (S2**4 * u**3 + (-2 * \
S2**2 * u * (-2 + u * kappa) + kappa * (5 + u * kappa)))) + (2 * q**3 * (3 + \
8 * u * (2 * S2**4 * u**3 + (-6 * kappa * (3 + u * kappa) + S2**2 * u * (-11 \
+ 4 * u * kappa)))) + (q**2 * (58 + -16 * u * (6 * S2**4 * u**3 + (-2 * kappa \
* (8 + 3 * u * kappa) + S2**2 * u * (-5 + 8 * u * kappa)))) + q * (-42 + 8 * \
u * (-12 * kappa + S2**2 * u * (5 + 4 * u * (S2**2 * u + 3 * kappa)))))))) + \
S1**2 * (-1 + (4 * q**3 * (1 + (-8 * S2**6 * u**6 + (2 * S2**4 * u**4 * (5 + \
12 * u * kappa) + (-1 * S2**2 * u**2 * (23 + 8 * u * kappa * (4 + 3 * u * \
kappa)) + 2 * u * kappa * (1 + u * kappa * (11 + 4 * u * kappa)))))) + (q**4 \
* (-1 + 2 * u * (-4 * S2**4 * u**3 + (kappa * (7 + -4 * u * kappa) + S2**2 * \
u * (11 + 8 * u * kappa)))) + (2 * q**2 * (-3 + 2 * u * (8 * S2**6 * u**5 + \
(4 * S2**4 * u**3 * (5 + -8 * u * kappa) + (kappa * (-15 + 4 * u * kappa * (1 \
+ -4 * u * kappa)) + 5 * S2**2 * u * (7 + 8 * u * kappa * (2 + u * \
kappa)))))) + (4 * q * (1 + u * (8 * S2**6 * u**5 + (4 * S2**4 * u**3 * (-11 \
+ 4 * u * kappa) + (2 * kappa * (5 + 12 * u * kappa) + -1 * S2**2 * u * (23 + \
8 * u * kappa * (4 + 3 * u * kappa)))))) + 2 * u * (-1 * kappa + S2**2 * u * \
(11 + 8 * u * (kappa + -2 * S2**2 * u * (-2 + u * (S2**2 * u + \
kappa))))))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[45]=",ExpressionUUID->"5706f372-ddb9-40e6-bfe4-06fc4d1ed1fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff1\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"2eba811f-ffbb-4bbb-be79-5d1537fe699f"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff1 = -32 \
* q * ((1 + q))**2 * (4 * ((-1 + q))**2 * q**2 * ((1 + q))**3 * (-5 + 8 * q) \
* S1**8 * u**5 + (-1 * (-1 + q) * q * ((1 + q))**3 * S1**6 * u**3 * (-1 + (26 \
* q + (-13 * q**2 + (-12 * q**3 + (4 * (-1 + q) * (1 + 3 * q) * (-1 + 4 * q) \
* S2**2 * u**2 + 4 * q * (20 + q * (-29 + 12 * q)) * u * kappa))))) + ((-1 * \
(1 + q) * S2**2 * u + (kappa + q * kappa)) * (16 * ((-1 + q))**3 * ((1 + \
q))**2 * S2**6 * u**4 + (q**2 * ((1 + q))**2 * kappa**2 * (((-1 + q))**2 + \
-16 * q * u * kappa) + (-1 * (-1 + q) * ((1 + q))**2 * S2**2 * (((-1 + q))**3 \
+ (2 * (-10 + q) * (-1 + q) * q * u * kappa + -48 * q**2 * u**2 * kappa**2)) \
+ ((-1 + q**2))**2 * S2**4 * u**2 * (-8 + q * (-20 + (q + -48 * u * \
kappa)))))) + (-1 * (1 + q) * ((-1 * (1 + q) * S2**2 * u + (kappa + q * \
kappa)))**2 * (4 * (-4 + q) * ((-1 + q))**2 * S2**4 * u**3 + (q * kappa * (-1 \
* ((-1 + q))**2 + 4 * q * (5 + q) * u * kappa) + -1 * (-1 + q) * S2**2 * u * \
(-4 + q * (-1 + (4 * u * kappa + q * (5 + 8 * u * kappa)))))) + (((1 + q))**3 \
* S1**2 * (4 * (-4 + q) * ((-1 + q))**2 * (3 + q) * S2**6 * u**5 + ((1 + q) * \
S2**2 * u * (-5 * ((-1 + q))**4 + (-2 * ((-1 + q))**2 * (4 + q * (-7 + 4 * \
q)) * u * kappa + 12 * q * (1 + q**2) * u**2 * kappa**2)) + (q * kappa * (-1 \
* ((-1 + q))**4 + (((-1 + q))**2 * (-3 + q * (23 + 4 * q)) * u * kappa + -4 * \
q * (-20 + q * (3 + q)) * u**2 * kappa**2)) + (-1 + q) * S2**4 * u**3 * (32 * \
(1 + u * kappa) + q * (-53 + (-56 * u * kappa + q * (50 + q * (-33 + (4 * q + \
-12 * u * kappa))))))))) + -1 * ((1 + q))**2 * S1**4 * u * (-4 * ((-1 + \
q**2))**2 * (4 + (q + 4 * q**2)) * S2**4 * u**4 + (q * (1 + q) * (-1 * ((-1 + \
q))**4 + (((-1 + q))**2 * (-3 + q * (49 + 16 * q)) * u * kappa + 4 * q * (30 \
+ q * (-39 + (19 + -4 * q) * q)) * u**2 * kappa**2)) + (-1 + q**2) * S2**2 * \
u**2 * (4 + q * (-3 * (11 + 4 * u * kappa) + q * (50 + q * (-53 + (32 * q + 8 \
* (-7 + 4 * q) * u * kappa))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[47]=",ExpressionUUID->"ab42ab19-6430-4588-8942-7ae8c99a3351"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"precessionform", "[", 
  RowBox[{"\"\<coeff0\>\"", ",", "%"}], "]"}]}], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"613b4c03-56c5-4678-b304-453c97a3e00e"],

Cell[BoxData["\<\"# Machine generated with polycoefficients.nb\\ncoeff0 = -16 \
* ((1 + q))**4 * (16 * ((-1 + q))**3 * q**3 * ((1 + q))**2 * S1**10 * u**6 + \
((-1 + q) * q * ((1 + q))**2 * S1**6 * u**2 * ((-1 + q) * (((-1 + q))**2 * q \
+ (-4 * (-5 + q * (27 + q * (-3 + 8 * q))) * S2**2 * u**2 + 16 * (-1 + q) * \
(3 + q * (6 + q)) * S2**4 * u**4)) + (-4 * (-1 + q) * q * u * (-1 + (15 * q + \
(4 * q**2 + 8 * (6 + (-1 + q) * q) * S2**2 * u**2))) * kappa + 16 * q**2 * \
(10 + (-8 + q) * q) * u**2 * kappa**2)) + (-1 * S1**4 * u * (16 * ((-1 + \
q))**3 * ((1 + q))**2 * (1 + 3 * q * (2 + q)) * S2**6 * u**5 + (-2 * ((-1 + \
q**2))**2 * S2**4 * u**3 * (4 + (q * (6 + q * (61 + (6 * q + 4 * q**2))) + 72 \
* (q + q**3) * u * kappa)) + (2 * kappa * (((-1 + q))**4 * q**2 * ((1 + \
q))**2 + (-1 * (-3 + (30 * q + 4 * q**2)) * ((q + -1 * q**3))**2 * u * kappa \
+ -8 * q**3 * ((1 + q))**2 * (10 + 3 * (-4 + q) * q) * u**2 * kappa**2)) + \
(-1 + q) * ((1 + q))**2 * S2**2 * u * (((-1 + q))**3 * (-1 + 2 * q * (12 + 5 \
* q)) + (4 * (-1 + q) * q * (15 + q * (-55 + 2 * q * (9 + 2 * q))) * u * \
kappa + 144 * q**2 * (2 + (-2 + q) * q) * u**2 * kappa**2))))) + (((1 + \
q))**2 * S1**2 * (16 * ((-1 + q))**3 * (2 + 3 * q) * S2**8 * u**6 + (4 * ((-1 \
+ q))**2 * S2**6 * u**4 * (-8 + (3 * q + (-27 * q**2 + (5 * q**3 + 8 * (-1 + \
(q + -6 * q**2)) * u * kappa)))) + (q**2 * kappa**2 * (((-1 + q))**4 + (-4 * \
((-1 + q))**2 * (-1 + 5 * q) * u * kappa + 16 * q * (-5 + 3 * q) * u**2 * \
kappa**2)) + ((-1 + q) * S2**4 * u**2 * (((-1 + q))**3 * (-10 + (-24 + q) * \
q) + (-4 * (-1 + q) * (4 + q * (18 + 5 * q * (-11 + 3 * q))) * u * kappa + \
144 * q * (1 + 2 * (-1 + q) * q) * u**2 * kappa**2)) + S2**2 * (-1 * ((-1 + \
q))**6 + (-2 * ((-1 + q))**4 * (1 + (-12 + q) * q) * u * kappa + (4 * ((-1 + \
q))**2 * q * (15 + q * (-29 + 15 * q)) * u**2 * kappa**2 + -32 * q**2 * (6 + \
q * (-11 + 6 * q)) * u**3 * kappa**3))))))) + (-1 * ((-1 * S2**2 * u + \
kappa))**2 * (16 * ((-1 + q))**3 * ((1 + q))**2 * S2**6 * u**4 + (q**2 * ((1 \
+ q))**2 * kappa**2 * (((-1 + q))**2 + -16 * q * u * kappa) + (-1 * (-1 + q) \
* ((1 + q))**2 * S2**2 * (((-1 + q))**3 + (2 * (-10 + q) * (-1 + q) * q * u * \
kappa + -48 * q**2 * u**2 * kappa**2)) + ((-1 + q**2))**2 * S2**4 * u**2 * \
(-8 + q * (-20 + (q + -48 * u * kappa)))))) + -1 * ((q + -1 * q**3))**2 * \
S1**8 * u**4 * (1 + (-48 * S2**2 * u**2 + 4 * q * (-5 + (4 * u * (S2**2 * u + \
-5 * kappa) + q * (-2 + 8 * u * (S2**2 * u + kappa)))))))))))\"\>"], "Output",
 
 CellLabel->
  "Out[49]=",ExpressionUUID->"d5a5d129-c5fb-4d31-bce4-1930ee8210a7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"43b458a4-6227-4f26-9f34-7e0a6ff2b391"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xicoeff6", "*", " ", 
    RowBox[{"\[Xi]", "^", "6"}]}], "+", 
   RowBox[{"xicoeff5", "*", " ", 
    RowBox[{"\[Xi]", "^", "5"}]}], "+", " ", 
   RowBox[{"xicoeff4", "*", " ", 
    RowBox[{"\[Xi]", "^", "4"}]}], "+", 
   RowBox[{"xicoeff3", "*", " ", 
    RowBox[{"\[Xi]", "^", "3"}]}], " ", "+", " ", 
   RowBox[{"xicoeff2", "*", " ", 
    RowBox[{"\[Xi]", "^", "2"}]}], " ", "+", " ", 
   RowBox[{"xicoeff1", "*", " ", "\[Xi]"}], "+", " ", "xicoeff0", " ", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"308d850a-540d-4d01-b531-98d4b76d1690"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[50]=",ExpressionUUID->"dadfab83-b52e-4d31-80b0-65608ae88521"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Clean this notebook for inclusion in git repository. ",
 StyleBox["Credits: http://bhptoolkit.org/cleannb.html", "Subsection"],
 " "
}], "Subsubsection",ExpressionUUID->"87fa3bab-509b-4280-a74c-ceee1761758a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CleanNotebook", "[", "file_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nb", ",", "contents", ",", "newcontents"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nb", "=", 
       RowBox[{"NotebookOpen", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetOptions", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"\"\<TrackCellChangeTimes\>\"", "->", "False"}], ",", 
        RowBox[{"PrivateNotebookOptions", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<FileOutlineCache\>\"", "->", "False"}], "}"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"contents", "=", 
       RowBox[{"NotebookGet", "[", "nb", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"newcontents", "=", 
       RowBox[{"contents", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellChangeTimes", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellTags", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NotebookPut", "[", 
       RowBox[{"newcontents", ",", "nb"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"NotebookSave", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NotebookClose", "[", "nb", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"46d5952a-a77e-4b57-94cf-66cdaa09eb61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanNotebook", "[", 
   RowBox[{"NotebookFileName", "[", "]"}], "]"}], ";"}]], "Input",
 CellLabel->
  "In[52]:=",ExpressionUUID->"f4f22b3d-6c75-4983-81a0-f24ee7b3fda9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1654, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False,
ExpressionUUID->"ceb27b6a-17ef-40ed-91d0-092d78b52fe3"
]

