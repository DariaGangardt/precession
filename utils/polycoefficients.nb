Notebook[{

Cell[CellGroupData[{
Cell["precession v2: polynomial coefficients", \
"Title",ExpressionUUID->"e4f8d743-cbfe-45e5-a488-14a682edb0d5"],

Cell["Davide Gerosa", \
"Subtitle",ExpressionUUID->"0fd40c02-673e-48c1-bb0c-f19e4d053a17"],

Cell[TextData[StyleBox["This is a notebook to derive some long polynomial \
coefficients that describe the dynamics of spinning black-hole binaries at \
2PN. In particular, we present \[LineSeparator]expressions for (i) the \
evolution of the total spin on the precessional timescale, (ii) the \
identification of the spin-orbit resonances in terms of the generalized \
angular momentum \[Kappa], and (iii)  the identification of the spin-orbit \
resonances in terms of the effective spin \[Xi].  ", "Subsection"]], \
"Subtitle",ExpressionUUID->"1191214f-2bb9-4d9d-bc38-bc393c972eb7"],

Cell[CellGroupData[{

Cell["\<\
Package to export expressions in a format that python and numpy are going to \
like. This packaged was written by Gustavo Wiederhecker, to which I made \
minor edits; I \[LineSeparator]use my fork until the related pull request is \
accepted. \
\>", "Subsubsection",ExpressionUUID->"a50a51a7-937a-431b-ae9b-0de9dd504748"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"URLDownload", "[", 
    RowBox[{
    "\"\<https://raw.githubusercontent.com/gwiederhecker/ToPython/master/\
ToPython.wl\>\"", ",", "\"\<ToPython.wl\>\""}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<ToPython`\>\"", "]"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"0c6ee760-9348-430b-9eeb-3dbb53006aac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["(i) Cubic equation in S^2 ", \
"Section",ExpressionUUID->"e35d2da3-fcea-49c2-be07-ee08ac02127b"],

Cell[CellGroupData[{

Cell["\<\
Effective potentials; see Eqs. (13-14) of Gerosa et al. (2015), \
arxiv:1506.03492. \
\>", "Subsubsection",ExpressionUUID->"fb9d4f61-db0b-4352-b4c4-d1053049935c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", 
   FractionBox["1", 
    RowBox[{"4", "q", "  ", 
     RowBox[{"S", "^", "2"}], " ", "L"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "^", "2"}], " ", "-", " ", 
      RowBox[{"L", "^", "2"}], "-", 
      RowBox[{"S", "^", "2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "^", "2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"S1", "^", "2"}], "-", 
         RowBox[{"S2", "^", "2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"q", "^", "2"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", "S"}], ")"}], "^", "2"}], "-", 
       RowBox[{"J", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "  ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "-", "S"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "+", "S2"}], ")"}], "^", "2"}], "-", 
       RowBox[{"S", "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", "^", "2"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S1", "-", "S2"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}]}], " ", ";"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"7a965427-72a9-4de0-b539-6694372d0003"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xiSvarphi", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"t1", 
     RowBox[{"(", 
      RowBox[{"t2", "-", 
       RowBox[{
        RowBox[{"Cos", "[", "varphi", "]"}], "t3"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToPython", "[", 
  RowBox[{"xiSvarphi", ",", 
   RowBox[{"numpypre", "=", "\"\<np\>\""}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"6176dedf-ce4b-4561-b41c-ccc464439f7b"],

Cell[BoxData["\<\"1/4 * (L)**(-1) * (q)**(-1) * (S)**(-2) * (((J)**(2) + (-1 \
* (L)**(2) + -1 * (S)**(2))) * (((1 + q))**(2) * (S)**(2) + (-1 + (q)**(2)) * \
((S1)**(2) + -1 * (S2)**(2))) + -1 * (1 + -1 * (q)**(2)) * (((J)**(2) + -1 * \
((L + -1 * S))**(2)))**(1/2) * ((-1 * (J)**(2) + ((L + S))**(2)))**(1/2) * \
(((S)**(2) + -1 * ((S1 + -1 * S2))**(2)))**(1/2) * ((-1 * (S)**(2) + ((S1 + \
S2))**(2)))**(1/2) * np.cos(varphi))\"\>"], "Output",
 CellLabel->"Out[7]=",ExpressionUUID->"47844b80-cdba-4f02-af4f-8d6832862118"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Equation (\[Xi]_\[PlusMinus](S)-\[Xi])^2=0; substitute  \[Kappa] and u; \
multiply by some constant factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"09358465-5d05-4749-b205-6bf71dfc922c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"effpot", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"t3", "^", "2"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "/", "t1"}], ")"}], " ", "-", " ", "t2"}], ")"}], 
     "^", "2"}]}], " ", "]"}]}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"9c78f295-7162-489d-9043-53447d758065"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["J", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "-", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["J", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"L", "+", "S"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["S", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "-", "S2"}], ")"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"S1", "+", "S2"}], ")"}], "2"]}], ")"}]}], "-", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["J", "2"], "-", 
        SuperscriptBox["L", "2"], "-", 
        SuperscriptBox["S", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
         SuperscriptBox["S", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["S1", "2"], "-", 
           SuperscriptBox["S2", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", "L", " ", "q", " ", 
      SuperscriptBox["S", "2"], " ", "\[Xi]"}]}], ")"}], "2"]}]], "Output",
 CellLabel->"Out[8]=",ExpressionUUID->"8dc43b07-b9b7-420a-b88b-58e7c3d2a908"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"effpot", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"u", "^", "2"}], "  ", 
         RowBox[{"effpot", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"S", "^", "2"}]}], ")"}]}]}], "//.", 
        RowBox[{"{", 
         RowBox[{"J", "\[Rule]", 
          RowBox[{"Sqrt", "[", "Js", "]"}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{"Js", "->", 
         RowBox[{
          RowBox[{"2", " ", "L", " ", "\[Kappa]"}], " ", "+", " ", 
          RowBox[{"L", "^", "2"}]}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{"L", "\[Rule]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "u"}], ")"}]}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Sqrt", "[", "Ss", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"8c44f5ac-a3df-4408-bc38-e10407392a56"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "-", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["S1", "2"], "+", 
       RowBox[{"2", " ", "S1", " ", "S2"}], "+", 
       SuperscriptBox["S2", "2"], "-", "Ss"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["Ss"]}], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox["Ss"], "+", 
       RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["S1", "2"], "-", 
             SuperscriptBox["S2", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "Ss"}]}], ")"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ss", " ", "u"}], "-", "\[Kappa]"}], ")"}]}], "+", 
       RowBox[{"2", " ", "q", " ", "Ss", " ", "\[Xi]"}]}], ")"}], "2"]}], 
   RowBox[{"4", " ", "Ss"}]]}]], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"81820529-d4b0-46af-856b-1d1a5737b033"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract coefficients.", \
"Subsubsection",ExpressionUUID->"ef1c1297-192e-4dca-8f8e-9fbb845e24a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff3 = \>\"", "<>", " ", 
  RowBox[{"ToPython", "[", 
   RowBox[{"%", ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"3e8d2858-b3f0-4840-9228-90b73c7d755f"],

Cell[BoxData["\<\"coeff3 = q * ((1 + q))**(2) * (u)**(2)\"\>"], "Output",
 CellLabel->"Out[11]=",ExpressionUUID->"f31ca5eb-5e71-4901-90b9-1485e4ec1298"]

}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff2 = \>\"", "<>", " ", 
  RowBox[{"ToPython", "[", 
   RowBox[{"%", ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"b3cbde4d-c04c-40f5-b8ed-7cb8895ad621"],

Cell[BoxData["\<\"coeff2 = 1/4 * ((1 + q))**(2) * (1 + (4 * (S2)**(2) * \
(u)**(2) + ((q)**(2) * (1 + 4 * (S1)**(2) * (u)**(2)) + -2 * q * (1 + 2 * u * \
(((S1)**(2) + (S2)**(2)) * u + (2 * kappa + -1 * xi))))))\"\>"], "Output",
 CellLabel->
  "Out[13]=",ExpressionUUID->"ebe3e3da-86dd-49df-bc35-fe0027639fbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff1 = \>\"", "<>", " ", 
  RowBox[{"ToPython", "[", 
   RowBox[{"%", ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"02e26185-e584-4d1b-99e0-a222343e01e7"],

Cell[BoxData["\<\"coeff1 = (q * (kappa + (q * kappa + -1 * xi)) * (kappa + (q \
* kappa + -1 * q * xi)) + (-1/2 * (-1 + (q)**(2)) * (S1)**(2) * ((1 + q) * \
(-1 + (q + 4 * q * u * kappa)) + -2 * q * u * xi) + -1/2 * (-1 + (q)**(2)) * \
(S2)**(2) * ((1 + q) * (-1 + (q + -4 * u * kappa)) + 2 * q * u * xi)))\"\>"], \
"Output",
 CellLabel->
  "Out[15]=",ExpressionUUID->"77f799a7-3879-4ae0-a4c2-7719b682bd3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Scoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"effpot", ",", "Ss", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff0 = \>\"", "<>", " ", 
  RowBox[{"ToPython", "[", 
   RowBox[{"%", ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"11b4e0d7-9342-4e64-9583-b0ce0b530b09"],

Cell[BoxData["\<\"coeff0 = 1/4 * (-1 + q) * (1 + q) * ((1 + q) * ((-1 + q) * \
(((S1)**(2) + -1 * (S2)**(2)))**(2) + 4 * (q * (S1)**(2) + -1 * (S2)**(2)) * \
(kappa)**(2)) + -4 * q * (S1 + -1 * S2) * (S1 + S2) * kappa * xi)\"\>"], \
"Output",
 CellLabel->
  "Out[17]=",ExpressionUUID->"a8ccdf49-4965-4b5d-9447-0a704f1f0e45"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"2cd8fde6-2f0d-4958-9c29-8c6ed145acbd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Scoeff3", "*", " ", 
    RowBox[{"Ss", "^", "3"}]}], "+", 
   RowBox[{"Scoeff2", "*", 
    RowBox[{"Ss", "^", "2"}]}], "+", 
   RowBox[{"Scoeff1", "*", "Ss"}], " ", "+", " ", "Scoeff0", " ", "-", " ", 
   "effpot"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"bb4ae861-e170-4623-b405-c174a619b29c"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[18]=",ExpressionUUID->"5699c723-ef49-4c9e-957e-f13e58dbd18d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(ii) Spin-orbit resonances in \[Kappa] ", \
"Section",ExpressionUUID->"06fa4150-875f-441c-a104-c7f6c57946da"],

Cell[CellGroupData[{

Cell["\<\
Compute discriminant of the cubic equation in S^2; multiply by some constant \
factors for consistency with previous derivations.\
\>", "Subsubsection",ExpressionUUID->"44e451ff-0690-48ac-9c1c-b82f7a86463f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"discr", " ", "=", " ", 
   RowBox[{
    RowBox[{"Discriminant", "[", 
     RowBox[{"effpot", ",", "Ss"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"discr", "=", " ", 
  RowBox[{"discr", 
   FractionBox["256", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["q", "2"]}], ")"}], "2"]]}]}]}], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"c9ef0d6b-e468-40cc-9b60-dda3a45f7d2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "16"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["q", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "6"], " ", 
     SuperscriptBox["S1", "10"], " ", 
     SuperscriptBox["u", "6"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["q", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
     SuperscriptBox["S1", "8"], " ", 
     SuperscriptBox["u", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"48", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["q", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"9", "+", 
          RowBox[{"40", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"40", " ", "u", " ", "\[Kappa]"}], "-", 
          RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "47"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Xi]", "2"]}], "-", 
          RowBox[{"8", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", "\[Kappa]"}], "+", 
             RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "9"}], "+", 
          RowBox[{"20", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]", "+", 
             RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "3"], " ", 
     SuperscriptBox["S1", "6"], " ", 
     SuperscriptBox["u", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["S2", "2"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "7"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"16", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "-", 
          RowBox[{"32", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"144", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "-", 
          RowBox[{"4", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"17", "+", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "+", 
          RowBox[{"40", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"13", "-", 
             RowBox[{"40", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"51", "+", 
             RowBox[{"88", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"272", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"4", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"34", " ", "\[Kappa]"}], "-", 
             RowBox[{"19", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", 
           SuperscriptBox["\[Xi]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"44", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"11", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
             RowBox[{"14", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
          RowBox[{"16", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "5"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"112", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "4"]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
           SuperscriptBox["\[Xi]", "2"]}], "+", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "116"}], " ", "\[Kappa]"}], "+", 
             RowBox[{"74", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "176"}], " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"40", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
             RowBox[{"88", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["S2", "2"], " ", 
           SuperscriptBox["u", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "21"}], "-", 
             RowBox[{"32", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "4"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"44", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"28", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"80", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "-", 
             RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"7", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q", "6"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"28", " ", 
           SuperscriptBox["S2", "4"], " ", 
           SuperscriptBox["u", "3"]}], "-", 
          RowBox[{"20", " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"]}], "+", 
          RowBox[{"6", " ", "\[Xi]"}], "-", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"23", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["S2", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"13", "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"\[Kappa]", "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", 
           SuperscriptBox["S2", "2"], " ", "u"}], ")"}]}], "+", "\[Kappa]", 
        "+", 
        RowBox[{"q", " ", "\[Kappa]"}], "-", 
        RowBox[{"q", " ", "\[Xi]"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["q", "4"], "+", 
          RowBox[{"8", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "8"}], "+", 
          SuperscriptBox["q", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"24", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"12", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "47"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"24", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "q", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"5", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"24", " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "-", 
             RowBox[{"5", " ", "\[Xi]"}], "+", 
             RowBox[{"\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{"8", "-", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"18", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"5", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"19", " ", "\[Kappa]"}], "-", 
                RowBox[{"9", " ", "\[Xi]"}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "3"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "72"}], " ", "u", " ", 
              SuperscriptBox["\[Kappa]", "2"]}], "+", 
             RowBox[{"2", " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"\[Xi]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "q"}], ")"}], " ", 
     SuperscriptBox["S1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "5"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"3", " ", "q"}]}], ")"}], " ", 
        SuperscriptBox["S2", "8"], " ", 
        SuperscriptBox["u", "6"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           SuperscriptBox["q", "4"]}], "-", 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", "\[Kappa]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "22"}], "-", 
             RowBox[{"48", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "-", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"24", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "24"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "-", 
             RowBox[{"2", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"20", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q", "8"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
          RowBox[{
           SuperscriptBox["q", "10"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "9"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"12", " ", "\[Kappa]"}], "-", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"15", " ", "\[Kappa]"}], "-", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             RowBox[{"6", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"4", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"22", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "36"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"15", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "86"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"20", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"12", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "4"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", 
                RowBox[{"2", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "12"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "29"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"7", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "13"}], " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                SuperscriptBox["\[Xi]", "3"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "4"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Kappa]", "2"], "-", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"2", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"11", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["\[Kappa]", "3"]}], "+", 
                RowBox[{"21", " ", 
                 SuperscriptBox["\[Kappa]", "2"], " ", "\[Xi]"}], "-", 
                RowBox[{"10", " ", "\[Kappa]", " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", "+", 
          RowBox[{"q", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"16", " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{"3", " ", "q"}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"5", " ", 
              SuperscriptBox["q", "5"]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"5", "-", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "5"}], "-", 
                RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"13", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"52", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"26", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"18", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"88", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "q", "-", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"10", " ", "q", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"6", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"10", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"20", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"24", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"32", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"12", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"64", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], "2"], " ", 
     SuperscriptBox["S1", "4"], " ", "u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"16", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"6", " ", "q"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}], " ", 
        SuperscriptBox["S2", "6"], " ", 
        SuperscriptBox["u", "5"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox["S2", "4"], " ", 
        SuperscriptBox["u", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "6"]}], "+", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"7", "+", 
             RowBox[{"36", " ", "u", " ", "\[Kappa]"}], "+", 
             RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"77", "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"36", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"134", "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "2"], " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"8", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", "\[Kappa]"}], "+", 
                RowBox[{"5", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], " ", 
        SuperscriptBox["S2", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q", "8"], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"8", " ", "u", " ", "\[Kappa]"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"15", " ", "u", " ", "\[Kappa]"}], "-", 
             RowBox[{"2", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "7"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["u", "2"], " ", "\[Kappa]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", "\[Kappa]"}], "+", 
                RowBox[{"4", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"13", " ", "\[Kappa]"}], "+", 
                RowBox[{"8", " ", "\[Xi]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"33", "+", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[Kappa]"}], "+", "\[Xi]"}], 
               ")"}]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "40"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"28", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"17", " ", "\[Kappa]", " ", "\[Xi]"}], "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "13"}], "+", 
             RowBox[{"50", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Kappa]"}], "-", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"8", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"36", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "-", 
                RowBox[{"3", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "\[Kappa]"}], "+", "\[Xi]"}], ")"}]}], "+", 
             
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "46"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"3", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "72"}], " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"6", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["q", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"18", "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["u", "3"], " ", 
              SuperscriptBox["\[Xi]", "3"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"103", " ", "\[Kappa]"}], "+", 
                RowBox[{"12", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"10", " ", "\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q", "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "31"}], "-", 
             RowBox[{"32", " ", 
              SuperscriptBox["u", "3"], " ", "\[Kappa]", " ", 
              SuperscriptBox["\[Xi]", "2"]}], "+", 
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "76"}], " ", "\[Kappa]"}], "+", 
                RowBox[{"22", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["u", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"9", " ", 
                 SuperscriptBox["\[Kappa]", "2"]}], "+", 
                RowBox[{"\[Kappa]", " ", "\[Xi]"}], "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "q", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{"10", "-", 
             RowBox[{"12", " ", "q"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["q", "2"]}]}], ")"}], " ", 
           SuperscriptBox["u", "2"], " ", 
           SuperscriptBox["\[Kappa]", "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}], "2"], " ", "u", " ", 
           SuperscriptBox["\[Kappa]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["q", "6"]}], "-", 
             RowBox[{"30", " ", "q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"15", "+", 
                RowBox[{"8", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"10", "+", 
                RowBox[{"36", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"11", "+", 
                RowBox[{"60", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "60"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}], " ", "\[Kappa]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["q", "7"], "-", 
             RowBox[{"3", " ", "u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"16", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"49", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"22", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"35", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{"3", "-", 
                RowBox[{"98", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"80", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"\[Xi]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "7"]}], "+", 
             RowBox[{"u", " ", "\[Xi]"}], "+", 
             RowBox[{
              SuperscriptBox["q", "6"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"23", " ", "u", " ", "\[Xi]"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "5"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"40", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"40", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"8", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"80", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "-", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"25", " ", "u", " ", "\[Xi]"}], "-", 
                RowBox[{"104", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"16", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "6"}], "+", 
                RowBox[{"47", " ", "u", " ", "\[Xi]"}], "+", 
                RowBox[{"120", " ", 
                 SuperscriptBox["u", "2"], " ", 
                 SuperscriptBox["\[Xi]", "2"]}], "+", 
                RowBox[{"96", " ", 
                 SuperscriptBox["u", "3"], " ", 
                 SuperscriptBox["\[Xi]", "3"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellLabel->
  "Out[20]=",ExpressionUUID->"6689345d-0ccd-4bc9-9d18-a329d290d399"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"569a0489-0ac2-468e-a30a-16c51fb645f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff5 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"9c5a3a19-65b8-4452-8aab-6f0fbf47ca04"],

Cell[BoxData["\<\"coeff5 = -256 * (q)**(3) * ((1 + q))**(6) * u\"\>"], \
"Output",
 CellLabel->
  "Out[22]=",ExpressionUUID->"f5cc7bb1-a6ff-4167-a991-ea7deb5589e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff4 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"f9828df5-28ed-4f5c-a489-5a00afbce8d4"],

Cell[BoxData["\<\"coeff4 = (16 * (q)**(2) * ((1 + q))**(4) * ((-1 + \
(q)**(2)))**(2) + (640 * (q)**(3) * ((1 + q))**(6) * u * xi + 256 * (q)**(2) \
* ((1 + q))**(4) * (u)**(2) * (-1 * ((1 + q))**(2) * (q * (-5 + 3 * q) * \
(S1)**(2) + (3 + -5 * q) * (S2)**(2)) + (q)**(2) * (xi)**(2))))\"\>"], \
"Output",
 CellLabel->
  "Out[24]=",ExpressionUUID->"1ee2487f-401b-485d-b411-e2e6ded9d3ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff3 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"e2c333a6-1468-46d4-8934-ae037eccd4f0"],

Cell[BoxData["\<\"coeff3 = (-32 * (q)**(2) * ((1 + q))**(4) * ((-1 + \
(q)**(2)))**(2) * xi + (64 * q * ((1 + q))**(4) * u * (5 * (q)**(6) * \
(S1)**(2) + (5 * (S2)**(2) + (-1 * q * ((S1)**(2) + (S2)**(2)) + (-1 * \
(q)**(5) * ((S1)**(2) + (S2)**(2)) + (2 * (q)**(3) * ((S1)**(2) + ((S2)**(2) \
+ -12 * (xi)**(2))) + ((q)**(2) * (5 * (S1)**(2) + (-10 * (S2)**(2) + -8 * \
(xi)**(2))) + (q)**(4) * (-10 * (S1)**(2) + (5 * (S2)**(2) + -8 * \
(xi)**(2))))))))) + (u)**(2) * (128 * (q)**(2) * ((1 + q))**(4) * xi * \
((q)**(4) * (S1)**(2) + ((S2)**(2) + (4 * (q)**(3) * ((S1)**(2) + -5 * \
(S2)**(2)) + (4 * q * (-5 * (S1)**(2) + (S2)**(2)) + -1 * (q)**(2) * (17 * \
(S1)**(2) + (17 * (S2)**(2) + 4 * (xi)**(2))))))) + 256 * q * ((1 + q))**(4) \
* u * (-3 * (q)**(6) * (S1)**(4) + (-3 * (S2)**(4) + (6 * (q)**(5) * \
((S1)**(4) + 2 * (S1)**(2) * (S2)**(2)) + (6 * q * (2 * (S1)**(2) * (S2)**(2) \
+ (S2)**(4)) + ((q)**(2) * (-10 * (S1)**(4) + (2 * (S1)**(2) * (S2)**(2) + \
(11 * (S2)**(4) + 2 * (S2)**(2) * (xi)**(2)))) + ((q)**(4) * (11 * (S1)**(4) \
+ (-10 * (S2)**(4) + 2 * (S1)**(2) * ((S2)**(2) + (xi)**(2)))) + -4 * \
(q)**(3) * (2 * (S1)**(4) + ((S2)**(2) * (2 * (S2)**(2) + (xi)**(2)) + \
(S1)**(2) * (5 * (S2)**(2) + (xi)**(2)))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[26]=",ExpressionUUID->"5a73995e-f63c-4626-bc16-70c602aa9453"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff2 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"2178c0b7-54e3-467f-928f-c94b7083c9c3"],

Cell[BoxData["\<\"coeff2 = (256 * ((1 + q))**(2) * (u)**(4) * (-1 * (-1 + q) \
* (q)**(3) * ((1 + q))**(4) * (10 + (-8 + q) * q) * (S1)**(6) + (9 * (-1 + q) \
* (q)**(2) * ((1 + q))**(4) * (2 + (-2 + q) * q) * (S1)**(4) * (S2)**(2) + \
(-9 * (-1 + q) * q * ((1 + q))**(4) * (1 + 2 * (-1 + q) * q) * (S1)**(2) * \
(S2)**(4) + (((-1 + q))**(3) * ((1 + q))**(4) * (S2)**(6) + (6 * ((-1 + \
q))**(2) * q * ((1 + q))**(4) * (S2)**(6) + (3 * (-1 + q) * (q)**(2) * ((1 + \
q))**(4) * (S2)**(6) + ((q)**(4) * ((1 + q))**(2) * (6 + (-6 + q) * q) * \
(S1)**(4) * (xi)**(2) + (-2 * (q)**(3) * ((1 + q))**(2) * (3 + q * (-5 + 3 * \
q)) * (S1)**(2) * (S2)**(2) * (xi)**(2) + (4 * (-1 + q) * (q)**(3) * ((1 + \
q))**(2) * (S2)**(4) * (xi)**(2) + ((q)**(4) * ((1 + q))**(2) * (S2)**(4) * \
(xi)**(2) + (q)**(2) * ((-1 + (q)**(2)))**(2) * (S2)**(4) * \
(xi)**(2))))))))))) + (-16 * ((1 + q))**(2) * ((-1 + (q)**(2)))**(2) * \
((q)**(6) * (S1)**(2) + ((S2)**(2) + (-4 * (q)**(3) * (xi)**(2) + ((q)**(2) * \
((S1)**(2) + (-2 * (S2)**(2) + -1 * (xi)**(2))) + (q)**(4) * (-2 * (S1)**(2) \
+ ((S2)**(2) + -1 * (xi)**(2))))))) + (-32 * q * ((1 + q))**(4) * u * xi * (4 \
* (q)**(6) * (S1)**(2) + (4 * (S2)**(2) + ((q)**(5) * (19 * (S1)**(2) + -3 * \
(S2)**(2)) + (q * (-3 * (S1)**(2) + 19 * (S2)**(2)) + ((q)**(2) * (26 * \
(S1)**(2) + (-30 * (S2)**(2) + -4 * (xi)**(2))) + ((q)**(4) * (-30 * \
(S1)**(2) + (26 * (S2)**(2) + -4 * (xi)**(2))) + -16 * (q)**(3) * ((S1)**(2) \
+ ((S2)**(2) + 2 * (xi)**(2))))))))) + (u)**(2) * (128 * q * ((1 + q))**(2) * \
u * xi * (-1 * (q)**(2) * ((1 + q))**(3) * (-30 + q * (39 + q * (-19 + 4 * \
q))) * (S1)**(4) + (-3 * q * ((1 + q))**(4) * (1 + (q)**(2)) * (S1)**(2) * \
(S2)**(2) + (12 * ((-1 + q))**(2) * q * ((1 + q))**(3) * (S2)**(4) + (12 * \
(-1 + q) * (q)**(2) * ((1 + q))**(3) * (S2)**(4) + ((q)**(2) * ((1 + q))**(3) \
* (5 + q) * (S2)**(4) + (2 * (-1 + q) * q * ((1 + q))**(3) * (1 + 2 * q) * \
(S2)**(4) + ((-4 + q) * (1 + q) * ((-1 + (q)**(2)))**(2) * (S2)**(4) + (4 * \
(q)**(3) * (1 + q) * (3 + (-1 + q) * q) * (S1)**(2) * (xi)**(2) + (8 * \
(q)**(3) * (1 + q) * (S2)**(2) * (xi)**(2) + (8 * (-1 + q) * (q)**(3) * (1 + \
q) * (S2)**(2) * (xi)**(2) + (4 * (q)**(4) * (1 + q) * (S2)**(2) * (xi)**(2) \
+ -4 * (q)**(2) * (-1 + (q)**(2)) * (S2)**(2) * (xi)**(2)))))))))))) + 32 * \
((1 + q))**(2) * (-4 * (q)**(10) * (S1)**(4) + (-4 * (S2)**(4) + (-2 * \
(q)**(9) * (19 * (S1)**(4) + 15 * (S1)**(2) * (S2)**(2)) + (-2 * q * (15 * \
(S1)**(2) * (S2)**(2) + 19 * (S2)**(4)) + ((q)**(2) * (3 * (S1)**(4) + (-2 * \
(S1)**(2) * (S2)**(2) + (-53 * (S2)**(4) + -4 * (S2)**(2) * (xi)**(2)))) + \
(-1 * (q)**(8) * (53 * (S1)**(4) + (-3 * (S2)**(4) + 2 * (S1)**(2) * \
((S2)**(2) + 2 * (xi)**(2)))) + (4 * (q)**(7) * (13 * (S1)**(4) + (-6 * \
(S2)**(2) * ((S2)**(2) + -2 * (xi)**(2)) + (S1)**(2) * (29 * (S2)**(2) + 9 * \
(xi)**(2)))) + (4 * (q)**(3) * (-6 * (S1)**(4) + (13 * (S2)**(4) + (9 * \
(S2)**(2) * (xi)**(2) + (S1)**(2) * (29 * (S2)**(2) + 12 * (xi)**(2))))) + \
((q)**(6) * (121 * (S1)**(4) + (-67 * (S2)**(4) + (104 * (S2)**(2) * \
(xi)**(2) + (8 * (xi)**(4) + 2 * (S1)**(2) * ((S2)**(2) + 46 * (xi)**(2)))))) \
+ ((q)**(4) * (-67 * (S1)**(4) + (121 * (S2)**(4) + (92 * (S2)**(2) * \
(xi)**(2) + (8 * (xi)**(4) + 2 * (S1)**(2) * ((S2)**(2) + 52 * (xi)**(2)))))) \
+ 2 * (q)**(5) * (5 * (S1)**(4) + (5 * (S2)**(4) + (54 * (S2)**(2) * \
(xi)**(2) + (16 * (xi)**(4) + (S1)**(2) * (-86 * (S2)**(2) + 54 * \
(xi)**(2))))))))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[28]=",ExpressionUUID->"99d0f5f3-4d26-47ea-96cd-abed50451fb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff1 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"5802ffca-5168-4102-bd75-fadf69a42b7c"],

Cell[BoxData["\<\"coeff1 = (32 * (1 + q) * u * (((-1 + q))**(4) * (q)**(2) * \
((1 + q))**(5) * (S1)**(4) + (((-1 + q))**(4) * ((1 + q))**(5) * (1 + (-12 + \
q) * q) * (S1)**(2) * (S2)**(2) + ((1 + q) * ((-1 + (q)**(2)))**(4) * \
(S2)**(4) + (((-1 + q))**(2) * (q)**(2) * ((1 + q))**(3) * (-1 + q * (18 + 7 \
* q)) * (S1)**(2) * (xi)**(2) + (-1 * (q)**(2) * (1 + q) * (S2)**(2) * \
(xi)**(2) + (2 * (q)**(4) * (1 + q) * (S2)**(2) * (xi)**(2) + (-1 * (q)**(6) \
* (1 + q) * (S2)**(2) * (xi)**(2) + (2 * (-1 + q) * (q)**(3) * ((1 + q))**(3) \
* (S2)**(2) * (xi)**(2) + (10 * ((-1 + q))**(2) * (q)**(3) * ((1 + q))**(3) * \
(S2)**(2) * (xi)**(2) + (-2 * (-1 + q) * (q)**(4) * ((1 + q))**(3) * \
(S2)**(2) * (xi)**(2) + (-1 * ((-1 + q))**(2) * (q)**(4) * ((1 + q))**(3) * \
(S2)**(2) * (xi)**(2) + (2 * ((-1 + q))**(2) * (q)**(2) * ((1 + q))**(3) * (4 \
+ 5 * q) * (S2)**(2) * (xi)**(2) + (-8 * (q)**(4) * (xi)**(4) + (-16 * \
(q)**(5) * (xi)**(4) + (-8 * (q)**(6) * (xi)**(4) + (-16 * (q)**(5) * (1 + q) \
* (xi)**(4) + -8 * (q)**(6) * (1 + q) * (xi)**(4))))))))))))))))) + (32 * \
((-1 + q))**(2) * q * ((1 + q))**(4) * xi * ((q)**(4) * (S1)**(2) + \
((S2)**(2) + (q * ((S1)**(2) + -1 * (S2)**(2)) + ((q)**(3) * (-1 * (S1)**(2) \
+ (S2)**(2)) + -1 * (q)**(2) * ((S1)**(2) + ((S2)**(2) + (xi)**(2))))))) + \
((u)**(4) * (128 * q * (1 + q) * xi * ((-1 + q) * (q)**(2) * ((1 + q))**(4) * \
(20 + q * (-29 + 12 * q)) * (S1)**(6) + ((-1 + q) * q * ((1 + q))**(4) * (-3 \
+ 2 * (q)**(2) * (-7 + 4 * q)) * (S1)**(4) * (S2)**(2) + ((-1 + q) * ((1 + \
q))**(4) * (-8 + (14 * q + 3 * (q)**(3))) * (S1)**(2) * (S2)**(4) + (-4 * \
((-1 + q))**(3) * ((1 + q))**(4) * (S2)**(6) + (-12 * ((-1 + q))**(2) * q * \
((1 + q))**(4) * (S2)**(6) + (-1 * (-1 + q) * q * ((1 + q))**(4) * (1 + 2 * \
q) * (S2)**(6) + (-2 * (-4 + q) * ((1 + q))**(2) * ((-1 + (q)**(2)))**(2) * \
(S2)**(6) + (-4 * (q)**(3) * ((1 + q))**(2) * (3 + q * (-5 + 3 * q)) * \
(S1)**(4) * (xi)**(2) + (-4 * (-2 + q) * (q)**(2) * ((1 + q))**(3) * (-1 + 2 \
* q) * (S1)**(2) * (S2)**(2) * (xi)**(2) + (-4 * (q)**(3) * ((1 + q))**(2) * \
(S2)**(4) * (xi)**(2) + (-8 * (-1 + q) * (q)**(3) * ((1 + q))**(2) * \
(S2)**(4) * (xi)**(2) + (8 * (q)**(2) * (1 + q) * (-1 + (q)**(2)) * (S2)**(4) \
* (xi)**(2) + -4 * (q)**(2) * ((-1 + (q)**(2)))**(2) * (S2)**(4) * \
(xi)**(2))))))))))))) + 256 * ((1 + q))**(2) * u * (((-1 + q))**(2) * \
(q)**(3) * ((1 + q))**(4) * (-5 + 2 * q) * (S1)**(8) + (2 * ((-1 + q))**(2) * \
(q)**(2) * ((1 + q))**(4) * (6 + (-1 + q) * q) * (S1)**(6) * (S2)**(2) + (-9 \
* ((-1 + q))**(2) * q * ((1 + q))**(4) * (1 + (q)**(2)) * (S1)**(4) * \
(S2)**(4) + (2 * ((-1 + q))**(2) * ((1 + q))**(4) * (1 + q * (-1 + 6 * q)) * \
(S1)**(2) * (S2)**(6) + (-2 * ((-1 + q))**(3) * ((1 + q))**(4) * (S2)**(8) + \
(-3 * ((-1 + q))**(2) * q * ((1 + q))**(4) * (S2)**(8) + (-2 * (-2 + q) * (-1 \
+ q) * (q)**(4) * ((1 + q))**(2) * (S1)**(6) * (xi)**(2) + (-2 * (-1 + q) * \
(q)**(3) * ((1 + q))**(2) * (3 + (-1 + q) * q) * (S1)**(4) * (S2)**(2) * \
(xi)**(2) + (2 * (-1 + q) * (q)**(2) * ((1 + q))**(2) * (1 + q * (-1 + 3 * \
q)) * (S1)**(2) * (S2)**(4) * (xi)**(2) + (-2 * (-1 + q) * (q)**(3) * ((1 + \
q))**(2) * (S2)**(6) * (xi)**(2) + -2 * (q)**(2) * ((-1 + (q)**(2)))**(2) * \
(S2)**(6) * (xi)**(2)))))))))))) + (u)**(2) * (32 * (1 + q) * u * (-2 * ((-1 \
+ q))**(2) * (q)**(2) * ((1 + q))**(5) * (S1)**(6) + (30 * ((-1 + q))**(2) * \
(q)**(3) * ((1 + q))**(5) * (S1)**(6) + (8 * ((-1 + q))**(2) * (q)**(4) * ((1 \
+ q))**(5) * (S1)**(6) + (2 * ((-1 + q))**(2) * q * ((1 + q))**(5) * (15 + q \
* (-55 + 2 * q * (9 + 2 * q))) * (S1)**(4) * (S2)**(2) + (2 * ((-1 + q))**(2) \
* ((1 + q))**(5) * (4 + q * (18 + 5 * q * (-11 + 3 * q))) * (S1)**(2) * \
(S2)**(4) + (10 * ((-1 + q))**(2) * q * ((1 + q))**(5) * (S2)**(6) + (-1 * \
((-1 + q))**(2) * (q)**(2) * ((1 + q))**(5) * (S2)**(6) + (-1 * ((1 + \
q))**(3) * (-8 + (-20 + q) * q) * ((-1 + (q)**(2)))**(2) * (S2)**(6) + (-48 * \
(q)**(3) * ((1 + q))**(3) * (S1)**(4) * (xi)**(2) + (128 * (q)**(4) * ((1 + \
q))**(3) * (S1)**(4) * (xi)**(2) + (-144 * (q)**(5) * ((1 + q))**(3) * \
(S1)**(4) * (xi)**(2) + (40 * (q)**(6) * ((1 + q))**(3) * (S1)**(4) * \
(xi)**(2) + (8 * (q)**(2) * ((1 + q))**(3) * (1 + q * (-8 + q * (20 + (-8 + \
q) * q))) * (S1)**(2) * (S2)**(2) * (xi)**(2) + (-16 * (q)**(3) * ((1 + \
q))**(3) * (S2)**(4) * (xi)**(2) + (-24 * ((-1 + q))**(2) * (q)**(3) * ((1 + \
q))**(3) * (S2)**(4) * (xi)**(2) + (-8 * (q)**(4) * ((1 + q))**(3) * \
(S2)**(4) * (xi)**(2) + (-8 * (-1 + q) * (q)**(3) * ((1 + q))**(3) * (1 + 2 * \
q) * (S2)**(4) * (xi)**(2) + (8 * (-1 + q) * (q)**(2) * ((1 + q))**(3) * (-1 \
+ 4 * q) * (S2)**(4) * (xi)**(2) + (-8 * (-4 + q) * (q)**(2) * (1 + q) * ((-1 \
+ (q)**(2)))**(2) * (S2)**(4) * (xi)**(2) + (-16 * (q)**(4) * (1 + (q)**(2) * \
(2 + 3 * q)) * (S1)**(2) * (xi)**(4) + (-16 * (q)**(4) * (1 + q) * (S2)**(2) \
* (xi)**(4) + (-32 * (q)**(5) * (1 + q) * (S2)**(2) * (xi)**(4) + (-16 * (-1 \
+ q) * (q)**(5) * (1 + q) * (S2)**(2) * (xi)**(4) + 32 * (q)**(4) * (-1 + \
(q)**(2)) * (S2)**(2) * (xi)**(4)))))))))))))))))))))))) + 32 * q * ((1 + \
q))**(2) * xi * (8 * (q)**(8) * (S1)**(2) * (2 * (S1)**(2) + (S2)**(2)) + (8 \
* (S2)**(2) * ((S1)**(2) + 2 * (S2)**(2)) + ((q)**(7) * (65 * (S1)**(4) + (2 \
* (S1)**(2) * (S2)**(2) + -3 * (S2)**(4))) + (q * (-3 * (S1)**(4) + (2 * \
(S1)**(2) * (S2)**(2) + 65 * (S2)**(4))) + (2 * (q)**(6) * (7 * (S1)**(4) + \
(-14 * (S1)**(2) * (S2)**(2) + (23 * (S2)**(4) + -4 * (S2)**(2) * \
(xi)**(2)))) + (-4 * (q)**(4) * (19 * (S1)**(4) + (19 * (S2)**(4) + (14 * \
(S2)**(2) * (xi)**(2) + (4 * (xi)**(4) + -2 * (S1)**(2) * (5 * (S2)**(2) + -7 \
* (xi)**(2)))))) + (2 * (q)**(2) * (23 * (S1)**(4) + (7 * (S2)**(4) + -2 * \
(S1)**(2) * (7 * (S2)**(2) + 2 * (xi)**(2)))) + ((q)**(5) * (-133 * (S1)**(4) \
+ (71 * (S2)**(4) + (12 * (S2)**(2) * (xi)**(2) + -2 * (S1)**(2) * ((S2)**(2) \
+ 38 * (xi)**(2))))) + (q)**(3) * (71 * (S1)**(4) + (-2 * (S1)**(2) * \
((S2)**(2) + -6 * (xi)**(2)) + -19 * (7 * (S2)**(4) + 4 * (S2)**(2) * \
(xi)**(2))))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[30]=",ExpressionUUID->"f4cb827c-096b-424e-97f5-183d07b3a2db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kappacoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Kappa]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff0 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"f3dbde09-ff7f-4ffa-a73c-ebe30dffc687"],

Cell[BoxData["\<\"coeff0 = (16 * ((-1 + (q)**(2)))**(2) * (((-1 + \
(q)**(2)))**(2) * (S1)**(2) + -1 * (q)**(2) * (xi)**(2)) * (((-1 + \
(q)**(2)))**(2) * (S2)**(2) + -1 * (q)**(2) * (xi)**(2)) + (32 * q * u * xi * \
(-1 * ((-1 + q))**(4) * q * ((1 + q))**(5) * (S1)**(4) + (5 * ((-1 + q))**(4) \
* ((1 + q))**(6) * (S1)**(2) * (S2)**(2) + (-1 * (1 + q) * ((-1 + \
(q)**(2)))**(4) * (S2)**(4) + (-1 * (q)**(2) * (1 + q) * (5 + 3 * q) * ((-1 + \
(q)**(2)))**(2) * (S1)**(2) * (xi)**(2) + ((q)**(2) * (1 + q) * (S2)**(2) * \
(xi)**(2) + (-2 * (q)**(4) * (1 + q) * (S2)**(2) * (xi)**(2) + ((q)**(6) * (1 \
+ q) * (S2)**(2) * (xi)**(2) + (-1 * ((-1 + q))**(2) * (q)**(2) * ((1 + \
q))**(3) * (4 + 5 * q) * (S2)**(2) * (xi)**(2) + (4 * (q)**(4) * (xi)**(4) + \
(8 * (q)**(5) * (xi)**(4) + 4 * (q)**(6) * (xi)**(4))))))))))) + ((u)**(2) * \
(32 * q * u * xi * (((-1 + q))**(2) * q * ((1 + q))**(5) * (S1)**(6) + (-25 * \
((-1 + q))**(2) * (q)**(2) * ((1 + q))**(5) * (S1)**(6) + (-12 * ((-1 + \
q))**(2) * (q)**(3) * ((1 + q))**(5) * (S1)**(6) + (((-1 + q))**(2) * ((1 + \
q))**(5) * (-4 + q * (29 + q * (-21 + 32 * q))) * (S1)**(4) * (S2)**(2) + (-1 \
* ((-1 + q))**(2) * ((1 + q))**(5) * (-32 + q * (21 + q * (-29 + 4 * q))) * \
(S1)**(2) * (S2)**(4) + (-1 * ((-1 + q))**(2) * ((1 + q))**(5) * (4 + 5 * q) \
* (S2)**(6) + (((1 + q))**(3) * (-8 + (-20 + q) * q) * ((-1 + (q)**(2)))**(2) \
* (S2)**(6) + (-4 * (q)**(2) * ((1 + q))**(3) * (-1 + q * (14 + 5 * (-4 + q) \
* q)) * (S1)**(4) * (xi)**(2) + (-8 * (q)**(2) * ((1 + q))**(4) * (2 + q * \
(-3 + 2 * q)) * (S1)**(2) * (S2)**(2) * (xi)**(2) + (4 * (q)**(2) * ((1 + \
q))**(2) * (S2)**(4) * (xi)**(2) + (8 * (q)**(3) * ((1 + q))**(2) * (S2)**(4) \
* (xi)**(2) + (4 * (q)**(4) * ((1 + q))**(2) * (S2)**(4) * (xi)**(2) + (-8 * \
(-1 + q) * (q)**(2) * ((1 + q))**(3) * (-1 + 4 * q) * (S2)**(4) * (xi)**(2) + \
(4 * (-4 + q) * (q)**(2) * (1 + q) * ((-1 + (q)**(2)))**(2) * (S2)**(4) * \
(xi)**(2) + (16 * (q)**(4) * (1 + q) * (-1 + 2 * q) * (S1)**(2) * (xi)**(4) + \
(16 * (q)**(4) * (1 + q) * (S2)**(2) * (xi)**(4) + -16 * (q)**(4) * (-1 + \
(q)**(2)) * (S2)**(2) * (xi)**(4))))))))))))))))) + 16 * (-1 * (-1 + q) * \
(q)**(2) * ((1 + q))**(3) * ((-1 + (q)**(2)))**(3) * (S1)**(6) + ((-1 + q) * \
((1 + q))**(3) * ((-1 + (q)**(2)))**(3) * (-1 + 2 * q * (12 + 5 * q)) * \
(S1)**(4) * (S2)**(2) + (-1 * (-1 + q) * ((1 + q))**(3) * (-10 + (-24 + q) * \
q) * ((-1 + (q)**(2)))**(3) * (S1)**(2) * (S2)**(4) + (-1 * ((1 + q))**(2) * \
((-1 + (q)**(2)))**(4) * (S2)**(6) + (-1 * ((1 + q))**(2) * ((q + -1 * \
(q)**(3)))**(2) * (-1 + q * (40 + 23 * q)) * (S1)**(4) * (xi)**(2) + (2 * \
((-1 + q))**(2) * (q)**(2) * ((1 + q))**(4) * (11 + q * (-24 + 11 * q)) * \
(S1)**(2) * (S2)**(2) * (xi)**(2) + ((q)**(2) * ((1 + q))**(2) * (S2)**(4) * \
(xi)**(2) + (-2 * (q)**(4) * ((1 + q))**(2) * (S2)**(4) * (xi)**(2) + \
((q)**(6) * ((1 + q))**(2) * (S2)**(4) * (xi)**(2) + (-4 * ((-1 + q))**(2) * \
(q)**(2) * ((1 + q))**(4) * (4 + 5 * q) * (S2)**(4) * (xi)**(2) + ((q)**(2) * \
((1 + q))**(2) * (-8 + (-20 + q) * q) * ((-1 + (q)**(2)))**(2) * (S2)**(4) * \
(xi)**(2) + (8 * (q)**(4) * ((1 + q))**(2) * (-4 + q * (7 + q)) * (S1)**(2) * \
(xi)**(4) + (16 * (q)**(4) * (1 + q) * (S2)**(2) * (xi)**(4) + (32 * (q)**(5) \
* (1 + q) * (S2)**(2) * (xi)**(4) + (16 * (q)**(6) * (1 + q) * (S2)**(2) * \
(xi)**(4) + (-8 * (-1 + q) * (q)**(4) * ((1 + q))**(2) * (-1 + 4 * q) * \
(S2)**(2) * (xi)**(4) + 16 * (q)**(6) * (xi)**(6)))))))))))))))))) + (u)**(4) \
* (128 * q * (1 + q) * u * xi * (-1 * ((-1 + q))**(2) * (q)**(2) * ((1 + \
q))**(4) * (-5 + 8 * q) * (S1)**(8) + (((-1 + q))**(2) * q * ((1 + q))**(4) * \
(-1 + (q + 12 * (q)**(2))) * (S1)**(6) * (S2)**(2) + (-1 * ((-1 + q))**(2) * \
((1 + q))**(5) * (4 + (q + 4 * (q)**(2))) * (S1)**(4) * (S2)**(4) + (-1 * (-4 \
+ q) * ((-1 + q))**(2) * ((1 + q))**(4) * (3 + q) * (S1)**(2) * (S2)**(6) + \
(4 * ((-1 + q))**(3) * ((1 + q))**(4) * (S2)**(8) + ((-4 + q) * ((1 + \
q))**(2) * ((-1 + (q)**(2)))**(2) * (S2)**(8) + (4 * (-1 + q) * (q)**(3) * \
((1 + q))**(2) * (-1 + 2 * q) * (S1)**(6) * (xi)**(2) + (-4 * (-1 + q) * \
(q)**(2) * ((1 + q))**(2) * (1 + q * (-1 + 3 * q)) * (S1)**(4) * (S2)**(2) * \
(xi)**(2) + (4 * (-1 + q) * (q)**(2) * ((1 + q))**(2) * (3 + (-1 + q) * q) * \
(S1)**(2) * (S2)**(4) * (xi)**(2) + (-4 * (q)**(2) * (1 + q) * (-1 + \
(q)**(2)) * (S2)**(6) * (xi)**(2) + 4 * (q)**(2) * ((-1 + (q)**(2)))**(2) * \
(S2)**(6) * (xi)**(2))))))))))) + (16 * (((-1 + q))**(2) * (q)**(2) * ((1 + \
q))**(6) * (S1)**(8) + (-20 * ((-1 + q))**(2) * (q)**(3) * ((1 + q))**(6) * \
(S1)**(8) + (-8 * ((-1 + q))**(2) * (q)**(4) * ((1 + q))**(6) * (S1)**(8) + \
(4 * ((-1 + q))**(2) * q * ((1 + q))**(6) * (-5 + q * (27 + q * (-3 + 8 * \
q))) * (S1)**(6) * (S2)**(2) + (-2 * ((-1 + q))**(2) * ((1 + q))**(6) * (4 + \
q * (6 + q * (61 + (6 * q + 4 * (q)**(2))))) * (S1)**(4) * (S2)**(4) + (32 * \
((-1 + q))**(2) * ((1 + q))**(5) * (S1)**(2) * (S2)**(6) + (20 * ((-1 + \
q))**(2) * q * ((1 + q))**(5) * (S1)**(2) * (S2)**(6) + (96 * ((-1 + q))**(2) \
* (q)**(2) * ((1 + q))**(5) * (S1)**(2) * (S2)**(6) + (88 * ((-1 + q))**(2) * \
(q)**(3) * ((1 + q))**(5) * (S1)**(2) * (S2)**(6) + (-20 * ((-1 + q))**(2) * \
(q)**(4) * ((1 + q))**(5) * (S1)**(2) * (S2)**(6) + (((1 + q))**(4) * (-8 + \
(-20 + q) * q) * ((-1 + (q)**(2)))**(2) * (S2)**(8) + (-32 * (-1 + q) * \
(q)**(3) * ((1 + q))**(4) * (S1)**(6) * (xi)**(2) + (144 * (-1 + q) * \
(q)**(4) * ((1 + q))**(4) * (S1)**(6) * (xi)**(2) + (-88 * (-1 + q) * \
(q)**(5) * ((1 + q))**(4) * (S1)**(6) * (xi)**(2) + (8 * (-1 + q) * (q)**(2) \
* ((1 + q))**(4) * (1 + 2 * (-2 + q) * q * (1 + 4 * q)) * (S1)**(4) * \
(S2)**(2) * (xi)**(2) + (-8 * (-1 + q) * (q)**(2) * ((1 + q))**(4) * (8 + q * \
(-14 + (-4 + q) * q)) * (S1)**(2) * (S2)**(4) * (xi)**(2) + (16 * ((-1 + \
q))**(3) * (q)**(2) * ((1 + q))**(4) * (S2)**(6) * (xi)**(2) + (-8 * (-1 + q) \
* (q)**(2) * ((1 + q))**(4) * (-1 + 4 * q) * (S2)**(6) * (xi)**(2) + (16 * \
(-4 + q) * (q)**(2) * ((1 + q))**(2) * ((-1 + (q)**(2)))**(2) * (S2)**(6) * \
(xi)**(2) + (16 * (q)**(4) * ((1 + q))**(2) * (1 + 6 * (-1 + q) * q) * \
(S1)**(4) * (xi)**(4) + (-32 * (q)**(4) * ((1 + q))**(2) * (3 + q * (-5 + 3 * \
q)) * (S1)**(2) * (S2)**(2) * (xi)**(4) + (16 * (q)**(4) * ((1 + q))**(2) * \
(S2)**(4) * (xi)**(4) + (-64 * (q)**(4) * (1 + q) * (-1 + (q)**(2)) * \
(S2)**(4) * (xi)**(4) + 16 * (q)**(4) * ((-1 + (q)**(2)))**(2) * (S2)**(4) * \
(xi)**(4)))))))))))))))))))))))) + -256 * ((1 + q))**(2) * ((-1 + \
(q)**(2)))**(2) * (((S1)**(2) + -1 * (S2)**(2)))**(2) * ((-1 * q * (S1)**(2) \
+ (S2)**(2)))**(2) * (u)**(2) * ((q)**(4) * (S1)**(2) + ((S2)**(2) + \
((q)**(3) * ((S1)**(2) + -1 * (S2)**(2)) + (q * (-1 * (S1)**(2) + (S2)**(2)) \
+ -1 * (q)**(2) * ((S1)**(2) + ((S2)**(2) + (xi)**(2))))))))))))\"\>"], \
"Output",
 CellLabel->
  "Out[32]=",ExpressionUUID->"44b40b11-6ceb-4012-808c-6712812a70be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"bc278a30-70a4-41e5-8526-298498831411"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kappacoeff5", "*", " ", 
    RowBox[{"\[Kappa]", "^", "5"}]}], "+", 
   RowBox[{"kappacoeff4", "*", " ", 
    RowBox[{"\[Kappa]", "^", "4"}]}], "+", 
   RowBox[{"kappacoeff3", "*", " ", 
    RowBox[{"\[Kappa]", "^", "3"}]}], "+", 
   RowBox[{"kappacoeff2", "*", " ", 
    RowBox[{"\[Kappa]", "^", "2"}]}], "+", 
   RowBox[{"kappacoeff1", "*", " ", "\[Kappa]"}], "+", "kappacoeff0", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"1edb4b49-4a32-46b2-ae2e-30c70f31cf12"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[33]=",ExpressionUUID->"e2c6d8f7-fd52-4eb0-807c-9949675b7009"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(iii) Spin-orbit resonances in xi ", \
"Section",ExpressionUUID->"143f1ada-0caa-4b70-8a7a-37b0a10775d8"],

Cell[CellGroupData[{

Cell["\<\
Extract coefficients. Sort terms in powers of u to improve numerical \
stability.\
\>", "Subsubsection",ExpressionUUID->"3e612f99-28ab-4647-b3dc-437cf3a42c29"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff6", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "6"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff6 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"b9ee3dfa-b72a-4b61-b78c-85f9cfab9df8"],

Cell[BoxData["\<\"coeff6 = 256 * (q)**(6) * (u)**(2)\"\>"], "Output",
 CellLabel->
  "Out[35]=",ExpressionUUID->"a9f9f4c9-d4ff-4247-ab54-4dd3d183d28e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff5", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "5"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff5 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"784a49ea-0dd1-4e0f-acf3-886f444d20a5"],

Cell[BoxData["\<\"coeff5 = (128 * (q)**(5) * ((1 + q))**(2) * u + (u)**(2) * \
(512 * (q)**(5) * (1 + q) * ((-1 + 2 * q) * (S1)**(2) + -1 * (-2 + q) * \
(S2)**(2)) * u + -512 * (q)**(5) * ((1 + q))**(2) * kappa))\"\>"], "Output",
 CellLabel->
  "Out[37]=",ExpressionUUID->"82fefdfa-7253-4e20-bccf-aa9b91367278"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff4", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "4"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff4 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"b2450096-0986-4541-822b-158909c222b2"],

Cell[BoxData["\<\"coeff4 = (16 * (q)**(4) * ((-1 + (q)**(2)))**(2) + (256 * \
(q)**(4) * ((1 + q))**(2) * ((1 + (-6 * q + 6 * (q)**(2))) * (S1)**(4) + (-2 \
* (3 + (-5 * q + 3 * (q)**(2))) * (S1)**(2) * (S2)**(2) + (6 + (-6 * q + \
(q)**(2))) * (S2)**(4))) * (u)**(4) + (-256 * (q)**(4) * ((1 + q))**(2) * (1 \
+ (3 * q + (q)**(2))) * u * kappa + (u)**(2) * (-512 * (q)**(4) * ((1 + \
q))**(2) * ((1 + (-1 * q + 3 * (q)**(2))) * (S1)**(2) + (3 + (-1 * q + \
(q)**(2))) * (S2)**(2)) * u * kappa + 128 * (q)**(4) * ((1 + q))**(2) * ((-4 \
+ (7 * q + (q)**(2))) * (S1)**(2) + ((1 + (7 * q + -4 * (q)**(2))) * \
(S2)**(2) + 2 * (1 + (4 * q + (q)**(2))) * (kappa)**(2)))))))\"\>"], "Output",
 
 CellLabel->
  "Out[39]=",ExpressionUUID->"6b6b7986-7c7c-4c5d-8a1a-18cc6d59a89d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "3"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff3 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"5c2913a1-ec84-45e8-9b0c-7c42db2bfaeb"],

Cell[BoxData["\<\"coeff3 = (-32 * ((-1 + q))**(2) * (q)**(3) * ((1 + q))**(4) \
* kappa + ((u)**(4) * (512 * (q)**(3) * ((1 + q))**(3) * ((S1)**(2) + -1 * \
(S2)**(2)) * ((S2)**(2) * ((S1)**(2) + -2 * (S2)**(2)) + ((q)**(3) * (2 * \
(S1)**(4) + -1 * (S1)**(2) * (S2)**(2)) + (-1 * (q)**(2) * (3 * (S1)**(4) + \
(-1 * (S1)**(2) * (S2)**(2) + (S2)**(4))) + q * ((S1)**(4) + (-1 * (S1)**(2) \
* (S2)**(2) + 3 * (S2)**(4)))))) * u + 512 * (q)**(3) * ((1 + q))**(3) * (-1 \
* q * (3 + q * (-5 + 3 * q)) * (S1)**(4) + (-2 * (S1)**(2) * (S2)**(2) + (3 * \
q * (S1)**(2) * (S2)**(2) + (3 * (q)**(2) * (S1)**(2) * (S2)**(2) + (-2 * \
(q)**(3) * (S1)**(2) * (S2)**(2) + -1 * (3 + q * (-5 + 3 * q)) * \
(S2)**(4)))))) * kappa) + (32 * (q)**(3) * ((1 + q))**(3) * u * (-1 * ((-1 + \
q))**(2) * (5 + 3 * q) * (S1)**(2) + (-1 * ((-1 + q))**(2) * (3 + 5 * q) * \
(S2)**(2) + 4 * (1 + (9 * q + (9 * (q)**(2) + (q)**(3)))) * (kappa)**(2))) + \
(u)**(2) * (128 * (q)**(3) * ((1 + q))**(3) * kappa * ((-2 + (5 * q + -19 * \
(q)**(2))) * (S1)**(2) + -1 * q * ((19 + (-5 * q + 2 * (q)**(2))) * (S2)**(2) \
+ 4 * (1 + q) * (kappa)**(2))) + 128 * (q)**(3) * ((1 + q))**(3) * u * ((1 + \
(-14 * q + (20 * (q)**(2) + -5 * (q)**(3)))) * (S1)**(4) + ((-5 + (20 * q + \
(-14 * (q)**(2) + (q)**(3)))) * (S2)**(4) + (4 * (1 + (-1 * q + 3 * \
(q)**(2))) * (S2)**(2) * (kappa)**(2) + (S1)**(2) * (2 * (-2 + (q + ((q)**(2) \
+ -2 * (q)**(3)))) * (S2)**(2) + 4 * q * (3 + (-1 * q + (q)**(2))) * \
(kappa)**(2)))))))))\"\>"], "Output",
 CellLabel->
  "Out[41]=",ExpressionUUID->"ca2c7a21-abc5-44a6-ab3a-39831d487414"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "2"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff2 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"a463548a-8cba-4df4-a18f-63da01e89134"],

Cell[BoxData["\<\"coeff2 = (32 * (q)**(2) * ((1 + q))**(4) * u * kappa * \
(((-1 + q))**(2) * (-1 + (18 * q + 7 * (q)**(2))) * (S1)**(2) + (-1 * ((-1 + \
q))**(2) * (-7 + (-18 * q + (q)**(2))) * (S2)**(2) + -16 * q * (1 + (3 * q + \
(q)**(2))) * (kappa)**(2))) + (16 * (q)**(2) * ((1 + q))**(4) * (-1 * ((-1 + \
q))**(4) * (S1)**(2) + (-1 * ((-1 + q))**(4) * (S2)**(2) + ((-1 + q))**(2) * \
(1 + (4 * q + (q)**(2))) * (kappa)**(2))) + ((u)**(2) * (16 * (q)**(2) * ((1 \
+ q))**(4) * (-1 * ((-1 + q))**(2) * (-1 + (40 * q + 23 * (q)**(2))) * \
(S1)**(4) + (((-1 + q))**(2) * (-23 + (-40 * q + (q)**(2))) * (S2)**(4) + (8 \
* (-1 + (11 * q + (2 * (q)**(2) + 12 * (q)**(3)))) * (S2)**(2) * (kappa)**(2) \
+ (16 * (q)**(2) * (kappa)**(4) + 2 * (S1)**(2) * (((-1 + q))**(2) * (11 + \
(-24 * q + 11 * (q)**(2))) * (S2)**(2) + 4 * q * (12 + (2 * q + (11 * \
(q)**(2) + -1 * (q)**(3)))) * (kappa)**(2)))))) + 256 * (q)**(2) * ((1 + \
q))**(4) * u * kappa * ((q)**(4) * (S1)**(2) * (5 * (S1)**(2) + (S2)**(2)) + \
((S2)**(2) * ((S1)**(2) + 5 * (S2)**(2)) + (-2 * q * (3 * (S1)**(4) + (4 * \
(S1)**(2) * (S2)**(2) + (9 * (S2)**(4) + -1 * (S2)**(2) * (kappa)**(2)))) + \
(-2 * (q)**(3) * (9 * (S1)**(4) + (3 * (S2)**(4) + (S1)**(2) * (4 * (S2)**(2) \
+ -1 * (kappa)**(2)))) + 4 * (q)**(2) * (4 * (S1)**(4) + (4 * (S2)**(4) + (-1 \
* (S2)**(2) * (kappa)**(2) + (S1)**(2) * (5 * (S2)**(2) + -1 * \
(kappa)**(2)))))))))) + (u)**(4) * (256 * (q)**(2) * ((1 + q))**(4) * \
(((S1)**(2) + -1 * (S2)**(2)))**(2) * (((q)**(2) * (S1)**(2) + ((S2)**(2) + \
-1 * q * ((S1)**(2) + (S2)**(2)))))**(2) * (u)**(2) + (-512 * (q)**(2) * ((1 \
+ q))**(4) * ((q)**(4) * (S1)**(4) * ((S1)**(2) + (S2)**(2)) + ((S2)**(4) * \
((S1)**(2) + (S2)**(2)) + (-1 * (q)**(3) * (3 * (S1)**(6) + (2 * (S1)**(4) * \
(S2)**(2) + 3 * (S1)**(2) * (S2)**(4))) + (2 * (q)**(2) * ((S1)**(6) + (2 * \
(S1)**(4) * (S2)**(2) + (2 * (S1)**(2) * (S2)**(4) + (S2)**(6)))) + -1 * q * \
(3 * (S1)**(4) * (S2)**(2) + (2 * (S1)**(2) * (S2)**(4) + 3 * (S2)**(6))))))) \
* u * kappa + 128 * (q)**(2) * ((1 + q))**(4) * (-1 * (S1)**(4) * (S2)**(2) + \
(8 * (S1)**(2) * (S2)**(4) + (-11 * (S2)**(6) + (2 * (S2)**(4) * (kappa)**(2) \
+ ((q)**(4) * (-11 * (S1)**(6) + (-1 * (S1)**(2) * (S2)**(4) + 2 * (S1)**(4) \
* (4 * (S2)**(2) + (kappa)**(2)))) + ((q)**(3) * (29 * (S1)**(6) + (4 * \
(S2)**(6) + (-2 * (S1)**(4) * (11 * (S2)**(2) + 6 * (kappa)**(2)) + (S1)**(2) \
* (5 * (S2)**(4) + -12 * (S2)**(2) * (kappa)**(2))))) + (2 * (q)**(2) * (-11 \
* (S1)**(6) + (-11 * (S2)**(6) + (6 * (S2)**(4) * (kappa)**(2) + ((S1)**(4) * \
(5 * (S2)**(2) + 6 * (kappa)**(2)) + 5 * (S1)**(2) * ((S2)**(4) + 2 * \
(S2)**(2) * (kappa)**(2)))))) + q * (4 * (S1)**(6) + (5 * (S1)**(4) * \
(S2)**(2) + (29 * (S2)**(6) + (-12 * (S2)**(4) * (kappa)**(2) + -2 * \
(S1)**(2) * (11 * (S2)**(4) + 6 * (S2)**(2) * (kappa)**(2))))))))))))))))))\"\
\>"], "Output",
 CellLabel->
  "Out[43]=",ExpressionUUID->"5a63e6cd-116d-4155-bde2-e507d4061499"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "1"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff1 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"3c84da50-8c54-4467-8b20-00f854c5c33e"],

Cell[BoxData["\<\"coeff1 = ((u)**(4) * (128 * q * ((1 + q))**(4) * (-1 * ((-1 \
+ q))**(2) * (q)**(2) * (1 + q) * (-5 + 8 * q) * (S1)**(8) + (((-1 + q))**(2) \
* q * (1 + q) * (1 + 3 * q) * (-1 + 4 * q) * (S1)**(6) * (S2)**(2) + (-1 * \
((-1 + (q)**(2)))**(2) * (4 + (q + 4 * (q)**(2))) * (S1)**(4) * (S2)**(4) + \
(-1 * (-4 + q) * ((-1 + q))**(2) * (1 + q) * (3 + q) * (S1)**(2) * (S2)**(6) \
+ ((-4 + q) * ((-1 + q))**(2) * (1 + q) * (S2)**(8) + 4 * ((-1 + q))**(3) * \
(1 + q) * (S2)**(8)))))) * u + 128 * (-1 + q) * q * ((1 + q))**(5) * (-4 * \
(S2)**(4) * (2 * (S1)**(2) + 3 * (S2)**(2)) + (4 * (q)**(4) * (3 * (S1)**(6) \
+ 2 * (S1)**(4) * (S2)**(2)) + ((q)**(3) * (-29 * (S1)**(6) + (-14 * \
(S1)**(4) * (S2)**(2) + 3 * (S1)**(2) * (S2)**(4))) + (20 * (q)**(2) * \
((S1)**(6) + -1 * (S2)**(6)) + q * (-3 * (S1)**(4) * (S2)**(2) + (14 * \
(S1)**(2) * (S2)**(4) + 29 * (S2)**(6))))))) * kappa) + (32 * q * ((1 + \
q))**(3) * ((-1 + (q)**(2)))**(2) * kappa * ((q)**(3) * (S1)**(2) + \
((S2)**(2) + (q * ((S1)**(2) + (-2 * (S2)**(2) + -1 * (kappa)**(2))) + \
(q)**(2) * (-2 * (S1)**(2) + ((S2)**(2) + -1 * (kappa)**(2)))))) + (-32 * q * \
((1 + q))**(5) * u * ((q)**(5) * (S1)**(2) * ((S1)**(2) + (-5 * (S2)**(2) + 4 \
* (kappa)**(2))) + ((S2)**(2) * (-5 * (S1)**(2) + ((S2)**(2) + 4 * \
(kappa)**(2))) + (-1 * (q)**(2) * (4 * (S1)**(4) + (-6 * (S2)**(4) + (45 * \
(S2)**(2) * (kappa)**(2) + (20 * (kappa)**(4) + (S1)**(2) * (10 * (S2)**(2) + \
-29 * (kappa)**(2)))))) + (q * ((S1)**(4) + (-4 * (S2)**(4) + (15 * (S2)**(2) \
* (kappa)**(2) + 3 * (S1)**(2) * (5 * (S2)**(2) + -1 * (kappa)**(2))))) + \
((q)**(4) * (-4 * (S1)**(4) + ((S2)**(4) + (-3 * (S2)**(2) * (kappa)**(2) + \
15 * (S1)**(2) * ((S2)**(2) + (kappa)**(2))))) + (q)**(3) * (6 * (S1)**(4) + \
(-4 * (S2)**(4) + (29 * (S2)**(2) * (kappa)**(2) + (-20 * (kappa)**(4) + -5 * \
(S1)**(2) * (2 * (S2)**(2) + 9 * (kappa)**(2))))))))))) + (u)**(2) * (32 * q \
* ((1 + q))**(5) * kappa * (8 * (q)**(5) * (S1)**(2) * (2 * (S1)**(2) + \
(S2)**(2)) + (8 * (S2)**(2) * ((S1)**(2) + 2 * (S2)**(2)) + (q * (-3 * \
(S1)**(4) + (-22 * (S1)**(2) * (S2)**(2) + (17 * (S2)**(4) + 4 * (S2)**(2) * \
(kappa)**(2)))) + ((q)**(2) * (55 * (S1)**(4) + (-85 * (S2)**(4) + (12 * \
(S2)**(2) * (kappa)**(2) + 2 * (S1)**(2) * (7 * (S2)**(2) + -40 * \
(kappa)**(2))))) + ((q)**(4) * (17 * (S1)**(4) + (-3 * (S2)**(4) + (S1)**(2) \
* (-22 * (S2)**(2) + 4 * (kappa)**(2)))) + (q)**(3) * (-85 * (S1)**(4) + (55 \
* (S2)**(4) + (-80 * (S2)**(2) * (kappa)**(2) + 2 * (S1)**(2) * (7 * \
(S2)**(2) + 6 * (kappa)**(2)))))))))) + -32 * q * ((1 + q))**(5) * u * (4 * \
(S2)**(2) * ((S1)**(4) + (-8 * (S1)**(2) * (S2)**(2) + (3 * (S2)**(4) + 4 * \
(S2)**(2) * (kappa)**(2)))) + (4 * (q)**(5) * (S1)**(2) * (3 * (S1)**(4) + \
((S2)**(4) + (S1)**(2) * (-8 * (S2)**(2) + 4 * (kappa)**(2)))) + ((q)**(4) * \
((S1)**(6) + (-1 * (S2)**(6) + ((S1)**(4) * (85 * (S2)**(2) + -76 * \
(kappa)**(2)) + (S1)**(2) * (-37 * (S2)**(4) + 12 * (S2)**(2) * \
(kappa)**(2))))) + ((q)**(3) * (-39 * (S1)**(6) + (3 * (S2)**(4) * (9 * \
(S2)**(2) + -40 * (kappa)**(2)) + ((S1)**(4) * (-103 * (S2)**(2) + 156 * \
(kappa)**(2)) + (S1)**(2) * (83 * (S2)**(4) + 12 * (S2)**(2) * \
(kappa)**(2))))) + (q * (-1 * (S1)**(6) + (-37 * (S1)**(4) * (S2)**(2) + \
((S2)**(6) + (-76 * (S2)**(4) * (kappa)**(2) + (S1)**(2) * (85 * (S2)**(4) + \
12 * (S2)**(2) * (kappa)**(2)))))) + (q)**(2) * (27 * (S1)**(6) + ((S1)**(4) \
* (83 * (S2)**(2) + -120 * (kappa)**(2)) + ((S1)**(2) * (-103 * (S2)**(4) + \
12 * (S2)**(2) * (kappa)**(2)) + -39 * ((S2)**(6) + -4 * (S2)**(4) * \
(kappa)**(2))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[45]=",ExpressionUUID->"7010a311-fc51-4e67-9182-c7c7fb61175b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xicoeff0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"discr", ",", "\[Xi]", ",", "0"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<coeff0 = \>\"", "<>", 
  RowBox[{"ToPython", "[", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", " ", 
         RowBox[{
          RowBox[{"%", "//", "Simplify"}], ",", "u"}], "]"}], "//", 
        "Simplify"}], "]"}], ",", "u"}], "]"}], ",", 
    RowBox[{"numpypre", "=", "\"\<np\>\""}]}], "]"}]}]}], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"8ba835db-c9f8-4494-b51c-8f00f8e4dedc"],

Cell[BoxData["\<\"coeff0 = (16 * ((-1 + q))**(2) * ((1 + q))**(6) * (((-1 + \
q))**(2) * (S1)**(2) + -1 * (kappa)**(2)) * (((-1 + q))**(2) * (S2)**(2) + -1 \
* (q)**(2) * (kappa)**(2)) + (32 * ((1 + q))**(6) * u * kappa * (((-1 + \
q))**(4) * (q)**(2) * (S1)**(4) + (((-1 + q))**(4) * (1 + (-12 + q) * q) * \
(S1)**(2) * (S2)**(2) + (((-1 + q))**(4) * (S2)**(4) + (2 * ((-1 + q))**(2) * \
(q)**(2) * (-1 + 5 * q) * (S1)**(2) * (kappa)**(2) + (-1 * (-10 + q) * ((-1 + \
q))**(2) * q * (S2)**(2) * (kappa)**(2) + (-1 * ((-1 + q))**(2) * (q)**(2) * \
(S2)**(2) * (kappa)**(2) + -8 * (q)**(3) * (kappa)**(4))))))) + ((u)**(4) * \
(-256 * ((1 + q))**(6) * (((S1)**(2) + -1 * (S2)**(2)))**(2) * (((q)**(2) * \
(S1)**(2) + ((S2)**(2) + -1 * q * ((S1)**(2) + (S2)**(2)))))**(3) * (u)**(2) \
+ (256 * ((1 + q))**(4) * ((-1 + (q)**(2)))**(2) * ((-1 * q * (S1)**(2) + \
(S2)**(2)))**(2) * (2 * (q)**(2) * (S1)**(2) * ((S1)**(2) + (S2)**(2)) + (2 * \
(S2)**(2) * ((S1)**(2) + (S2)**(2)) + q * (-5 * (S1)**(4) + (2 * (S1)**(2) * \
(S2)**(2) + -5 * (S2)**(4))))) * u * kappa + 16 * ((1 + q))**(4) * (-20 * \
(q)**(3) * ((-1 + (q)**(2)))**(2) * (S1)**(8) + (-8 * (q)**(4) * ((-1 + \
(q)**(2)))**(2) * (S1)**(8) + (((-1 * q + (q)**(3)))**(2) * (S1)**(8) + (4 * \
((-1 + q))**(2) * q * ((1 + q))**(2) * (-5 + q * (27 + q * (-3 + 8 * q))) * \
(S1)**(6) * (S2)**(2) + (-8 * ((-1 + (q)**(2)))**(2) * (S1)**(4) * (S2)**(4) \
+ (-2 * q * ((-1 + (q)**(2)))**(2) * (6 + q * (61 + (6 * q + 4 * (q)**(2)))) \
* (S1)**(4) * (S2)**(4) + (32 * ((-1 + q))**(2) * ((1 + q))**(2) * (S1)**(2) \
* (S2)**(6) + (-12 * ((-1 + q))**(2) * q * ((1 + q))**(2) * (S1)**(2) * \
(S2)**(6) + (108 * ((-1 + q))**(2) * (q)**(2) * ((1 + q))**(2) * (S1)**(2) * \
(S2)**(6) + (-20 * ((-1 + q))**(2) * (q)**(3) * ((1 + q))**(2) * (S1)**(2) * \
(S2)**(6) + (-8 * ((-1 + (q)**(2)))**(2) * (S2)**(8) + (-20 * q * ((-1 + \
(q)**(2)))**(2) * (S2)**(8) + ((q)**(2) * ((-1 + (q)**(2)))**(2) * (S2)**(8) \
+ (-16 * (-1 + q) * (q)**(3) * ((1 + q))**(2) * (10 + (-8 + q) * q) * \
(S1)**(6) * (kappa)**(2) + (144 * (-1 + q) * (q)**(2) * ((1 + q))**(2) * (2 + \
(-2 + q) * q) * (S1)**(4) * (S2)**(2) * (kappa)**(2) + (-144 * (-1 + q) * q * \
((1 + q))**(2) * (1 + 2 * (-1 + q) * q) * (S1)**(2) * (S2)**(4) * \
(kappa)**(2) + (16 * ((-1 + q))**(3) * ((1 + q))**(2) * (S2)**(6) * \
(kappa)**(2) + (48 * (-1 + q) * (q)**(2) * ((1 + q))**(2) * (S2)**(6) * \
(kappa)**(2) + 96 * q * ((-1 + (q)**(2)))**(2) * (S2)**(6) * \
(kappa)**(2))))))))))))))))))))) + (u)**(2) * (32 * ((1 + q))**(4) * u * \
kappa * (-2 * (q)**(2) * ((-1 + (q)**(2)))**(2) * (S1)**(6) + (30 * (q)**(3) \
* ((-1 + (q)**(2)))**(2) * (S1)**(6) + (8 * (q)**(4) * ((-1 + (q)**(2)))**(2) \
* (S1)**(6) + (2 * ((-1 + q))**(2) * q * ((1 + q))**(2) * (15 + q * (-55 + 2 \
* q * (9 + 2 * q))) * (S1)**(4) * (S2)**(2) + (2 * ((-1 + q))**(2) * ((1 + \
q))**(2) * (4 + q * (18 + 5 * q * (-11 + 3 * q))) * (S1)**(2) * (S2)**(4) + \
(8 * ((-1 + (q)**(2)))**(2) * (S2)**(6) + (20 * q * ((-1 + (q)**(2)))**(2) * \
(S2)**(6) + (-1 * (-10 + q) * q * ((-1 + (q)**(2)))**(2) * (S2)**(6) + (-1 * \
(q)**(2) * ((-1 + (q)**(2)))**(2) * (S2)**(6) + (-8 * (q)**(3) * ((1 + \
q))**(2) * (10 + 3 * (-4 + q) * q) * (S1)**(4) * (kappa)**(2) + (16 * \
(q)**(2) * ((1 + q))**(2) * (6 + q * (-11 + 6 * q)) * (S1)**(2) * (S2)**(2) * \
(kappa)**(2) + (-48 * (-1 + q) * (q)**(2) * ((1 + q))**(2) * (S2)**(4) * \
(kappa)**(2) + (-8 * (q)**(3) * ((1 + q))**(2) * (S2)**(4) * (kappa)**(2) + \
-24 * q * ((-1 + (q)**(2)))**(2) * (S2)**(4) * (kappa)**(2)))))))))))))) + 16 \
* ((1 + q))**(4) * (-1 * ((-1 + q))**(4) * (q)**(2) * ((1 + q))**(2) * \
(S1)**(6) + (((-1 + q))**(4) * ((1 + q))**(2) * (-1 + 2 * q * (12 + 5 * q)) * \
(S1)**(4) * (S2)**(2) + (-1 * ((-1 + q))**(4) * ((1 + q))**(2) * (-10 + (-24 \
+ q) * q) * (S1)**(2) * (S2)**(4) + (-1 * ((-1 + q))**(4) * ((1 + q))**(2) * \
(S2)**(6) + (-2 * (-3 + (30 * q + 4 * (q)**(2))) * ((-1 * q + (q)**(3)))**(2) \
* (S1)**(4) * (kappa)**(2) + (-4 * ((-1 + q))**(2) * q * ((1 + q))**(2) * (15 \
+ q * (-29 + 15 * q)) * (S1)**(2) * (S2)**(2) * (kappa)**(2) + (4 * (-10 + q) \
* ((-1 + q))**(2) * q * ((1 + q))**(2) * (S2)**(4) * (kappa)**(2) + (((-1 + \
q))**(2) * (q)**(2) * ((1 + q))**(2) * (S2)**(4) * (kappa)**(2) + (-8 * ((-1 \
+ (q)**(2)))**(2) * (S2)**(4) * (kappa)**(2) + (-20 * q * ((-1 + \
(q)**(2)))**(2) * (S2)**(4) * (kappa)**(2) + ((q)**(2) * ((-1 + \
(q)**(2)))**(2) * (S2)**(4) * (kappa)**(2) + (-16 * (q)**(3) * ((1 + q))**(2) \
* (-5 + 3 * q) * (S1)**(2) * (kappa)**(4) + (48 * (-1 + q) * (q)**(2) * ((1 + \
q))**(2) * (S2)**(2) * (kappa)**(4) + 32 * (q)**(3) * ((1 + q))**(2) * \
(S2)**(2) * (kappa)**(4))))))))))))))))))\"\>"], "Output",
 CellLabel->
  "Out[47]=",ExpressionUUID->"8dee6bbd-ba3f-47aa-b3ce-a6a748a4c5a5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check reconstruction (this should be zero).", \
"Subsubsection",ExpressionUUID->"f947ea6b-44d1-4ef4-858b-249a117223fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xicoeff6", "*", " ", 
    RowBox[{"\[Xi]", "^", "6"}]}], "+", 
   RowBox[{"xicoeff5", "*", " ", 
    RowBox[{"\[Xi]", "^", "5"}]}], "+", " ", 
   RowBox[{"xicoeff4", "*", " ", 
    RowBox[{"\[Xi]", "^", "4"}]}], "+", 
   RowBox[{"xicoeff3", "*", " ", 
    RowBox[{"\[Xi]", "^", "3"}]}], " ", "+", " ", 
   RowBox[{"xicoeff2", "*", " ", 
    RowBox[{"\[Xi]", "^", "2"}]}], " ", "+", " ", 
   RowBox[{"xicoeff1", "*", " ", "\[Xi]"}], "+", " ", "xicoeff0", " ", "-", 
   "discr"}], "//", "FullSimplify"}]], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"8911a65a-9beb-4b54-9975-52499cac79d1"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[48]=",ExpressionUUID->"d211da8e-de1a-4790-bd54-47c76549058f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Clean this notebook for inclusion in git repository. ",
 StyleBox["Credits: http://bhptoolkit.org/cleannb.html", "Subsection"],
 " "
}], "Subsubsection",ExpressionUUID->"78d9b3fa-1fd9-4a6e-951e-c637f3821088"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CleanNotebook", "[", "file_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nb", ",", "contents", ",", "newcontents"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nb", "=", 
       RowBox[{"NotebookOpen", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetOptions", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"\"\<TrackCellChangeTimes\>\"", "->", "False"}], ",", 
        RowBox[{"PrivateNotebookOptions", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<FileOutlineCache\>\"", "->", "False"}], "}"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"contents", "=", 
       RowBox[{"NotebookGet", "[", "nb", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"newcontents", "=", 
       RowBox[{"contents", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellChangeTimes", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CellTags", "->", "_"}], ")"}], "->", 
           RowBox[{"Sequence", "[", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NotebookPut", "[", 
       RowBox[{"newcontents", ",", "nb"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"NotebookSave", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"NotebookClose", "[", "nb", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"d33707e6-4530-47bb-82dc-a8eb63540dea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanNotebook", "[", 
   RowBox[{"NotebookFileName", "[", "]"}], "]"}], ";"}]], "Input",
 CellLabel->
  "In[50]:=",ExpressionUUID->"6eaa02ba-76ec-4df4-b462-96b425012762"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1654, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False,
ExpressionUUID->"ceb27b6a-17ef-40ed-91d0-092d78b52fe3"
]

